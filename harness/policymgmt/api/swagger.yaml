openapi: 3.0.3
info:
  title: Governance Policy Management API
  description: "Read and manage OPA Governance policies, policy sets and evaluations"
  version: 1.2.0
servers:
- url: https://app.harness.io/gateway/pm/
tags:
- name: aida
  description: AIDA API's for Harness OPA
- name: dashboard
  description: "Aggregate summary of policies, policy sets and evaluations for display\
    \ on the dashboard"
- name: examples
  description: Example rego policies and corresponding input
- name: policies
  description: "Create, edit and delete Governance policies written in rego"
- name: evaluate
  description: Perform evaluations
- name: evaluations
  description: Access evaluation results
- name: policysets
  description: "Create, edit and delete Governance policy sets"
- name: system
  description: System version and health
paths:
  /api/v1/aida/analyze:
    post:
      tags:
      - aida
      description: Describe Policy On Basis of rego
      operationId: aida#analyze
      parameters:
      - name: accountIdentifier
        in: query
        description: Harness account ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness account ID
          example: eBqAoNchMLKigC_qZ5EdC
          default: ""
        example: eBqAoNchMLKigC_qZ5EdC
      - name: orgIdentifier
        in: query
        description: Harness organization ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness organization ID
          example: test-org
          default: ""
        example: test-org
      - name: projectIdentifier
        in: query
        description: Harness project ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness project ID
          example: test-project
          default: ""
        example: test-project
      - name: x-api-key
        in: header
        description: Harness PAT key used to perform authorization
        required: false
        style: simple
        explode: false
        schema:
          type: string
          description: Harness PAT key used to perform authorization
          example: Et labore laudantium asperiores enim nesciunt.
        example: Voluptas consequuntur aliquid accusantium.
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AnalyzeRequestBody'
            example:
              entityType: encryptedJsonData example
              rego: query example
        required: true
      responses:
        "200":
          description: OK response.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AnalyzeResponse'
              example:
                desc: policy example
                status: SUCCESS
        "400":
          description: "BadRequest: Bad Request response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "401":
          description: "Unauthorized: Unauthorized response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "403":
          description: "Forbidden: Forbidden response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "404":
          description: "NotFound: Not Found response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "500":
          description: "InternalServer: Internal Server Error response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "502":
          description: "BadGateway: Bad Gateway response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
      security:
      - jwt_header_Authorization:
        - core_governancePolicy_view
        - core_governancePolicy_edit
        - core_governancePolicy_delete
        - core_governancePolicySets_view
        - core_governancePolicySets_edit
        - core_governancePolicySets_delete
        - core_governancePolicySets_evaluate
        - core_governance_admin
      - api_key_header_x-api-key: []
  /api/v1/aida/generate:
    post:
      tags:
      - aida
      description: Generate Policy On Basis of free Text
      operationId: aida#generate
      parameters:
      - name: accountIdentifier
        in: query
        description: Harness account ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness account ID
          example: eBqAoNchMLKigC_qZ5EdC
          default: ""
        example: eBqAoNchMLKigC_qZ5EdC
      - name: orgIdentifier
        in: query
        description: Harness organization ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness organization ID
          example: test-org
          default: ""
        example: test-org
      - name: projectIdentifier
        in: query
        description: Harness project ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness project ID
          example: test-project
          default: ""
        example: test-project
      - name: x-api-key
        in: header
        description: Harness PAT key used to perform authorization
        required: false
        style: simple
        explode: false
        schema:
          type: string
          description: Harness PAT key used to perform authorization
          example: Recusandae quisquam sunt veritatis id occaecati et.
        example: Explicabo qui repellat.
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GenerateRequestBody'
            example:
              policyData: encryptedJsonData example
              query: query example
        required: true
      responses:
        "200":
          description: OK response.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PolicySample'
              example:
                policy: policy example
                status: SUCCESS
        "400":
          description: "BadRequest: Bad Request response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "401":
          description: "Unauthorized: Unauthorized response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "403":
          description: "Forbidden: Forbidden response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "404":
          description: "NotFound: Not Found response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "500":
          description: "InternalServer: Internal Server Error response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "502":
          description: "BadGateway: Bad Gateway response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
      security:
      - jwt_header_Authorization:
        - core_governancePolicy_view
        - core_governancePolicy_edit
        - core_governancePolicy_delete
        - core_governancePolicySets_view
        - core_governancePolicySets_edit
        - core_governancePolicySets_delete
        - core_governancePolicySets_evaluate
        - core_governance_admin
      - api_key_header_x-api-key: []
  /api/v1/dashboard:
    get:
      tags:
      - dashboard
      description: "Get metrics about policies, policy sets and evaluations"
      operationId: dashboard#metrics
      parameters:
      - name: range
        in: query
        description: "The time period over which to aggregate dashboard data. Can\
          \ be: 24 hours, 7 days or 30 days"
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: "The time period over which to aggregate dashboard data. Can\
            \ be: 24 hours, 7 days or 30 days"
          example: 30d
          default: 30d
          enum:
          - 24h
          - 7d
          - 30d
        example: 30d
      - name: accountIdentifier
        in: query
        description: Harness account ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness account ID
          example: eBqAoNchMLKigC_qZ5EdC
          default: ""
        example: eBqAoNchMLKigC_qZ5EdC
      - name: orgIdentifier
        in: query
        description: Harness organization ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness organization ID
          example: test-org
          default: ""
        example: test-org
      - name: projectIdentifier
        in: query
        description: Harness project ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness project ID
          example: test-project
          default: ""
        example: test-project
      - name: x-api-key
        in: header
        description: Harness PAT key used to perform authorization
        required: false
        style: simple
        explode: false
        schema:
          type: string
          description: Harness PAT key used to perform authorization
          example: Ea dolores voluptatem et optio sit minus.
        example: Rerum voluptas explicabo voluptatem iusto voluptatem nihil.
      responses:
        "200":
          description: OK response.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DashboardMetrics'
              example:
                aggregates:
                - error: 7047330649455918569
                  pass: 5978409892349166329
                  time: 3842596383256885522
                  warning: 7820734117944797579
                - error: 7047330649455918569
                  pass: 5978409892349166329
                  time: 3842596383256885522
                  warning: 7820734117944797579
                policy_health:
                  total_evaluation_count: 6897252924146464223
                  total_evaluation_entity_count:
                    error: 76024433486172609
                    pass: 4127438089508318555
                    warning: 511376631733875378
                  total_policy_count: 2312323563280819911
                  total_policy_set_count: 5354236275073299085
                  total_policy_set_entity_count:
                    Possimus corporis doloremque nihil hic exercitationem.: 2751085338469200587
        "400":
          description: "BadRequest: Bad Request response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "401":
          description: "Unauthorized: Unauthorized response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "403":
          description: "Forbidden: Forbidden response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "404":
          description: "NotFound: Not Found response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "500":
          description: "InternalServer: Internal Server Error response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "502":
          description: "BadGateway: Bad Gateway response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
      security:
      - jwt_header_Authorization:
        - core_governancePolicy_view
        - core_governancePolicy_edit
        - core_governancePolicy_delete
        - core_governancePolicySets_view
        - core_governancePolicySets_edit
        - core_governancePolicySets_delete
        - core_governancePolicySets_evaluate
        - core_governance_admin
      - api_key_header_x-api-key: []
  /api/v1/evaluate:
    post:
      tags:
      - evaluate
      description: Evaluate arbitrary rego
      operationId: evaluate#evaluate
      parameters:
      - name: accountIdentifier
        in: query
        description: Harness account ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness account ID
          example: eBqAoNchMLKigC_qZ5EdC
          default: ""
        example: eBqAoNchMLKigC_qZ5EdC
      - name: orgIdentifier
        in: query
        description: Harness organization ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness organization ID
          example: test-org
          default: ""
        example: test-org
      - name: projectIdentifier
        in: query
        description: Harness project ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness project ID
          example: test-project
          default: ""
        example: test-project
      - name: x-api-key
        in: header
        description: Harness PAT key used to perform authorization
        required: false
        style: simple
        explode: false
        schema:
          type: string
          description: Harness PAT key used to perform authorization
          example: Laboriosam magni inventore id ipsa.
        example: Consequatur recusandae voluptatem sit unde excepturi nesciunt.
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EvaluateRequestBody'
            example:
              input: "{\"message\": \"everyone\"}"
              rego: |-
                package test
                deny["should say hello world"] {input.message != "world"}
        required: true
      responses:
        "200":
          description: OK response.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EvaluatedPolicy'
              example:
                deny_messages:
                - deployment stage 'example-stage' does not have a HarnessApproval
                  step
                - deployment stage 'example-stage' has step 'run-script' that is forbidden
                  type 'ShellScript'
                error: "policy.rego:25: rego_parse_error: non-terminated string m\
                  \ == \"test"
                output: |-
                  {
                      "deny": [
                          "deployment stage 'deploy' does not have a HarnessApproval step"
                      ],
                      "stages_with_approval": []
                  }
                policy:
                  account_id: eBqAoNchMLKigC_qZ5EdC
                  created: 1636669297674
                  git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                  git_connector_ref: "."
                  git_default_branch: main
                  git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                  git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                  git_default_branch_file_url: ""
                  git_default_branch_update_error:
                    explanation: "File with given filepath [file.rego] already exists\
                      \ in Github, thus couldn't create a new file"
                    hint: "Please check if there's already a file [file.rego] in Github\
                      \ repository [rego-demo] for the given filepath and branch [main]."
                    message: "Please check if there's already a file [file.rego] in\
                      \ Github repository [rego-demo] for the given filepath and branch\
                      \ [main]."
                  git_default_branch_updated: 1636669297674
                  git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                  git_file_url: ""
                  git_path: .harness/policy.rego
                  git_repo: "github.com/org/repo,omitempty"
                  identifier: policy-1
                  name: Pipeline Approval
                  org_id: test-org
                  project_id: test-project
                  rego: ""
                  updated: 1636669297674
                status: error
        "400":
          description: "PolicySetNotFound: Bad Request response."
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        "401":
          description: "Unauthorized: Unauthorized response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "403":
          description: "Forbidden: Forbidden response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "404":
          description: "NotFound: Not Found response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "500":
          description: "InternalServer: Internal Server Error response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "502":
          description: "BadGateway: Bad Gateway response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
      security:
      - jwt_header_Authorization:
        - core_governancePolicy_view
        - core_governancePolicy_edit
        - core_governancePolicy_delete
        - core_governancePolicySets_view
        - core_governancePolicySets_edit
        - core_governancePolicySets_delete
        - core_governancePolicySets_evaluate
        - core_governance_admin
      - api_key_header_x-api-key: []
  /api/v1/evaluate-by-ids:
    post:
      tags:
      - evaluate
      description: Evaluate policy sets by ID
      operationId: evaluate#evaluate-by-ids
      parameters:
      - name: accountIdentifier
        in: query
        description: Harness account ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness account ID
          example: eBqAoNchMLKigC_qZ5EdC
          default: ""
        example: eBqAoNchMLKigC_qZ5EdC
      - name: orgIdentifier
        in: query
        description: Harness organization ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness organization ID
          example: test-org
          default: ""
        example: test-org
      - name: projectIdentifier
        in: query
        description: Harness project ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness project ID
          example: test-project
          default: ""
        example: test-project
      - name: entity
        in: query
        description: User-supplied global identifier of the entity under evaluation
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: User-supplied global identifier of the entity under evaluation
          example: 7bbca5d4-e9f2-4955-9b2a-019ec4d3645e
          default: ""
        example: 7bbca5d4-e9f2-4955-9b2a-019ec4d3645e
      - name: entityMetadata
        in: query
        description: User-supplied additional metadata for the entity under evaluation
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: User-supplied additional metadata for the entity under evaluation
          example: "{\"name\":\"test-entity\"}"
          default: ""
        example: "{\"name\":\"test-entity\"}"
      - name: principalIdentifier
        in: query
        description: Identifier of the principal that triggered the evaluation - must
          be specified in conjunction with 'principalType'
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Identifier of the principal that triggered the evaluation -
            must be specified in conjunction with 'principalType'
          example: aaabbbcccddd
          default: ""
        example: aaabbbcccddd
      - name: principalType
        in: query
        description: Type of principal that triggered the evaluation - must be specified
          in conjunction with 'principalIdentifier'
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Type of principal that triggered the evaluation - must be specified
            in conjunction with 'principalIdentifier'
          example: USER
          default: ""
        example: USER
      - name: userIdentifier
        in: query
        description: "Deprecated: Please use 'principalIdentifier' and 'principalType'\
          \ instead"
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: "Deprecated: Please use 'principalIdentifier' and 'principalType'\
            \ instead"
          example: Quis expedita et labore dolorem et.
          default: ""
        example: Provident autem ut dolor.
      - name: ids
        in: query
        description: "Comma-separated list of identifiers for the policy sets that\
          \ should be evaluated, with account. or org. prefixes if needed"
        required: true
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          minLength: 1
          type: string
          description: "Comma-separated list of identifiers for the policy sets that\
            \ should be evaluated, with account. or org. prefixes if needed"
          example: "policyset-1,policyset-2,policyset-3"
        example: "policyset-1,policyset-2,policyset-3"
      - name: x-api-key
        in: header
        description: Harness PAT key used to perform authorization
        required: false
        style: simple
        explode: false
        schema:
          type: string
          description: Harness PAT key used to perform authorization
          example: Aut accusantium.
        example: Vel culpa dolorem mollitia qui sequi aliquam.
      responses:
        "200":
          description: OK response.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Evaluation'
              example:
                account_id: XRQAjvT37acOiXx9PRaQMF
                action: onrun
                created: 1636370209475
                details:
                - account_id: eBqAoNchMLKigC_qZ5EdC
                  action: onrun
                  created: 1636669297674
                  description: Captures critical production policies
                  details:
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  enabled: true
                  identifier: policyset-1
                  name: Production Policies
                  org_id: test-org
                  project_id: test-project
                  status: error
                  type: pipeline
                  updated: 1636669297674
                - account_id: eBqAoNchMLKigC_qZ5EdC
                  action: onrun
                  created: 1636669297674
                  description: Captures critical production policies
                  details:
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  enabled: true
                  identifier: policyset-1
                  name: Production Policies
                  org_id: test-org
                  project_id: test-project
                  status: error
                  type: pipeline
                  updated: 1636669297674
                - account_id: eBqAoNchMLKigC_qZ5EdC
                  action: onrun
                  created: 1636669297674
                  description: Captures critical production policies
                  details:
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  enabled: true
                  identifier: policyset-1
                  name: Production Policies
                  org_id: test-org
                  project_id: test-project
                  status: error
                  type: pipeline
                  updated: 1636669297674
                entity: 7bbca5d4-e9f2-4955-9b2a-019ec4d3645e
                entity_metadata: 7bbca5d4-e9f2-4955-9b2a-019ec4d3645e
                id: 123
                input: ""
                org_id: test-org
                project_id: test-project
                status: error
                type: "pipeline,service"
        "400":
          description: "PolicySetNotFound: Bad Request response."
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        "401":
          description: "Unauthorized: Unauthorized response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "403":
          description: "Forbidden: Forbidden response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "404":
          description: "NotFound: Not Found response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "500":
          description: "InternalServer: Internal Server Error response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "502":
          description: "BadGateway: Bad Gateway response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
      security:
      - jwt_header_Authorization:
        - core_governancePolicy_view
        - core_governancePolicy_edit
        - core_governancePolicy_delete
        - core_governancePolicySets_view
        - core_governancePolicySets_edit
        - core_governancePolicySets_delete
        - core_governancePolicySets_evaluate
        - core_governance_admin
      - api_key_header_x-api-key: []
  /api/v1/evaluate-by-type:
    post:
      tags:
      - evaluate
      description: Evaluate all policy sets of a specified type
      operationId: evaluate#evaluate-by-type
      parameters:
      - name: accountIdentifier
        in: query
        description: Harness account ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness account ID
          example: eBqAoNchMLKigC_qZ5EdC
          default: ""
        example: eBqAoNchMLKigC_qZ5EdC
      - name: orgIdentifier
        in: query
        description: Harness organization ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness organization ID
          example: test-org
          default: ""
        example: test-org
      - name: projectIdentifier
        in: query
        description: Harness project ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness project ID
          example: test-project
          default: ""
        example: test-project
      - name: entity
        in: query
        description: User-supplied global identifier of the entity under evaluation
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: User-supplied global identifier of the entity under evaluation
          example: 7bbca5d4-e9f2-4955-9b2a-019ec4d3645e
          default: ""
        example: 7bbca5d4-e9f2-4955-9b2a-019ec4d3645e
      - name: entityMetadata
        in: query
        description: User-supplied additional metadata for the entity under evaluation
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: User-supplied additional metadata for the entity under evaluation
          example: "{\"name\":\"test-entity\"}"
          default: ""
        example: "{\"name\":\"test-entity\"}"
      - name: type
        in: query
        description: Type of entity under evaluation
        required: true
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          minLength: 1
          type: string
          description: Type of entity under evaluation
          example: pipeline
        example: pipeline
      - name: action
        in: query
        description: Action that triggered the evaluation
        required: true
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          minLength: 1
          type: string
          description: Action that triggered the evaluation
          example: onrun
        example: onrun
      - name: principalIdentifier
        in: query
        description: Identifier of the principal that triggered the evaluation - must
          be specified in conjunction with 'principalType'
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Identifier of the principal that triggered the evaluation -
            must be specified in conjunction with 'principalType'
          example: aaabbbcccddd
          default: ""
        example: aaabbbcccddd
      - name: principalType
        in: query
        description: Type of principal that triggered the evaluation - must be specified
          in conjunction with 'principalIdentifier'
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Type of principal that triggered the evaluation - must be specified
            in conjunction with 'principalIdentifier'
          example: USER
          default: ""
        example: USER
      - name: userIdentifier
        in: query
        description: "Deprecated: Please use 'principalIdentifier' and 'principalType'\
          \ instead"
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: "Deprecated: Please use 'principalIdentifier' and 'principalType'\
            \ instead"
          example: Ut suscipit error.
          default: ""
        example: Numquam dolor quibusdam tenetur.
      - name: x-api-key
        in: header
        description: Harness PAT key used to perform authorization
        required: false
        style: simple
        explode: false
        schema:
          type: string
          description: Harness PAT key used to perform authorization
          example: Optio odit ea deserunt praesentium temporibus.
        example: Eveniet et sunt.
      responses:
        "200":
          description: OK response.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Evaluation'
              example:
                account_id: XRQAjvT37acOiXx9PRaQMF
                action: onrun
                created: 1636370209475
                details:
                - account_id: eBqAoNchMLKigC_qZ5EdC
                  action: onrun
                  created: 1636669297674
                  description: Captures critical production policies
                  details:
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  enabled: true
                  identifier: policyset-1
                  name: Production Policies
                  org_id: test-org
                  project_id: test-project
                  status: error
                  type: pipeline
                  updated: 1636669297674
                - account_id: eBqAoNchMLKigC_qZ5EdC
                  action: onrun
                  created: 1636669297674
                  description: Captures critical production policies
                  details:
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  enabled: true
                  identifier: policyset-1
                  name: Production Policies
                  org_id: test-org
                  project_id: test-project
                  status: error
                  type: pipeline
                  updated: 1636669297674
                - account_id: eBqAoNchMLKigC_qZ5EdC
                  action: onrun
                  created: 1636669297674
                  description: Captures critical production policies
                  details:
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  enabled: true
                  identifier: policyset-1
                  name: Production Policies
                  org_id: test-org
                  project_id: test-project
                  status: error
                  type: pipeline
                  updated: 1636669297674
                - account_id: eBqAoNchMLKigC_qZ5EdC
                  action: onrun
                  created: 1636669297674
                  description: Captures critical production policies
                  details:
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  enabled: true
                  identifier: policyset-1
                  name: Production Policies
                  org_id: test-org
                  project_id: test-project
                  status: error
                  type: pipeline
                  updated: 1636669297674
                entity: 7bbca5d4-e9f2-4955-9b2a-019ec4d3645e
                entity_metadata: 7bbca5d4-e9f2-4955-9b2a-019ec4d3645e
                id: 123
                input: ""
                org_id: test-org
                project_id: test-project
                status: error
                type: "pipeline,service"
        "400":
          description: "PolicySetNotFound: Bad Request response."
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        "401":
          description: "Unauthorized: Unauthorized response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "403":
          description: "Forbidden: Forbidden response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "404":
          description: "NotFound: Not Found response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "500":
          description: "InternalServer: Internal Server Error response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "502":
          description: "BadGateway: Bad Gateway response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
      security:
      - jwt_header_Authorization:
        - core_governancePolicy_view
        - core_governancePolicy_edit
        - core_governancePolicy_delete
        - core_governancePolicySets_view
        - core_governancePolicySets_edit
        - core_governancePolicySets_delete
        - core_governancePolicySets_evaluate
        - core_governance_admin
      - api_key_header_x-api-key: []
  /api/v1/evaluate-by-type-check:
    get:
      tags:
      - evaluate
      summary: evaluate-by-type-check evaluate
      description: "Returns true if there are policies to evaluate for the given type,\
        \ action and acc/org/proj scope."
      operationId: evaluate#evaluate-by-type-check
      parameters:
      - name: accountIdentifier
        in: query
        description: Harness account ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness account ID
          example: eBqAoNchMLKigC_qZ5EdC
          default: ""
        example: eBqAoNchMLKigC_qZ5EdC
      - name: orgIdentifier
        in: query
        description: Harness organization ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness organization ID
          example: test-org
          default: ""
        example: test-org
      - name: projectIdentifier
        in: query
        description: Harness project ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness project ID
          example: test-project
          default: ""
        example: test-project
      - name: type
        in: query
        description: Type of entity under evaluation
        required: true
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          minLength: 1
          type: string
          description: Type of entity under evaluation
          example: pipeline
        example: pipeline
      - name: action
        in: query
        description: Action that triggered the evaluation
        required: true
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          minLength: 1
          type: string
          description: Action that triggered the evaluation
          example: onrun
        example: onrun
      - name: entity
        in: query
        description: User-supplied global identifier of the entity under evaluation
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: User-supplied global identifier of the entity under evaluation
          example: 7bbca5d4-e9f2-4955-9b2a-019ec4d3645e
          default: ""
        example: 7bbca5d4-e9f2-4955-9b2a-019ec4d3645e
      - name: x-api-key
        in: header
        description: Harness PAT key used to perform authorization
        required: false
        style: simple
        explode: false
        schema:
          type: string
          description: Harness PAT key used to perform authorization
          example: Dolor dolorem odit nihil consequatur.
        example: Voluptatem nisi illo sapiente dolor repellat.
      responses:
        "200":
          description: OK response.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EvaluateByTypeCheckResponseBody'
              example:
                should_evaluate: false
        "400":
          description: "PolicySetNotFound: Bad Request response."
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        "401":
          description: "Unauthorized: Unauthorized response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "403":
          description: "Forbidden: Forbidden response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "404":
          description: "NotFound: Not Found response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "500":
          description: "InternalServer: Internal Server Error response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "502":
          description: "BadGateway: Bad Gateway response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
      security:
      - jwt_header_Authorization:
        - core_governancePolicy_view
        - core_governancePolicy_edit
        - core_governancePolicy_delete
        - core_governancePolicySets_view
        - core_governancePolicySets_edit
        - core_governancePolicySets_delete
        - core_governancePolicySets_evaluate
        - core_governance_admin
      - api_key_header_x-api-key: []
  /api/v1/evaluations:
    get:
      tags:
      - evaluations
      description: List evaluations
      operationId: evaluations#list
      parameters:
      - name: accountIdentifier
        in: query
        description: Harness account ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness account ID
          example: eBqAoNchMLKigC_qZ5EdC
          default: ""
        example: eBqAoNchMLKigC_qZ5EdC
      - name: orgIdentifier
        in: query
        description: Harness organization ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness organization ID
          example: test-org
          default: ""
        example: test-org
      - name: projectIdentifier
        in: query
        description: Harness project ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness project ID
          example: test-project
          default: ""
        example: test-project
      - name: per_page
        in: query
        description: Number of results per page
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          maximum: 100
          minimum: 1
          type: integer
          description: Number of results per page
          example: 20
          default: 50
        example: 20
      - name: page
        in: query
        description: Page number (starting from 0)
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          minimum: 0
          type: integer
          description: Page number (starting from 0)
          example: 4
          default: 0
        example: 4
      - name: entity
        in: query
        description: Filter by the entity associated with the evaluation
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Filter by the entity associated with the evaluation
          example: 7bbca5d4-e9f2-4955-9b2a-019ec4d3645e
        example: 7bbca5d4-e9f2-4955-9b2a-019ec4d3645e
      - name: type
        in: query
        description: Filter by the type associated with the evaluation
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Filter by the type associated with the evaluation
          example: pipeline
        example: pipeline
      - name: action
        in: query
        description: Filter by the action associated with the evaluation
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Filter by the action associated with the evaluation
          example: onrun
        example: onrun
      - name: last_seen
        in: query
        description: Retrieve results starting after this last-seen result
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: integer
          description: Retrieve results starting after this last-seen result
          format: int64
          example: 123
        example: 123
      - name: created_date_from
        in: query
        description: Retrieve results created from this date
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: integer
          description: Retrieve results created from this date
          format: int64
          example: 123
        example: 123
      - name: created_date_to
        in: query
        description: Retrieve results created up to this date
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: integer
          description: Retrieve results created up to this date
          format: int64
          example: 123
        example: 123
      - name: status
        in: query
        description: Retrieve results with these statuses
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Retrieve results with these statuses
          example: "SUCCESS,WARNING,FAILED"
        example: "SUCCESS,WARNING,FAILED"
      - name: includeChildScopes
        in: query
        description: "When true, evaluations from child scopes will be inculded in\
          \ the results"
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: boolean
          description: "When true, evaluations from child scopes will be inculded\
            \ in the results"
          example: true
          default: false
        example: false
      - name: x-api-key
        in: header
        description: Harness PAT key used to perform authorization
        required: false
        style: simple
        explode: false
        schema:
          type: string
          description: Harness PAT key used to perform authorization
          example: Minima dolorum.
        example: Iusto eos voluptates est maiores.
      responses:
        "200":
          description: OK response.
          headers:
            Link:
              description: Link-based paging
              required: true
              style: simple
              explode: false
              schema:
                type: string
                description: Link-based paging
                example: ""
              example: ""
            X-Page-Index:
              description: Page number
              required: true
              style: simple
              explode: false
              schema:
                type: integer
                description: Page number
                format: int64
                example: 4
              example: 4
            X-Page-Item-Count:
              description: Number of results in this page
              required: true
              style: simple
              explode: false
              schema:
                type: integer
                description: Number of results in this page
                format: int64
                example: 20
              example: 20
            X-Page-Size:
              description: Requested page size
              required: true
              style: simple
              explode: false
              schema:
                type: integer
                description: Requested page size
                format: int64
                example: 20
              example: 20
            X-Total-Items:
              description: Total results available
              required: true
              style: simple
              explode: false
              schema:
                type: integer
                description: Total results available
                format: int64
                example: 230
              example: 230
            X-Total-Pages:
              description: Total pages available
              required: true
              style: simple
              explode: false
              schema:
                type: integer
                description: Total pages available
                format: int64
                example: 12
              example: 12
          content:
            application/json:
              schema:
                type: array
                example:
                - account_id: XRQAjvT37acOiXx9PRaQMF
                  action: onrun
                  created: 1636370209475
                  details:
                  - account_id: eBqAoNchMLKigC_qZ5EdC
                    action: onrun
                    created: 1636669297674
                    description: Captures critical production policies
                    details:
                    - deny_messages:
                      - deployment stage 'example-stage' does not have a HarnessApproval
                        step
                      - deployment stage 'example-stage' has step 'run-script' that
                        is forbidden type 'ShellScript'
                      error: "policy.rego:25: rego_parse_error: non-terminated string\
                        \ m == \"test"
                      output: |-
                        {
                            "deny": [
                                "deployment stage 'deploy' does not have a HarnessApproval step"
                            ],
                            "stages_with_approval": []
                        }
                      policy:
                        account_id: eBqAoNchMLKigC_qZ5EdC
                        created: 1636669297674
                        git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_connector_ref: "."
                        git_default_branch: main
                        git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_url: ""
                        git_default_branch_update_error:
                          explanation: "File with given filepath [file.rego] already\
                            \ exists in Github, thus couldn't create a new file"
                          hint: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                          message: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                        git_default_branch_updated: 1636669297674
                        git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_file_url: ""
                        git_path: .harness/policy.rego
                        git_repo: "github.com/org/repo,omitempty"
                        identifier: policy-1
                        name: Pipeline Approval
                        org_id: test-org
                        project_id: test-project
                        rego: ""
                        updated: 1636669297674
                      status: error
                    - deny_messages:
                      - deployment stage 'example-stage' does not have a HarnessApproval
                        step
                      - deployment stage 'example-stage' has step 'run-script' that
                        is forbidden type 'ShellScript'
                      error: "policy.rego:25: rego_parse_error: non-terminated string\
                        \ m == \"test"
                      output: |-
                        {
                            "deny": [
                                "deployment stage 'deploy' does not have a HarnessApproval step"
                            ],
                            "stages_with_approval": []
                        }
                      policy:
                        account_id: eBqAoNchMLKigC_qZ5EdC
                        created: 1636669297674
                        git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_connector_ref: "."
                        git_default_branch: main
                        git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_url: ""
                        git_default_branch_update_error:
                          explanation: "File with given filepath [file.rego] already\
                            \ exists in Github, thus couldn't create a new file"
                          hint: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                          message: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                        git_default_branch_updated: 1636669297674
                        git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_file_url: ""
                        git_path: .harness/policy.rego
                        git_repo: "github.com/org/repo,omitempty"
                        identifier: policy-1
                        name: Pipeline Approval
                        org_id: test-org
                        project_id: test-project
                        rego: ""
                        updated: 1636669297674
                      status: error
                    - deny_messages:
                      - deployment stage 'example-stage' does not have a HarnessApproval
                        step
                      - deployment stage 'example-stage' has step 'run-script' that
                        is forbidden type 'ShellScript'
                      error: "policy.rego:25: rego_parse_error: non-terminated string\
                        \ m == \"test"
                      output: |-
                        {
                            "deny": [
                                "deployment stage 'deploy' does not have a HarnessApproval step"
                            ],
                            "stages_with_approval": []
                        }
                      policy:
                        account_id: eBqAoNchMLKigC_qZ5EdC
                        created: 1636669297674
                        git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_connector_ref: "."
                        git_default_branch: main
                        git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_url: ""
                        git_default_branch_update_error:
                          explanation: "File with given filepath [file.rego] already\
                            \ exists in Github, thus couldn't create a new file"
                          hint: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                          message: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                        git_default_branch_updated: 1636669297674
                        git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_file_url: ""
                        git_path: .harness/policy.rego
                        git_repo: "github.com/org/repo,omitempty"
                        identifier: policy-1
                        name: Pipeline Approval
                        org_id: test-org
                        project_id: test-project
                        rego: ""
                        updated: 1636669297674
                      status: error
                    enabled: true
                    identifier: policyset-1
                    name: Production Policies
                    org_id: test-org
                    project_id: test-project
                    status: error
                    type: pipeline
                    updated: 1636669297674
                  - account_id: eBqAoNchMLKigC_qZ5EdC
                    action: onrun
                    created: 1636669297674
                    description: Captures critical production policies
                    details:
                    - deny_messages:
                      - deployment stage 'example-stage' does not have a HarnessApproval
                        step
                      - deployment stage 'example-stage' has step 'run-script' that
                        is forbidden type 'ShellScript'
                      error: "policy.rego:25: rego_parse_error: non-terminated string\
                        \ m == \"test"
                      output: |-
                        {
                            "deny": [
                                "deployment stage 'deploy' does not have a HarnessApproval step"
                            ],
                            "stages_with_approval": []
                        }
                      policy:
                        account_id: eBqAoNchMLKigC_qZ5EdC
                        created: 1636669297674
                        git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_connector_ref: "."
                        git_default_branch: main
                        git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_url: ""
                        git_default_branch_update_error:
                          explanation: "File with given filepath [file.rego] already\
                            \ exists in Github, thus couldn't create a new file"
                          hint: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                          message: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                        git_default_branch_updated: 1636669297674
                        git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_file_url: ""
                        git_path: .harness/policy.rego
                        git_repo: "github.com/org/repo,omitempty"
                        identifier: policy-1
                        name: Pipeline Approval
                        org_id: test-org
                        project_id: test-project
                        rego: ""
                        updated: 1636669297674
                      status: error
                    - deny_messages:
                      - deployment stage 'example-stage' does not have a HarnessApproval
                        step
                      - deployment stage 'example-stage' has step 'run-script' that
                        is forbidden type 'ShellScript'
                      error: "policy.rego:25: rego_parse_error: non-terminated string\
                        \ m == \"test"
                      output: |-
                        {
                            "deny": [
                                "deployment stage 'deploy' does not have a HarnessApproval step"
                            ],
                            "stages_with_approval": []
                        }
                      policy:
                        account_id: eBqAoNchMLKigC_qZ5EdC
                        created: 1636669297674
                        git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_connector_ref: "."
                        git_default_branch: main
                        git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_url: ""
                        git_default_branch_update_error:
                          explanation: "File with given filepath [file.rego] already\
                            \ exists in Github, thus couldn't create a new file"
                          hint: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                          message: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                        git_default_branch_updated: 1636669297674
                        git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_file_url: ""
                        git_path: .harness/policy.rego
                        git_repo: "github.com/org/repo,omitempty"
                        identifier: policy-1
                        name: Pipeline Approval
                        org_id: test-org
                        project_id: test-project
                        rego: ""
                        updated: 1636669297674
                      status: error
                    - deny_messages:
                      - deployment stage 'example-stage' does not have a HarnessApproval
                        step
                      - deployment stage 'example-stage' has step 'run-script' that
                        is forbidden type 'ShellScript'
                      error: "policy.rego:25: rego_parse_error: non-terminated string\
                        \ m == \"test"
                      output: |-
                        {
                            "deny": [
                                "deployment stage 'deploy' does not have a HarnessApproval step"
                            ],
                            "stages_with_approval": []
                        }
                      policy:
                        account_id: eBqAoNchMLKigC_qZ5EdC
                        created: 1636669297674
                        git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_connector_ref: "."
                        git_default_branch: main
                        git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_url: ""
                        git_default_branch_update_error:
                          explanation: "File with given filepath [file.rego] already\
                            \ exists in Github, thus couldn't create a new file"
                          hint: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                          message: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                        git_default_branch_updated: 1636669297674
                        git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_file_url: ""
                        git_path: .harness/policy.rego
                        git_repo: "github.com/org/repo,omitempty"
                        identifier: policy-1
                        name: Pipeline Approval
                        org_id: test-org
                        project_id: test-project
                        rego: ""
                        updated: 1636669297674
                      status: error
                    enabled: true
                    identifier: policyset-1
                    name: Production Policies
                    org_id: test-org
                    project_id: test-project
                    status: error
                    type: pipeline
                    updated: 1636669297674
                  - account_id: eBqAoNchMLKigC_qZ5EdC
                    action: onrun
                    created: 1636669297674
                    description: Captures critical production policies
                    details:
                    - deny_messages:
                      - deployment stage 'example-stage' does not have a HarnessApproval
                        step
                      - deployment stage 'example-stage' has step 'run-script' that
                        is forbidden type 'ShellScript'
                      error: "policy.rego:25: rego_parse_error: non-terminated string\
                        \ m == \"test"
                      output: |-
                        {
                            "deny": [
                                "deployment stage 'deploy' does not have a HarnessApproval step"
                            ],
                            "stages_with_approval": []
                        }
                      policy:
                        account_id: eBqAoNchMLKigC_qZ5EdC
                        created: 1636669297674
                        git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_connector_ref: "."
                        git_default_branch: main
                        git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_url: ""
                        git_default_branch_update_error:
                          explanation: "File with given filepath [file.rego] already\
                            \ exists in Github, thus couldn't create a new file"
                          hint: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                          message: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                        git_default_branch_updated: 1636669297674
                        git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_file_url: ""
                        git_path: .harness/policy.rego
                        git_repo: "github.com/org/repo,omitempty"
                        identifier: policy-1
                        name: Pipeline Approval
                        org_id: test-org
                        project_id: test-project
                        rego: ""
                        updated: 1636669297674
                      status: error
                    - deny_messages:
                      - deployment stage 'example-stage' does not have a HarnessApproval
                        step
                      - deployment stage 'example-stage' has step 'run-script' that
                        is forbidden type 'ShellScript'
                      error: "policy.rego:25: rego_parse_error: non-terminated string\
                        \ m == \"test"
                      output: |-
                        {
                            "deny": [
                                "deployment stage 'deploy' does not have a HarnessApproval step"
                            ],
                            "stages_with_approval": []
                        }
                      policy:
                        account_id: eBqAoNchMLKigC_qZ5EdC
                        created: 1636669297674
                        git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_connector_ref: "."
                        git_default_branch: main
                        git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_url: ""
                        git_default_branch_update_error:
                          explanation: "File with given filepath [file.rego] already\
                            \ exists in Github, thus couldn't create a new file"
                          hint: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                          message: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                        git_default_branch_updated: 1636669297674
                        git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_file_url: ""
                        git_path: .harness/policy.rego
                        git_repo: "github.com/org/repo,omitempty"
                        identifier: policy-1
                        name: Pipeline Approval
                        org_id: test-org
                        project_id: test-project
                        rego: ""
                        updated: 1636669297674
                      status: error
                    - deny_messages:
                      - deployment stage 'example-stage' does not have a HarnessApproval
                        step
                      - deployment stage 'example-stage' has step 'run-script' that
                        is forbidden type 'ShellScript'
                      error: "policy.rego:25: rego_parse_error: non-terminated string\
                        \ m == \"test"
                      output: |-
                        {
                            "deny": [
                                "deployment stage 'deploy' does not have a HarnessApproval step"
                            ],
                            "stages_with_approval": []
                        }
                      policy:
                        account_id: eBqAoNchMLKigC_qZ5EdC
                        created: 1636669297674
                        git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_connector_ref: "."
                        git_default_branch: main
                        git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_url: ""
                        git_default_branch_update_error:
                          explanation: "File with given filepath [file.rego] already\
                            \ exists in Github, thus couldn't create a new file"
                          hint: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                          message: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                        git_default_branch_updated: 1636669297674
                        git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_file_url: ""
                        git_path: .harness/policy.rego
                        git_repo: "github.com/org/repo,omitempty"
                        identifier: policy-1
                        name: Pipeline Approval
                        org_id: test-org
                        project_id: test-project
                        rego: ""
                        updated: 1636669297674
                      status: error
                    enabled: true
                    identifier: policyset-1
                    name: Production Policies
                    org_id: test-org
                    project_id: test-project
                    status: error
                    type: pipeline
                    updated: 1636669297674
                  - account_id: eBqAoNchMLKigC_qZ5EdC
                    action: onrun
                    created: 1636669297674
                    description: Captures critical production policies
                    details:
                    - deny_messages:
                      - deployment stage 'example-stage' does not have a HarnessApproval
                        step
                      - deployment stage 'example-stage' has step 'run-script' that
                        is forbidden type 'ShellScript'
                      error: "policy.rego:25: rego_parse_error: non-terminated string\
                        \ m == \"test"
                      output: |-
                        {
                            "deny": [
                                "deployment stage 'deploy' does not have a HarnessApproval step"
                            ],
                            "stages_with_approval": []
                        }
                      policy:
                        account_id: eBqAoNchMLKigC_qZ5EdC
                        created: 1636669297674
                        git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_connector_ref: "."
                        git_default_branch: main
                        git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_url: ""
                        git_default_branch_update_error:
                          explanation: "File with given filepath [file.rego] already\
                            \ exists in Github, thus couldn't create a new file"
                          hint: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                          message: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                        git_default_branch_updated: 1636669297674
                        git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_file_url: ""
                        git_path: .harness/policy.rego
                        git_repo: "github.com/org/repo,omitempty"
                        identifier: policy-1
                        name: Pipeline Approval
                        org_id: test-org
                        project_id: test-project
                        rego: ""
                        updated: 1636669297674
                      status: error
                    - deny_messages:
                      - deployment stage 'example-stage' does not have a HarnessApproval
                        step
                      - deployment stage 'example-stage' has step 'run-script' that
                        is forbidden type 'ShellScript'
                      error: "policy.rego:25: rego_parse_error: non-terminated string\
                        \ m == \"test"
                      output: |-
                        {
                            "deny": [
                                "deployment stage 'deploy' does not have a HarnessApproval step"
                            ],
                            "stages_with_approval": []
                        }
                      policy:
                        account_id: eBqAoNchMLKigC_qZ5EdC
                        created: 1636669297674
                        git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_connector_ref: "."
                        git_default_branch: main
                        git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_url: ""
                        git_default_branch_update_error:
                          explanation: "File with given filepath [file.rego] already\
                            \ exists in Github, thus couldn't create a new file"
                          hint: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                          message: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                        git_default_branch_updated: 1636669297674
                        git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_file_url: ""
                        git_path: .harness/policy.rego
                        git_repo: "github.com/org/repo,omitempty"
                        identifier: policy-1
                        name: Pipeline Approval
                        org_id: test-org
                        project_id: test-project
                        rego: ""
                        updated: 1636669297674
                      status: error
                    - deny_messages:
                      - deployment stage 'example-stage' does not have a HarnessApproval
                        step
                      - deployment stage 'example-stage' has step 'run-script' that
                        is forbidden type 'ShellScript'
                      error: "policy.rego:25: rego_parse_error: non-terminated string\
                        \ m == \"test"
                      output: |-
                        {
                            "deny": [
                                "deployment stage 'deploy' does not have a HarnessApproval step"
                            ],
                            "stages_with_approval": []
                        }
                      policy:
                        account_id: eBqAoNchMLKigC_qZ5EdC
                        created: 1636669297674
                        git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_connector_ref: "."
                        git_default_branch: main
                        git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_url: ""
                        git_default_branch_update_error:
                          explanation: "File with given filepath [file.rego] already\
                            \ exists in Github, thus couldn't create a new file"
                          hint: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                          message: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                        git_default_branch_updated: 1636669297674
                        git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_file_url: ""
                        git_path: .harness/policy.rego
                        git_repo: "github.com/org/repo,omitempty"
                        identifier: policy-1
                        name: Pipeline Approval
                        org_id: test-org
                        project_id: test-project
                        rego: ""
                        updated: 1636669297674
                      status: error
                    enabled: true
                    identifier: policyset-1
                    name: Production Policies
                    org_id: test-org
                    project_id: test-project
                    status: error
                    type: pipeline
                    updated: 1636669297674
                  entity: 7bbca5d4-e9f2-4955-9b2a-019ec4d3645e
                  entity_metadata: 7bbca5d4-e9f2-4955-9b2a-019ec4d3645e
                  id: 123
                  input: ""
                  org_id: test-org
                  project_id: test-project
                  status: error
                  type: "pipeline,service"
                - account_id: XRQAjvT37acOiXx9PRaQMF
                  action: onrun
                  created: 1636370209475
                  details:
                  - account_id: eBqAoNchMLKigC_qZ5EdC
                    action: onrun
                    created: 1636669297674
                    description: Captures critical production policies
                    details:
                    - deny_messages:
                      - deployment stage 'example-stage' does not have a HarnessApproval
                        step
                      - deployment stage 'example-stage' has step 'run-script' that
                        is forbidden type 'ShellScript'
                      error: "policy.rego:25: rego_parse_error: non-terminated string\
                        \ m == \"test"
                      output: |-
                        {
                            "deny": [
                                "deployment stage 'deploy' does not have a HarnessApproval step"
                            ],
                            "stages_with_approval": []
                        }
                      policy:
                        account_id: eBqAoNchMLKigC_qZ5EdC
                        created: 1636669297674
                        git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_connector_ref: "."
                        git_default_branch: main
                        git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_url: ""
                        git_default_branch_update_error:
                          explanation: "File with given filepath [file.rego] already\
                            \ exists in Github, thus couldn't create a new file"
                          hint: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                          message: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                        git_default_branch_updated: 1636669297674
                        git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_file_url: ""
                        git_path: .harness/policy.rego
                        git_repo: "github.com/org/repo,omitempty"
                        identifier: policy-1
                        name: Pipeline Approval
                        org_id: test-org
                        project_id: test-project
                        rego: ""
                        updated: 1636669297674
                      status: error
                    - deny_messages:
                      - deployment stage 'example-stage' does not have a HarnessApproval
                        step
                      - deployment stage 'example-stage' has step 'run-script' that
                        is forbidden type 'ShellScript'
                      error: "policy.rego:25: rego_parse_error: non-terminated string\
                        \ m == \"test"
                      output: |-
                        {
                            "deny": [
                                "deployment stage 'deploy' does not have a HarnessApproval step"
                            ],
                            "stages_with_approval": []
                        }
                      policy:
                        account_id: eBqAoNchMLKigC_qZ5EdC
                        created: 1636669297674
                        git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_connector_ref: "."
                        git_default_branch: main
                        git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_url: ""
                        git_default_branch_update_error:
                          explanation: "File with given filepath [file.rego] already\
                            \ exists in Github, thus couldn't create a new file"
                          hint: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                          message: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                        git_default_branch_updated: 1636669297674
                        git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_file_url: ""
                        git_path: .harness/policy.rego
                        git_repo: "github.com/org/repo,omitempty"
                        identifier: policy-1
                        name: Pipeline Approval
                        org_id: test-org
                        project_id: test-project
                        rego: ""
                        updated: 1636669297674
                      status: error
                    - deny_messages:
                      - deployment stage 'example-stage' does not have a HarnessApproval
                        step
                      - deployment stage 'example-stage' has step 'run-script' that
                        is forbidden type 'ShellScript'
                      error: "policy.rego:25: rego_parse_error: non-terminated string\
                        \ m == \"test"
                      output: |-
                        {
                            "deny": [
                                "deployment stage 'deploy' does not have a HarnessApproval step"
                            ],
                            "stages_with_approval": []
                        }
                      policy:
                        account_id: eBqAoNchMLKigC_qZ5EdC
                        created: 1636669297674
                        git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_connector_ref: "."
                        git_default_branch: main
                        git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_url: ""
                        git_default_branch_update_error:
                          explanation: "File with given filepath [file.rego] already\
                            \ exists in Github, thus couldn't create a new file"
                          hint: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                          message: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                        git_default_branch_updated: 1636669297674
                        git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_file_url: ""
                        git_path: .harness/policy.rego
                        git_repo: "github.com/org/repo,omitempty"
                        identifier: policy-1
                        name: Pipeline Approval
                        org_id: test-org
                        project_id: test-project
                        rego: ""
                        updated: 1636669297674
                      status: error
                    enabled: true
                    identifier: policyset-1
                    name: Production Policies
                    org_id: test-org
                    project_id: test-project
                    status: error
                    type: pipeline
                    updated: 1636669297674
                  - account_id: eBqAoNchMLKigC_qZ5EdC
                    action: onrun
                    created: 1636669297674
                    description: Captures critical production policies
                    details:
                    - deny_messages:
                      - deployment stage 'example-stage' does not have a HarnessApproval
                        step
                      - deployment stage 'example-stage' has step 'run-script' that
                        is forbidden type 'ShellScript'
                      error: "policy.rego:25: rego_parse_error: non-terminated string\
                        \ m == \"test"
                      output: |-
                        {
                            "deny": [
                                "deployment stage 'deploy' does not have a HarnessApproval step"
                            ],
                            "stages_with_approval": []
                        }
                      policy:
                        account_id: eBqAoNchMLKigC_qZ5EdC
                        created: 1636669297674
                        git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_connector_ref: "."
                        git_default_branch: main
                        git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_url: ""
                        git_default_branch_update_error:
                          explanation: "File with given filepath [file.rego] already\
                            \ exists in Github, thus couldn't create a new file"
                          hint: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                          message: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                        git_default_branch_updated: 1636669297674
                        git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_file_url: ""
                        git_path: .harness/policy.rego
                        git_repo: "github.com/org/repo,omitempty"
                        identifier: policy-1
                        name: Pipeline Approval
                        org_id: test-org
                        project_id: test-project
                        rego: ""
                        updated: 1636669297674
                      status: error
                    - deny_messages:
                      - deployment stage 'example-stage' does not have a HarnessApproval
                        step
                      - deployment stage 'example-stage' has step 'run-script' that
                        is forbidden type 'ShellScript'
                      error: "policy.rego:25: rego_parse_error: non-terminated string\
                        \ m == \"test"
                      output: |-
                        {
                            "deny": [
                                "deployment stage 'deploy' does not have a HarnessApproval step"
                            ],
                            "stages_with_approval": []
                        }
                      policy:
                        account_id: eBqAoNchMLKigC_qZ5EdC
                        created: 1636669297674
                        git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_connector_ref: "."
                        git_default_branch: main
                        git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_url: ""
                        git_default_branch_update_error:
                          explanation: "File with given filepath [file.rego] already\
                            \ exists in Github, thus couldn't create a new file"
                          hint: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                          message: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                        git_default_branch_updated: 1636669297674
                        git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_file_url: ""
                        git_path: .harness/policy.rego
                        git_repo: "github.com/org/repo,omitempty"
                        identifier: policy-1
                        name: Pipeline Approval
                        org_id: test-org
                        project_id: test-project
                        rego: ""
                        updated: 1636669297674
                      status: error
                    - deny_messages:
                      - deployment stage 'example-stage' does not have a HarnessApproval
                        step
                      - deployment stage 'example-stage' has step 'run-script' that
                        is forbidden type 'ShellScript'
                      error: "policy.rego:25: rego_parse_error: non-terminated string\
                        \ m == \"test"
                      output: |-
                        {
                            "deny": [
                                "deployment stage 'deploy' does not have a HarnessApproval step"
                            ],
                            "stages_with_approval": []
                        }
                      policy:
                        account_id: eBqAoNchMLKigC_qZ5EdC
                        created: 1636669297674
                        git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_connector_ref: "."
                        git_default_branch: main
                        git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_url: ""
                        git_default_branch_update_error:
                          explanation: "File with given filepath [file.rego] already\
                            \ exists in Github, thus couldn't create a new file"
                          hint: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                          message: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                        git_default_branch_updated: 1636669297674
                        git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_file_url: ""
                        git_path: .harness/policy.rego
                        git_repo: "github.com/org/repo,omitempty"
                        identifier: policy-1
                        name: Pipeline Approval
                        org_id: test-org
                        project_id: test-project
                        rego: ""
                        updated: 1636669297674
                      status: error
                    enabled: true
                    identifier: policyset-1
                    name: Production Policies
                    org_id: test-org
                    project_id: test-project
                    status: error
                    type: pipeline
                    updated: 1636669297674
                  - account_id: eBqAoNchMLKigC_qZ5EdC
                    action: onrun
                    created: 1636669297674
                    description: Captures critical production policies
                    details:
                    - deny_messages:
                      - deployment stage 'example-stage' does not have a HarnessApproval
                        step
                      - deployment stage 'example-stage' has step 'run-script' that
                        is forbidden type 'ShellScript'
                      error: "policy.rego:25: rego_parse_error: non-terminated string\
                        \ m == \"test"
                      output: |-
                        {
                            "deny": [
                                "deployment stage 'deploy' does not have a HarnessApproval step"
                            ],
                            "stages_with_approval": []
                        }
                      policy:
                        account_id: eBqAoNchMLKigC_qZ5EdC
                        created: 1636669297674
                        git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_connector_ref: "."
                        git_default_branch: main
                        git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_url: ""
                        git_default_branch_update_error:
                          explanation: "File with given filepath [file.rego] already\
                            \ exists in Github, thus couldn't create a new file"
                          hint: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                          message: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                        git_default_branch_updated: 1636669297674
                        git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_file_url: ""
                        git_path: .harness/policy.rego
                        git_repo: "github.com/org/repo,omitempty"
                        identifier: policy-1
                        name: Pipeline Approval
                        org_id: test-org
                        project_id: test-project
                        rego: ""
                        updated: 1636669297674
                      status: error
                    - deny_messages:
                      - deployment stage 'example-stage' does not have a HarnessApproval
                        step
                      - deployment stage 'example-stage' has step 'run-script' that
                        is forbidden type 'ShellScript'
                      error: "policy.rego:25: rego_parse_error: non-terminated string\
                        \ m == \"test"
                      output: |-
                        {
                            "deny": [
                                "deployment stage 'deploy' does not have a HarnessApproval step"
                            ],
                            "stages_with_approval": []
                        }
                      policy:
                        account_id: eBqAoNchMLKigC_qZ5EdC
                        created: 1636669297674
                        git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_connector_ref: "."
                        git_default_branch: main
                        git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_url: ""
                        git_default_branch_update_error:
                          explanation: "File with given filepath [file.rego] already\
                            \ exists in Github, thus couldn't create a new file"
                          hint: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                          message: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                        git_default_branch_updated: 1636669297674
                        git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_file_url: ""
                        git_path: .harness/policy.rego
                        git_repo: "github.com/org/repo,omitempty"
                        identifier: policy-1
                        name: Pipeline Approval
                        org_id: test-org
                        project_id: test-project
                        rego: ""
                        updated: 1636669297674
                      status: error
                    - deny_messages:
                      - deployment stage 'example-stage' does not have a HarnessApproval
                        step
                      - deployment stage 'example-stage' has step 'run-script' that
                        is forbidden type 'ShellScript'
                      error: "policy.rego:25: rego_parse_error: non-terminated string\
                        \ m == \"test"
                      output: |-
                        {
                            "deny": [
                                "deployment stage 'deploy' does not have a HarnessApproval step"
                            ],
                            "stages_with_approval": []
                        }
                      policy:
                        account_id: eBqAoNchMLKigC_qZ5EdC
                        created: 1636669297674
                        git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_connector_ref: "."
                        git_default_branch: main
                        git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_url: ""
                        git_default_branch_update_error:
                          explanation: "File with given filepath [file.rego] already\
                            \ exists in Github, thus couldn't create a new file"
                          hint: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                          message: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                        git_default_branch_updated: 1636669297674
                        git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_file_url: ""
                        git_path: .harness/policy.rego
                        git_repo: "github.com/org/repo,omitempty"
                        identifier: policy-1
                        name: Pipeline Approval
                        org_id: test-org
                        project_id: test-project
                        rego: ""
                        updated: 1636669297674
                      status: error
                    enabled: true
                    identifier: policyset-1
                    name: Production Policies
                    org_id: test-org
                    project_id: test-project
                    status: error
                    type: pipeline
                    updated: 1636669297674
                  - account_id: eBqAoNchMLKigC_qZ5EdC
                    action: onrun
                    created: 1636669297674
                    description: Captures critical production policies
                    details:
                    - deny_messages:
                      - deployment stage 'example-stage' does not have a HarnessApproval
                        step
                      - deployment stage 'example-stage' has step 'run-script' that
                        is forbidden type 'ShellScript'
                      error: "policy.rego:25: rego_parse_error: non-terminated string\
                        \ m == \"test"
                      output: |-
                        {
                            "deny": [
                                "deployment stage 'deploy' does not have a HarnessApproval step"
                            ],
                            "stages_with_approval": []
                        }
                      policy:
                        account_id: eBqAoNchMLKigC_qZ5EdC
                        created: 1636669297674
                        git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_connector_ref: "."
                        git_default_branch: main
                        git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_url: ""
                        git_default_branch_update_error:
                          explanation: "File with given filepath [file.rego] already\
                            \ exists in Github, thus couldn't create a new file"
                          hint: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                          message: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                        git_default_branch_updated: 1636669297674
                        git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_file_url: ""
                        git_path: .harness/policy.rego
                        git_repo: "github.com/org/repo,omitempty"
                        identifier: policy-1
                        name: Pipeline Approval
                        org_id: test-org
                        project_id: test-project
                        rego: ""
                        updated: 1636669297674
                      status: error
                    - deny_messages:
                      - deployment stage 'example-stage' does not have a HarnessApproval
                        step
                      - deployment stage 'example-stage' has step 'run-script' that
                        is forbidden type 'ShellScript'
                      error: "policy.rego:25: rego_parse_error: non-terminated string\
                        \ m == \"test"
                      output: |-
                        {
                            "deny": [
                                "deployment stage 'deploy' does not have a HarnessApproval step"
                            ],
                            "stages_with_approval": []
                        }
                      policy:
                        account_id: eBqAoNchMLKigC_qZ5EdC
                        created: 1636669297674
                        git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_connector_ref: "."
                        git_default_branch: main
                        git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_url: ""
                        git_default_branch_update_error:
                          explanation: "File with given filepath [file.rego] already\
                            \ exists in Github, thus couldn't create a new file"
                          hint: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                          message: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                        git_default_branch_updated: 1636669297674
                        git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_file_url: ""
                        git_path: .harness/policy.rego
                        git_repo: "github.com/org/repo,omitempty"
                        identifier: policy-1
                        name: Pipeline Approval
                        org_id: test-org
                        project_id: test-project
                        rego: ""
                        updated: 1636669297674
                      status: error
                    - deny_messages:
                      - deployment stage 'example-stage' does not have a HarnessApproval
                        step
                      - deployment stage 'example-stage' has step 'run-script' that
                        is forbidden type 'ShellScript'
                      error: "policy.rego:25: rego_parse_error: non-terminated string\
                        \ m == \"test"
                      output: |-
                        {
                            "deny": [
                                "deployment stage 'deploy' does not have a HarnessApproval step"
                            ],
                            "stages_with_approval": []
                        }
                      policy:
                        account_id: eBqAoNchMLKigC_qZ5EdC
                        created: 1636669297674
                        git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_connector_ref: "."
                        git_default_branch: main
                        git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_url: ""
                        git_default_branch_update_error:
                          explanation: "File with given filepath [file.rego] already\
                            \ exists in Github, thus couldn't create a new file"
                          hint: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                          message: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                        git_default_branch_updated: 1636669297674
                        git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_file_url: ""
                        git_path: .harness/policy.rego
                        git_repo: "github.com/org/repo,omitempty"
                        identifier: policy-1
                        name: Pipeline Approval
                        org_id: test-org
                        project_id: test-project
                        rego: ""
                        updated: 1636669297674
                      status: error
                    enabled: true
                    identifier: policyset-1
                    name: Production Policies
                    org_id: test-org
                    project_id: test-project
                    status: error
                    type: pipeline
                    updated: 1636669297674
                  entity: 7bbca5d4-e9f2-4955-9b2a-019ec4d3645e
                  entity_metadata: 7bbca5d4-e9f2-4955-9b2a-019ec4d3645e
                  id: 123
                  input: ""
                  org_id: test-org
                  project_id: test-project
                  status: error
                  type: "pipeline,service"
                - account_id: XRQAjvT37acOiXx9PRaQMF
                  action: onrun
                  created: 1636370209475
                  details:
                  - account_id: eBqAoNchMLKigC_qZ5EdC
                    action: onrun
                    created: 1636669297674
                    description: Captures critical production policies
                    details:
                    - deny_messages:
                      - deployment stage 'example-stage' does not have a HarnessApproval
                        step
                      - deployment stage 'example-stage' has step 'run-script' that
                        is forbidden type 'ShellScript'
                      error: "policy.rego:25: rego_parse_error: non-terminated string\
                        \ m == \"test"
                      output: |-
                        {
                            "deny": [
                                "deployment stage 'deploy' does not have a HarnessApproval step"
                            ],
                            "stages_with_approval": []
                        }
                      policy:
                        account_id: eBqAoNchMLKigC_qZ5EdC
                        created: 1636669297674
                        git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_connector_ref: "."
                        git_default_branch: main
                        git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_url: ""
                        git_default_branch_update_error:
                          explanation: "File with given filepath [file.rego] already\
                            \ exists in Github, thus couldn't create a new file"
                          hint: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                          message: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                        git_default_branch_updated: 1636669297674
                        git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_file_url: ""
                        git_path: .harness/policy.rego
                        git_repo: "github.com/org/repo,omitempty"
                        identifier: policy-1
                        name: Pipeline Approval
                        org_id: test-org
                        project_id: test-project
                        rego: ""
                        updated: 1636669297674
                      status: error
                    - deny_messages:
                      - deployment stage 'example-stage' does not have a HarnessApproval
                        step
                      - deployment stage 'example-stage' has step 'run-script' that
                        is forbidden type 'ShellScript'
                      error: "policy.rego:25: rego_parse_error: non-terminated string\
                        \ m == \"test"
                      output: |-
                        {
                            "deny": [
                                "deployment stage 'deploy' does not have a HarnessApproval step"
                            ],
                            "stages_with_approval": []
                        }
                      policy:
                        account_id: eBqAoNchMLKigC_qZ5EdC
                        created: 1636669297674
                        git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_connector_ref: "."
                        git_default_branch: main
                        git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_url: ""
                        git_default_branch_update_error:
                          explanation: "File with given filepath [file.rego] already\
                            \ exists in Github, thus couldn't create a new file"
                          hint: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                          message: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                        git_default_branch_updated: 1636669297674
                        git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_file_url: ""
                        git_path: .harness/policy.rego
                        git_repo: "github.com/org/repo,omitempty"
                        identifier: policy-1
                        name: Pipeline Approval
                        org_id: test-org
                        project_id: test-project
                        rego: ""
                        updated: 1636669297674
                      status: error
                    - deny_messages:
                      - deployment stage 'example-stage' does not have a HarnessApproval
                        step
                      - deployment stage 'example-stage' has step 'run-script' that
                        is forbidden type 'ShellScript'
                      error: "policy.rego:25: rego_parse_error: non-terminated string\
                        \ m == \"test"
                      output: |-
                        {
                            "deny": [
                                "deployment stage 'deploy' does not have a HarnessApproval step"
                            ],
                            "stages_with_approval": []
                        }
                      policy:
                        account_id: eBqAoNchMLKigC_qZ5EdC
                        created: 1636669297674
                        git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_connector_ref: "."
                        git_default_branch: main
                        git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_url: ""
                        git_default_branch_update_error:
                          explanation: "File with given filepath [file.rego] already\
                            \ exists in Github, thus couldn't create a new file"
                          hint: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                          message: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                        git_default_branch_updated: 1636669297674
                        git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_file_url: ""
                        git_path: .harness/policy.rego
                        git_repo: "github.com/org/repo,omitempty"
                        identifier: policy-1
                        name: Pipeline Approval
                        org_id: test-org
                        project_id: test-project
                        rego: ""
                        updated: 1636669297674
                      status: error
                    enabled: true
                    identifier: policyset-1
                    name: Production Policies
                    org_id: test-org
                    project_id: test-project
                    status: error
                    type: pipeline
                    updated: 1636669297674
                  - account_id: eBqAoNchMLKigC_qZ5EdC
                    action: onrun
                    created: 1636669297674
                    description: Captures critical production policies
                    details:
                    - deny_messages:
                      - deployment stage 'example-stage' does not have a HarnessApproval
                        step
                      - deployment stage 'example-stage' has step 'run-script' that
                        is forbidden type 'ShellScript'
                      error: "policy.rego:25: rego_parse_error: non-terminated string\
                        \ m == \"test"
                      output: |-
                        {
                            "deny": [
                                "deployment stage 'deploy' does not have a HarnessApproval step"
                            ],
                            "stages_with_approval": []
                        }
                      policy:
                        account_id: eBqAoNchMLKigC_qZ5EdC
                        created: 1636669297674
                        git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_connector_ref: "."
                        git_default_branch: main
                        git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_url: ""
                        git_default_branch_update_error:
                          explanation: "File with given filepath [file.rego] already\
                            \ exists in Github, thus couldn't create a new file"
                          hint: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                          message: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                        git_default_branch_updated: 1636669297674
                        git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_file_url: ""
                        git_path: .harness/policy.rego
                        git_repo: "github.com/org/repo,omitempty"
                        identifier: policy-1
                        name: Pipeline Approval
                        org_id: test-org
                        project_id: test-project
                        rego: ""
                        updated: 1636669297674
                      status: error
                    - deny_messages:
                      - deployment stage 'example-stage' does not have a HarnessApproval
                        step
                      - deployment stage 'example-stage' has step 'run-script' that
                        is forbidden type 'ShellScript'
                      error: "policy.rego:25: rego_parse_error: non-terminated string\
                        \ m == \"test"
                      output: |-
                        {
                            "deny": [
                                "deployment stage 'deploy' does not have a HarnessApproval step"
                            ],
                            "stages_with_approval": []
                        }
                      policy:
                        account_id: eBqAoNchMLKigC_qZ5EdC
                        created: 1636669297674
                        git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_connector_ref: "."
                        git_default_branch: main
                        git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_url: ""
                        git_default_branch_update_error:
                          explanation: "File with given filepath [file.rego] already\
                            \ exists in Github, thus couldn't create a new file"
                          hint: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                          message: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                        git_default_branch_updated: 1636669297674
                        git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_file_url: ""
                        git_path: .harness/policy.rego
                        git_repo: "github.com/org/repo,omitempty"
                        identifier: policy-1
                        name: Pipeline Approval
                        org_id: test-org
                        project_id: test-project
                        rego: ""
                        updated: 1636669297674
                      status: error
                    - deny_messages:
                      - deployment stage 'example-stage' does not have a HarnessApproval
                        step
                      - deployment stage 'example-stage' has step 'run-script' that
                        is forbidden type 'ShellScript'
                      error: "policy.rego:25: rego_parse_error: non-terminated string\
                        \ m == \"test"
                      output: |-
                        {
                            "deny": [
                                "deployment stage 'deploy' does not have a HarnessApproval step"
                            ],
                            "stages_with_approval": []
                        }
                      policy:
                        account_id: eBqAoNchMLKigC_qZ5EdC
                        created: 1636669297674
                        git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_connector_ref: "."
                        git_default_branch: main
                        git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_url: ""
                        git_default_branch_update_error:
                          explanation: "File with given filepath [file.rego] already\
                            \ exists in Github, thus couldn't create a new file"
                          hint: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                          message: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                        git_default_branch_updated: 1636669297674
                        git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_file_url: ""
                        git_path: .harness/policy.rego
                        git_repo: "github.com/org/repo,omitempty"
                        identifier: policy-1
                        name: Pipeline Approval
                        org_id: test-org
                        project_id: test-project
                        rego: ""
                        updated: 1636669297674
                      status: error
                    enabled: true
                    identifier: policyset-1
                    name: Production Policies
                    org_id: test-org
                    project_id: test-project
                    status: error
                    type: pipeline
                    updated: 1636669297674
                  - account_id: eBqAoNchMLKigC_qZ5EdC
                    action: onrun
                    created: 1636669297674
                    description: Captures critical production policies
                    details:
                    - deny_messages:
                      - deployment stage 'example-stage' does not have a HarnessApproval
                        step
                      - deployment stage 'example-stage' has step 'run-script' that
                        is forbidden type 'ShellScript'
                      error: "policy.rego:25: rego_parse_error: non-terminated string\
                        \ m == \"test"
                      output: |-
                        {
                            "deny": [
                                "deployment stage 'deploy' does not have a HarnessApproval step"
                            ],
                            "stages_with_approval": []
                        }
                      policy:
                        account_id: eBqAoNchMLKigC_qZ5EdC
                        created: 1636669297674
                        git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_connector_ref: "."
                        git_default_branch: main
                        git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_url: ""
                        git_default_branch_update_error:
                          explanation: "File with given filepath [file.rego] already\
                            \ exists in Github, thus couldn't create a new file"
                          hint: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                          message: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                        git_default_branch_updated: 1636669297674
                        git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_file_url: ""
                        git_path: .harness/policy.rego
                        git_repo: "github.com/org/repo,omitempty"
                        identifier: policy-1
                        name: Pipeline Approval
                        org_id: test-org
                        project_id: test-project
                        rego: ""
                        updated: 1636669297674
                      status: error
                    - deny_messages:
                      - deployment stage 'example-stage' does not have a HarnessApproval
                        step
                      - deployment stage 'example-stage' has step 'run-script' that
                        is forbidden type 'ShellScript'
                      error: "policy.rego:25: rego_parse_error: non-terminated string\
                        \ m == \"test"
                      output: |-
                        {
                            "deny": [
                                "deployment stage 'deploy' does not have a HarnessApproval step"
                            ],
                            "stages_with_approval": []
                        }
                      policy:
                        account_id: eBqAoNchMLKigC_qZ5EdC
                        created: 1636669297674
                        git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_connector_ref: "."
                        git_default_branch: main
                        git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_url: ""
                        git_default_branch_update_error:
                          explanation: "File with given filepath [file.rego] already\
                            \ exists in Github, thus couldn't create a new file"
                          hint: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                          message: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                        git_default_branch_updated: 1636669297674
                        git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_file_url: ""
                        git_path: .harness/policy.rego
                        git_repo: "github.com/org/repo,omitempty"
                        identifier: policy-1
                        name: Pipeline Approval
                        org_id: test-org
                        project_id: test-project
                        rego: ""
                        updated: 1636669297674
                      status: error
                    - deny_messages:
                      - deployment stage 'example-stage' does not have a HarnessApproval
                        step
                      - deployment stage 'example-stage' has step 'run-script' that
                        is forbidden type 'ShellScript'
                      error: "policy.rego:25: rego_parse_error: non-terminated string\
                        \ m == \"test"
                      output: |-
                        {
                            "deny": [
                                "deployment stage 'deploy' does not have a HarnessApproval step"
                            ],
                            "stages_with_approval": []
                        }
                      policy:
                        account_id: eBqAoNchMLKigC_qZ5EdC
                        created: 1636669297674
                        git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_connector_ref: "."
                        git_default_branch: main
                        git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_url: ""
                        git_default_branch_update_error:
                          explanation: "File with given filepath [file.rego] already\
                            \ exists in Github, thus couldn't create a new file"
                          hint: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                          message: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                        git_default_branch_updated: 1636669297674
                        git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_file_url: ""
                        git_path: .harness/policy.rego
                        git_repo: "github.com/org/repo,omitempty"
                        identifier: policy-1
                        name: Pipeline Approval
                        org_id: test-org
                        project_id: test-project
                        rego: ""
                        updated: 1636669297674
                      status: error
                    enabled: true
                    identifier: policyset-1
                    name: Production Policies
                    org_id: test-org
                    project_id: test-project
                    status: error
                    type: pipeline
                    updated: 1636669297674
                  - account_id: eBqAoNchMLKigC_qZ5EdC
                    action: onrun
                    created: 1636669297674
                    description: Captures critical production policies
                    details:
                    - deny_messages:
                      - deployment stage 'example-stage' does not have a HarnessApproval
                        step
                      - deployment stage 'example-stage' has step 'run-script' that
                        is forbidden type 'ShellScript'
                      error: "policy.rego:25: rego_parse_error: non-terminated string\
                        \ m == \"test"
                      output: |-
                        {
                            "deny": [
                                "deployment stage 'deploy' does not have a HarnessApproval step"
                            ],
                            "stages_with_approval": []
                        }
                      policy:
                        account_id: eBqAoNchMLKigC_qZ5EdC
                        created: 1636669297674
                        git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_connector_ref: "."
                        git_default_branch: main
                        git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_url: ""
                        git_default_branch_update_error:
                          explanation: "File with given filepath [file.rego] already\
                            \ exists in Github, thus couldn't create a new file"
                          hint: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                          message: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                        git_default_branch_updated: 1636669297674
                        git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_file_url: ""
                        git_path: .harness/policy.rego
                        git_repo: "github.com/org/repo,omitempty"
                        identifier: policy-1
                        name: Pipeline Approval
                        org_id: test-org
                        project_id: test-project
                        rego: ""
                        updated: 1636669297674
                      status: error
                    - deny_messages:
                      - deployment stage 'example-stage' does not have a HarnessApproval
                        step
                      - deployment stage 'example-stage' has step 'run-script' that
                        is forbidden type 'ShellScript'
                      error: "policy.rego:25: rego_parse_error: non-terminated string\
                        \ m == \"test"
                      output: |-
                        {
                            "deny": [
                                "deployment stage 'deploy' does not have a HarnessApproval step"
                            ],
                            "stages_with_approval": []
                        }
                      policy:
                        account_id: eBqAoNchMLKigC_qZ5EdC
                        created: 1636669297674
                        git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_connector_ref: "."
                        git_default_branch: main
                        git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_url: ""
                        git_default_branch_update_error:
                          explanation: "File with given filepath [file.rego] already\
                            \ exists in Github, thus couldn't create a new file"
                          hint: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                          message: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                        git_default_branch_updated: 1636669297674
                        git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_file_url: ""
                        git_path: .harness/policy.rego
                        git_repo: "github.com/org/repo,omitempty"
                        identifier: policy-1
                        name: Pipeline Approval
                        org_id: test-org
                        project_id: test-project
                        rego: ""
                        updated: 1636669297674
                      status: error
                    - deny_messages:
                      - deployment stage 'example-stage' does not have a HarnessApproval
                        step
                      - deployment stage 'example-stage' has step 'run-script' that
                        is forbidden type 'ShellScript'
                      error: "policy.rego:25: rego_parse_error: non-terminated string\
                        \ m == \"test"
                      output: |-
                        {
                            "deny": [
                                "deployment stage 'deploy' does not have a HarnessApproval step"
                            ],
                            "stages_with_approval": []
                        }
                      policy:
                        account_id: eBqAoNchMLKigC_qZ5EdC
                        created: 1636669297674
                        git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_connector_ref: "."
                        git_default_branch: main
                        git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_default_branch_file_url: ""
                        git_default_branch_update_error:
                          explanation: "File with given filepath [file.rego] already\
                            \ exists in Github, thus couldn't create a new file"
                          hint: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                          message: "Please check if there's already a file [file.rego]\
                            \ in Github repository [rego-demo] for the given filepath\
                            \ and branch [main]."
                        git_default_branch_updated: 1636669297674
                        git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                        git_file_url: ""
                        git_path: .harness/policy.rego
                        git_repo: "github.com/org/repo,omitempty"
                        identifier: policy-1
                        name: Pipeline Approval
                        org_id: test-org
                        project_id: test-project
                        rego: ""
                        updated: 1636669297674
                      status: error
                    enabled: true
                    identifier: policyset-1
                    name: Production Policies
                    org_id: test-org
                    project_id: test-project
                    status: error
                    type: pipeline
                    updated: 1636669297674
                  entity: 7bbca5d4-e9f2-4955-9b2a-019ec4d3645e
                  entity_metadata: 7bbca5d4-e9f2-4955-9b2a-019ec4d3645e
                  id: 123
                  input: ""
                  org_id: test-org
                  project_id: test-project
                  status: error
                  type: "pipeline,service"
                items:
                  $ref: '#/components/schemas/Evaluation'
                x-content-type: application/json
              example:
              - account_id: XRQAjvT37acOiXx9PRaQMF
                action: onrun
                created: 1636370209475
                details:
                - account_id: eBqAoNchMLKigC_qZ5EdC
                  action: onrun
                  created: 1636669297674
                  description: Captures critical production policies
                  details:
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  enabled: true
                  identifier: policyset-1
                  name: Production Policies
                  org_id: test-org
                  project_id: test-project
                  status: error
                  type: pipeline
                  updated: 1636669297674
                - account_id: eBqAoNchMLKigC_qZ5EdC
                  action: onrun
                  created: 1636669297674
                  description: Captures critical production policies
                  details:
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  enabled: true
                  identifier: policyset-1
                  name: Production Policies
                  org_id: test-org
                  project_id: test-project
                  status: error
                  type: pipeline
                  updated: 1636669297674
                - account_id: eBqAoNchMLKigC_qZ5EdC
                  action: onrun
                  created: 1636669297674
                  description: Captures critical production policies
                  details:
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  enabled: true
                  identifier: policyset-1
                  name: Production Policies
                  org_id: test-org
                  project_id: test-project
                  status: error
                  type: pipeline
                  updated: 1636669297674
                - account_id: eBqAoNchMLKigC_qZ5EdC
                  action: onrun
                  created: 1636669297674
                  description: Captures critical production policies
                  details:
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  enabled: true
                  identifier: policyset-1
                  name: Production Policies
                  org_id: test-org
                  project_id: test-project
                  status: error
                  type: pipeline
                  updated: 1636669297674
                entity: 7bbca5d4-e9f2-4955-9b2a-019ec4d3645e
                entity_metadata: 7bbca5d4-e9f2-4955-9b2a-019ec4d3645e
                id: 123
                input: ""
                org_id: test-org
                project_id: test-project
                status: error
                type: "pipeline,service"
              - account_id: XRQAjvT37acOiXx9PRaQMF
                action: onrun
                created: 1636370209475
                details:
                - account_id: eBqAoNchMLKigC_qZ5EdC
                  action: onrun
                  created: 1636669297674
                  description: Captures critical production policies
                  details:
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  enabled: true
                  identifier: policyset-1
                  name: Production Policies
                  org_id: test-org
                  project_id: test-project
                  status: error
                  type: pipeline
                  updated: 1636669297674
                - account_id: eBqAoNchMLKigC_qZ5EdC
                  action: onrun
                  created: 1636669297674
                  description: Captures critical production policies
                  details:
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  enabled: true
                  identifier: policyset-1
                  name: Production Policies
                  org_id: test-org
                  project_id: test-project
                  status: error
                  type: pipeline
                  updated: 1636669297674
                - account_id: eBqAoNchMLKigC_qZ5EdC
                  action: onrun
                  created: 1636669297674
                  description: Captures critical production policies
                  details:
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  enabled: true
                  identifier: policyset-1
                  name: Production Policies
                  org_id: test-org
                  project_id: test-project
                  status: error
                  type: pipeline
                  updated: 1636669297674
                - account_id: eBqAoNchMLKigC_qZ5EdC
                  action: onrun
                  created: 1636669297674
                  description: Captures critical production policies
                  details:
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  enabled: true
                  identifier: policyset-1
                  name: Production Policies
                  org_id: test-org
                  project_id: test-project
                  status: error
                  type: pipeline
                  updated: 1636669297674
                entity: 7bbca5d4-e9f2-4955-9b2a-019ec4d3645e
                entity_metadata: 7bbca5d4-e9f2-4955-9b2a-019ec4d3645e
                id: 123
                input: ""
                org_id: test-org
                project_id: test-project
                status: error
                type: "pipeline,service"
              - account_id: XRQAjvT37acOiXx9PRaQMF
                action: onrun
                created: 1636370209475
                details:
                - account_id: eBqAoNchMLKigC_qZ5EdC
                  action: onrun
                  created: 1636669297674
                  description: Captures critical production policies
                  details:
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  enabled: true
                  identifier: policyset-1
                  name: Production Policies
                  org_id: test-org
                  project_id: test-project
                  status: error
                  type: pipeline
                  updated: 1636669297674
                - account_id: eBqAoNchMLKigC_qZ5EdC
                  action: onrun
                  created: 1636669297674
                  description: Captures critical production policies
                  details:
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  enabled: true
                  identifier: policyset-1
                  name: Production Policies
                  org_id: test-org
                  project_id: test-project
                  status: error
                  type: pipeline
                  updated: 1636669297674
                - account_id: eBqAoNchMLKigC_qZ5EdC
                  action: onrun
                  created: 1636669297674
                  description: Captures critical production policies
                  details:
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  enabled: true
                  identifier: policyset-1
                  name: Production Policies
                  org_id: test-org
                  project_id: test-project
                  status: error
                  type: pipeline
                  updated: 1636669297674
                - account_id: eBqAoNchMLKigC_qZ5EdC
                  action: onrun
                  created: 1636669297674
                  description: Captures critical production policies
                  details:
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  enabled: true
                  identifier: policyset-1
                  name: Production Policies
                  org_id: test-org
                  project_id: test-project
                  status: error
                  type: pipeline
                  updated: 1636669297674
                entity: 7bbca5d4-e9f2-4955-9b2a-019ec4d3645e
                entity_metadata: 7bbca5d4-e9f2-4955-9b2a-019ec4d3645e
                id: 123
                input: ""
                org_id: test-org
                project_id: test-project
                status: error
                type: "pipeline,service"
              - account_id: XRQAjvT37acOiXx9PRaQMF
                action: onrun
                created: 1636370209475
                details:
                - account_id: eBqAoNchMLKigC_qZ5EdC
                  action: onrun
                  created: 1636669297674
                  description: Captures critical production policies
                  details:
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  enabled: true
                  identifier: policyset-1
                  name: Production Policies
                  org_id: test-org
                  project_id: test-project
                  status: error
                  type: pipeline
                  updated: 1636669297674
                - account_id: eBqAoNchMLKigC_qZ5EdC
                  action: onrun
                  created: 1636669297674
                  description: Captures critical production policies
                  details:
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  enabled: true
                  identifier: policyset-1
                  name: Production Policies
                  org_id: test-org
                  project_id: test-project
                  status: error
                  type: pipeline
                  updated: 1636669297674
                - account_id: eBqAoNchMLKigC_qZ5EdC
                  action: onrun
                  created: 1636669297674
                  description: Captures critical production policies
                  details:
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  enabled: true
                  identifier: policyset-1
                  name: Production Policies
                  org_id: test-org
                  project_id: test-project
                  status: error
                  type: pipeline
                  updated: 1636669297674
                - account_id: eBqAoNchMLKigC_qZ5EdC
                  action: onrun
                  created: 1636669297674
                  description: Captures critical production policies
                  details:
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  enabled: true
                  identifier: policyset-1
                  name: Production Policies
                  org_id: test-org
                  project_id: test-project
                  status: error
                  type: pipeline
                  updated: 1636669297674
                entity: 7bbca5d4-e9f2-4955-9b2a-019ec4d3645e
                entity_metadata: 7bbca5d4-e9f2-4955-9b2a-019ec4d3645e
                id: 123
                input: ""
                org_id: test-org
                project_id: test-project
                status: error
                type: "pipeline,service"
        "400":
          description: "BadRequest: Bad Request response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "401":
          description: "Unauthorized: Unauthorized response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "403":
          description: "Forbidden: Forbidden response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "404":
          description: "NotFound: Not Found response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "500":
          description: "InternalServer: Internal Server Error response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "502":
          description: "BadGateway: Bad Gateway response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
      security:
      - jwt_header_Authorization:
        - core_governancePolicy_view
        - core_governancePolicy_edit
        - core_governancePolicy_delete
        - core_governancePolicySets_view
        - core_governancePolicySets_edit
        - core_governancePolicySets_delete
        - core_governancePolicySets_evaluate
        - core_governance_admin
      - api_key_header_x-api-key: []
  /api/v1/evaluations/{id}:
    get:
      tags:
      - evaluations
      description: Find an evaluation by ID
      operationId: evaluations#find
      parameters:
      - name: accountIdentifier
        in: query
        description: Harness account ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness account ID
          example: eBqAoNchMLKigC_qZ5EdC
          default: ""
        example: eBqAoNchMLKigC_qZ5EdC
      - name: orgIdentifier
        in: query
        description: Harness organization ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness organization ID
          example: test-org
          default: ""
        example: test-org
      - name: projectIdentifier
        in: query
        description: Harness project ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness project ID
          example: test-project
          default: ""
        example: test-project
      - name: id
        in: path
        description: The ID of the evaluation to retrieve
        required: true
        style: simple
        explode: false
        schema:
          type: integer
          description: The ID of the evaluation to retrieve
          format: int64
          example: 123
        examples:
          default:
            summary: default
            value: 123
      - name: x-api-key
        in: header
        description: Harness PAT key used to perform authorization
        required: false
        style: simple
        explode: false
        schema:
          type: string
          description: Harness PAT key used to perform authorization
          example: Occaecati facere consequatur.
        example: Eum velit sunt eum odio.
      responses:
        "200":
          description: OK response.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Evaluation'
              example:
                account_id: XRQAjvT37acOiXx9PRaQMF
                action: onrun
                created: 1636370209475
                details:
                - account_id: eBqAoNchMLKigC_qZ5EdC
                  action: onrun
                  created: 1636669297674
                  description: Captures critical production policies
                  details:
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  enabled: true
                  identifier: policyset-1
                  name: Production Policies
                  org_id: test-org
                  project_id: test-project
                  status: error
                  type: pipeline
                  updated: 1636669297674
                - account_id: eBqAoNchMLKigC_qZ5EdC
                  action: onrun
                  created: 1636669297674
                  description: Captures critical production policies
                  details:
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  - deny_messages:
                    - deployment stage 'example-stage' does not have a HarnessApproval
                      step
                    - deployment stage 'example-stage' has step 'run-script' that
                      is forbidden type 'ShellScript'
                    error: "policy.rego:25: rego_parse_error: non-terminated string\
                      \ m == \"test"
                    output: |-
                      {
                          "deny": [
                              "deployment stage 'deploy' does not have a HarnessApproval step"
                          ],
                          "stages_with_approval": []
                      }
                    policy:
                      account_id: eBqAoNchMLKigC_qZ5EdC
                      created: 1636669297674
                      git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_connector_ref: "."
                      git_default_branch: main
                      git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_default_branch_file_url: ""
                      git_default_branch_update_error:
                        explanation: "File with given filepath [file.rego] already\
                          \ exists in Github, thus couldn't create a new file"
                        hint: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                        message: "Please check if there's already a file [file.rego]\
                          \ in Github repository [rego-demo] for the given filepath\
                          \ and branch [main]."
                      git_default_branch_updated: 1636669297674
                      git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                      git_file_url: ""
                      git_path: .harness/policy.rego
                      git_repo: "github.com/org/repo,omitempty"
                      identifier: policy-1
                      name: Pipeline Approval
                      org_id: test-org
                      project_id: test-project
                      rego: ""
                      updated: 1636669297674
                    status: error
                  enabled: true
                  identifier: policyset-1
                  name: Production Policies
                  org_id: test-org
                  project_id: test-project
                  status: error
                  type: pipeline
                  updated: 1636669297674
                entity: 7bbca5d4-e9f2-4955-9b2a-019ec4d3645e
                entity_metadata: 7bbca5d4-e9f2-4955-9b2a-019ec4d3645e
                id: 123
                input: ""
                org_id: test-org
                project_id: test-project
                status: error
                type: "pipeline,service"
        "400":
          description: "BadRequest: Bad Request response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "401":
          description: "Unauthorized: Unauthorized response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "403":
          description: "Forbidden: Forbidden response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "404":
          description: "NotFound: Not Found response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "500":
          description: "InternalServer: Internal Server Error response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "502":
          description: "BadGateway: Bad Gateway response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
      security:
      - jwt_header_Authorization:
        - core_governancePolicy_view
        - core_governancePolicy_edit
        - core_governancePolicy_delete
        - core_governancePolicySets_view
        - core_governancePolicySets_edit
        - core_governancePolicySets_delete
        - core_governancePolicySets_evaluate
        - core_governance_admin
      - api_key_header_x-api-key: []
  /api/v1/examples:
    get:
      tags:
      - examples
      description: list examples
      operationId: examples#list
      parameters:
      - name: accountIdentifier
        in: query
        description: Harness account ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness account ID
          example: eBqAoNchMLKigC_qZ5EdC
          default: ""
        example: eBqAoNchMLKigC_qZ5EdC
      - name: orgIdentifier
        in: query
        description: Harness organization ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness organization ID
          example: test-org
          default: ""
        example: test-org
      - name: projectIdentifier
        in: query
        description: Harness project ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness project ID
          example: test-project
          default: ""
        example: test-project
      - name: x-api-key
        in: header
        description: Harness PAT key used to perform authorization
        required: false
        style: simple
        explode: false
        schema:
          type: string
          description: Harness PAT key used to perform authorization
          example: Repellendus corrupti.
        example: Voluptate quia voluptatem.
      responses:
        "200":
          description: OK response.
          content:
            application/json:
              schema:
                type: array
                example:
                - desc: This is a pipeline example
                  input: "{\"message\": \"everyone\"}"
                  name: Pipeline example
                  rego: |-
                    package test
                    deny["should say hello world"] {input.message != "world"}
                  type: pipeline
                  variables:
                  - default:
                    - JiraUpdate
                    - HarnessApproval
                    desc: The required steps that the policy enforces
                    id: requiredsteps
                    name: Required Steps
                    type: selectOne
                    values:
                    - JiraUpdate
                    - HarnessApproval
                  - default:
                    - JiraUpdate
                    - HarnessApproval
                    desc: The required steps that the policy enforces
                    id: requiredsteps
                    name: Required Steps
                    type: selectOne
                    values:
                    - JiraUpdate
                    - HarnessApproval
                  - default:
                    - JiraUpdate
                    - HarnessApproval
                    desc: The required steps that the policy enforces
                    id: requiredsteps
                    name: Required Steps
                    type: selectOne
                    values:
                    - JiraUpdate
                    - HarnessApproval
                - desc: This is a pipeline example
                  input: "{\"message\": \"everyone\"}"
                  name: Pipeline example
                  rego: |-
                    package test
                    deny["should say hello world"] {input.message != "world"}
                  type: pipeline
                  variables:
                  - default:
                    - JiraUpdate
                    - HarnessApproval
                    desc: The required steps that the policy enforces
                    id: requiredsteps
                    name: Required Steps
                    type: selectOne
                    values:
                    - JiraUpdate
                    - HarnessApproval
                  - default:
                    - JiraUpdate
                    - HarnessApproval
                    desc: The required steps that the policy enforces
                    id: requiredsteps
                    name: Required Steps
                    type: selectOne
                    values:
                    - JiraUpdate
                    - HarnessApproval
                  - default:
                    - JiraUpdate
                    - HarnessApproval
                    desc: The required steps that the policy enforces
                    id: requiredsteps
                    name: Required Steps
                    type: selectOne
                    values:
                    - JiraUpdate
                    - HarnessApproval
                items:
                  $ref: '#/components/schemas/PolicyExample'
                x-content-type: application/json
              example:
              - desc: This is a pipeline example
                input: "{\"message\": \"everyone\"}"
                name: Pipeline example
                rego: |-
                  package test
                  deny["should say hello world"] {input.message != "world"}
                type: pipeline
                variables:
                - default:
                  - JiraUpdate
                  - HarnessApproval
                  desc: The required steps that the policy enforces
                  id: requiredsteps
                  name: Required Steps
                  type: selectOne
                  values:
                  - JiraUpdate
                  - HarnessApproval
                - default:
                  - JiraUpdate
                  - HarnessApproval
                  desc: The required steps that the policy enforces
                  id: requiredsteps
                  name: Required Steps
                  type: selectOne
                  values:
                  - JiraUpdate
                  - HarnessApproval
                - default:
                  - JiraUpdate
                  - HarnessApproval
                  desc: The required steps that the policy enforces
                  id: requiredsteps
                  name: Required Steps
                  type: selectOne
                  values:
                  - JiraUpdate
                  - HarnessApproval
              - desc: This is a pipeline example
                input: "{\"message\": \"everyone\"}"
                name: Pipeline example
                rego: |-
                  package test
                  deny["should say hello world"] {input.message != "world"}
                type: pipeline
                variables:
                - default:
                  - JiraUpdate
                  - HarnessApproval
                  desc: The required steps that the policy enforces
                  id: requiredsteps
                  name: Required Steps
                  type: selectOne
                  values:
                  - JiraUpdate
                  - HarnessApproval
                - default:
                  - JiraUpdate
                  - HarnessApproval
                  desc: The required steps that the policy enforces
                  id: requiredsteps
                  name: Required Steps
                  type: selectOne
                  values:
                  - JiraUpdate
                  - HarnessApproval
                - default:
                  - JiraUpdate
                  - HarnessApproval
                  desc: The required steps that the policy enforces
                  id: requiredsteps
                  name: Required Steps
                  type: selectOne
                  values:
                  - JiraUpdate
                  - HarnessApproval
        "400":
          description: "BadRequest: Bad Request response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "401":
          description: "Unauthorized: Unauthorized response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "403":
          description: "Forbidden: Forbidden response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "404":
          description: "NotFound: Not Found response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "500":
          description: "InternalServer: Internal Server Error response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "502":
          description: "BadGateway: Bad Gateway response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
      security:
      - jwt_header_Authorization:
        - core_governancePolicy_view
        - core_governancePolicy_edit
        - core_governancePolicy_delete
        - core_governancePolicySets_view
        - core_governancePolicySets_edit
        - core_governancePolicySets_delete
        - core_governancePolicySets_evaluate
        - core_governance_admin
      - api_key_header_x-api-key: []
  /api/v1/policies:
    get:
      tags:
      - policies
      description: List all policies
      operationId: policies#list
      parameters:
      - name: accountIdentifier
        in: query
        description: Harness account ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness account ID
          example: eBqAoNchMLKigC_qZ5EdC
          default: ""
        example: eBqAoNchMLKigC_qZ5EdC
      - name: orgIdentifier
        in: query
        description: Harness organization ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness organization ID
          example: test-org
          default: ""
        example: test-org
      - name: projectIdentifier
        in: query
        description: Harness project ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness project ID
          example: test-project
          default: ""
        example: test-project
      - name: per_page
        in: query
        description: Number of results per page
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          maximum: 100
          minimum: 1
          type: integer
          description: Number of results per page
          example: 20
          default: 50
        example: 20
      - name: page
        in: query
        description: Page number (starting from 0)
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          minimum: 0
          type: integer
          description: Page number (starting from 0)
          example: 4
          default: 0
        example: 4
      - name: searchTerm
        in: query
        description: Filter results by partial name match
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Filter results by partial name match
          example: poli
          default: ""
        example: poli
      - name: sort
        in: query
        description: Sort order for results
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Sort order for results
          example: "updated,DESC"
          default: "name,ASC"
          enum:
          - "name,ASC"
          - "name,DESC"
          - "updated,ASC"
          - "updated,DESC"
        example: "name,ASC"
      - name: x-api-key
        in: header
        description: Harness PAT key used to perform authorization
        required: false
        style: simple
        explode: false
        schema:
          type: string
          description: Harness PAT key used to perform authorization
          example: Voluptatem quos assumenda blanditiis.
        example: Modi molestias natus.
      responses:
        "200":
          description: OK response.
          headers:
            Link:
              description: Link-based paging
              required: true
              style: simple
              explode: false
              schema:
                type: string
                description: Link-based paging
                example: ""
              example: ""
            X-Page-Index:
              description: Page number
              required: true
              style: simple
              explode: false
              schema:
                type: integer
                description: Page number
                format: int64
                example: 4
              example: 4
            X-Page-Item-Count:
              description: Number of results in this page
              required: true
              style: simple
              explode: false
              schema:
                type: integer
                description: Number of results in this page
                format: int64
                example: 20
              example: 20
            X-Page-Size:
              description: Requested page size
              required: true
              style: simple
              explode: false
              schema:
                type: integer
                description: Requested page size
                format: int64
                example: 20
              example: 20
            X-Total-Items:
              description: Total results available
              required: true
              style: simple
              explode: false
              schema:
                type: integer
                description: Total results available
                format: int64
                example: 230
              example: 230
            X-Total-Pages:
              description: Total pages available
              required: true
              style: simple
              explode: false
              schema:
                type: integer
                description: Total pages available
                format: int64
                example: 12
              example: 12
          content:
            application/json:
              schema:
                type: array
                example:
                - account_id: eBqAoNchMLKigC_qZ5EdC
                  created: 1636669297674
                  git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                  git_connector_ref: "."
                  git_default_branch: main
                  git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                  git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                  git_default_branch_file_url: ""
                  git_default_branch_update_error:
                    explanation: "File with given filepath [file.rego] already exists\
                      \ in Github, thus couldn't create a new file"
                    hint: "Please check if there's already a file [file.rego] in Github\
                      \ repository [rego-demo] for the given filepath and branch [main]."
                    message: "Please check if there's already a file [file.rego] in\
                      \ Github repository [rego-demo] for the given filepath and branch\
                      \ [main]."
                  git_default_branch_updated: 1636669297674
                  git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                  git_file_url: ""
                  git_path: .harness/policy.rego
                  git_repo: "github.com/org/repo,omitempty"
                  identifier: policy-1
                  name: Pipeline Approval
                  org_id: test-org
                  project_id: test-project
                  rego: ""
                  updated: 1636669297674
                - account_id: eBqAoNchMLKigC_qZ5EdC
                  created: 1636669297674
                  git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                  git_connector_ref: "."
                  git_default_branch: main
                  git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                  git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                  git_default_branch_file_url: ""
                  git_default_branch_update_error:
                    explanation: "File with given filepath [file.rego] already exists\
                      \ in Github, thus couldn't create a new file"
                    hint: "Please check if there's already a file [file.rego] in Github\
                      \ repository [rego-demo] for the given filepath and branch [main]."
                    message: "Please check if there's already a file [file.rego] in\
                      \ Github repository [rego-demo] for the given filepath and branch\
                      \ [main]."
                  git_default_branch_updated: 1636669297674
                  git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                  git_file_url: ""
                  git_path: .harness/policy.rego
                  git_repo: "github.com/org/repo,omitempty"
                  identifier: policy-1
                  name: Pipeline Approval
                  org_id: test-org
                  project_id: test-project
                  rego: ""
                  updated: 1636669297674
                items:
                  $ref: '#/components/schemas/Policy'
                x-content-type: application/json
              example:
              - account_id: eBqAoNchMLKigC_qZ5EdC
                created: 1636669297674
                git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                git_connector_ref: "."
                git_default_branch: main
                git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                git_default_branch_file_url: ""
                git_default_branch_update_error:
                  explanation: "File with given filepath [file.rego] already exists\
                    \ in Github, thus couldn't create a new file"
                  hint: "Please check if there's already a file [file.rego] in Github\
                    \ repository [rego-demo] for the given filepath and branch [main]."
                  message: "Please check if there's already a file [file.rego] in\
                    \ Github repository [rego-demo] for the given filepath and branch\
                    \ [main]."
                git_default_branch_updated: 1636669297674
                git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                git_file_url: ""
                git_path: .harness/policy.rego
                git_repo: "github.com/org/repo,omitempty"
                identifier: policy-1
                name: Pipeline Approval
                org_id: test-org
                project_id: test-project
                rego: ""
                updated: 1636669297674
              - account_id: eBqAoNchMLKigC_qZ5EdC
                created: 1636669297674
                git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                git_connector_ref: "."
                git_default_branch: main
                git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                git_default_branch_file_url: ""
                git_default_branch_update_error:
                  explanation: "File with given filepath [file.rego] already exists\
                    \ in Github, thus couldn't create a new file"
                  hint: "Please check if there's already a file [file.rego] in Github\
                    \ repository [rego-demo] for the given filepath and branch [main]."
                  message: "Please check if there's already a file [file.rego] in\
                    \ Github repository [rego-demo] for the given filepath and branch\
                    \ [main]."
                git_default_branch_updated: 1636669297674
                git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                git_file_url: ""
                git_path: .harness/policy.rego
                git_repo: "github.com/org/repo,omitempty"
                identifier: policy-1
                name: Pipeline Approval
                org_id: test-org
                project_id: test-project
                rego: ""
                updated: 1636669297674
              - account_id: eBqAoNchMLKigC_qZ5EdC
                created: 1636669297674
                git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                git_connector_ref: "."
                git_default_branch: main
                git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                git_default_branch_file_url: ""
                git_default_branch_update_error:
                  explanation: "File with given filepath [file.rego] already exists\
                    \ in Github, thus couldn't create a new file"
                  hint: "Please check if there's already a file [file.rego] in Github\
                    \ repository [rego-demo] for the given filepath and branch [main]."
                  message: "Please check if there's already a file [file.rego] in\
                    \ Github repository [rego-demo] for the given filepath and branch\
                    \ [main]."
                git_default_branch_updated: 1636669297674
                git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                git_file_url: ""
                git_path: .harness/policy.rego
                git_repo: "github.com/org/repo,omitempty"
                identifier: policy-1
                name: Pipeline Approval
                org_id: test-org
                project_id: test-project
                rego: ""
                updated: 1636669297674
        "400":
          description: "GitError: Bad Request response."
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        "401":
          description: "Unauthorized: Unauthorized response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "403":
          description: "Forbidden: Forbidden response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "404":
          description: "NotFound: Not Found response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "500":
          description: "InternalServer: Internal Server Error response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "502":
          description: "BadGateway: Bad Gateway response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
      security:
      - jwt_header_Authorization:
        - core_governancePolicy_view
        - core_governancePolicy_edit
        - core_governancePolicy_delete
        - core_governancePolicySets_view
        - core_governancePolicySets_edit
        - core_governancePolicySets_delete
        - core_governancePolicySets_evaluate
        - core_governance_admin
      - api_key_header_x-api-key: []
    post:
      tags:
      - policies
      description: Create a policy
      operationId: policies#create
      parameters:
      - name: accountIdentifier
        in: query
        description: Harness account ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness account ID
          example: eBqAoNchMLKigC_qZ5EdC
          default: ""
        example: eBqAoNchMLKigC_qZ5EdC
      - name: orgIdentifier
        in: query
        description: Harness organization ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness organization ID
          example: test-org
          default: ""
        example: test-org
      - name: projectIdentifier
        in: query
        description: Harness project ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness project ID
          example: test-project
          default: ""
        example: test-project
      - name: git_commit_msg
        in: query
        description: The commit message used in git when creating the policy
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: The commit message used in git when creating the policy
          example: harness policy commit msg
        example: harness policy commit msg
      - name: git_import
        in: query
        description: A flag to determine if the api should try and import and existing
          policy from git
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: boolean
          description: A flag to determine if the api should try and import and existing
            policy from git
          example: true
        example: true
      - name: git_branch
        in: query
        description: The git branch the policy will be created in
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: The git branch the policy will be created in
          example: main
        example: main
      - name: git_is_new_branch
        in: query
        description: A flag to determine if the api should try and commit to a new
          branch
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: boolean
          description: A flag to determine if the api should try and commit to a new
            branch
          example: true
        example: true
      - name: git_base_branch
        in: query
        description: "If committing to a new branch, git_base_branch tells the api\
          \ which branch to base the new branch from"
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: "If committing to a new branch, git_base_branch tells the api\
            \ which branch to base the new branch from"
          example: main
        example: main
      - name: x-api-key
        in: header
        description: Harness PAT key used to perform authorization
        required: false
        style: simple
        explode: false
        schema:
          type: string
          description: Harness PAT key used to perform authorization
          example: Dolor nam impedit sunt sint.
        example: Est dolorum molestias.
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateRequestBody'
            example:
              git_connector_ref: "."
              git_path: .harness/policy.rego
              git_repo: github.com/org/repo
              identifier: policy-1
              name: Check that an approval step is present
              rego: |-
                package test
                deny["should say hello world"] {input.message != "world"}
        required: true
      responses:
        "201":
          description: Created response.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Policy'
              example:
                account_id: eBqAoNchMLKigC_qZ5EdC
                created: 1636669297674
                git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                git_connector_ref: "."
                git_default_branch: main
                git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                git_default_branch_file_url: ""
                git_default_branch_update_error:
                  explanation: "File with given filepath [file.rego] already exists\
                    \ in Github, thus couldn't create a new file"
                  hint: "Please check if there's already a file [file.rego] in Github\
                    \ repository [rego-demo] for the given filepath and branch [main]."
                  message: "Please check if there's already a file [file.rego] in\
                    \ Github repository [rego-demo] for the given filepath and branch\
                    \ [main]."
                git_default_branch_updated: 1636669297674
                git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                git_file_url: ""
                git_path: .harness/policy.rego
                git_repo: "github.com/org/repo,omitempty"
                identifier: policy-1
                name: Pipeline Approval
                org_id: test-org
                project_id: test-project
                rego: ""
                updated: 1636669297674
        "400":
          description: "GitError: Bad Request response."
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        "401":
          description: "Unauthorized: Unauthorized response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "403":
          description: "Forbidden: Forbidden response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "404":
          description: "NotFound: Not Found response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "500":
          description: "InternalServer: Internal Server Error response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "502":
          description: "BadGateway: Bad Gateway response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
      security:
      - jwt_header_Authorization:
        - core_governancePolicy_view
        - core_governancePolicy_edit
        - core_governancePolicy_delete
        - core_governancePolicySets_view
        - core_governancePolicySets_edit
        - core_governancePolicySets_delete
        - core_governancePolicySets_evaluate
        - core_governance_admin
      - api_key_header_x-api-key: []
  /api/v1/policies/{identifier}:
    get:
      tags:
      - policies
      description: Find a policy by identifier
      operationId: policies#find
      parameters:
      - name: accountIdentifier
        in: query
        description: Harness account ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness account ID
          example: eBqAoNchMLKigC_qZ5EdC
          default: ""
        example: eBqAoNchMLKigC_qZ5EdC
      - name: orgIdentifier
        in: query
        description: Harness organization ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness organization ID
          example: test-org
          default: ""
        example: test-org
      - name: projectIdentifier
        in: query
        description: Harness project ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness project ID
          example: test-project
          default: ""
        example: test-project
      - name: git_branch
        in: query
        description: The git branch the policy resides in
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: The git branch the policy resides in
          example: main
        example: main
      - name: show_summary
        in: query
        description: "Setting to true returns the metadata about the\n\t\t\t    requested\
          \ policy including the information held about the status of this policy\
          \ in the default branch.\n\t\t\t    git_branch is ignored as no git operation\
          \ takes place."
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: boolean
          description: "Setting to true returns the metadata about the\n\t\t\t   \
            \ requested policy including the information held about the status of\
            \ this policy in the default branch.\n\t\t\t    git_branch is ignored\
            \ as no git operation takes place."
          example: true
        example: true
      - name: identifier
        in: path
        description: Identifier of the policy to retrieve
        required: true
        style: simple
        explode: false
        schema:
          minLength: 1
          type: string
          description: Identifier of the policy to retrieve
          example: policy-1
        examples:
          default:
            summary: default
            value: policy-1
      - name: x-api-key
        in: header
        description: Harness PAT key used to perform authorization
        required: false
        style: simple
        explode: false
        schema:
          type: string
          description: Harness PAT key used to perform authorization
          example: Molestiae accusantium.
        example: Fugit ut qui voluptatem ea et at.
      responses:
        "200":
          description: OK response.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Policy'
              example:
                account_id: eBqAoNchMLKigC_qZ5EdC
                created: 1636669297674
                git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                git_connector_ref: "."
                git_default_branch: main
                git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                git_default_branch_file_url: ""
                git_default_branch_update_error:
                  explanation: "File with given filepath [file.rego] already exists\
                    \ in Github, thus couldn't create a new file"
                  hint: "Please check if there's already a file [file.rego] in Github\
                    \ repository [rego-demo] for the given filepath and branch [main]."
                  message: "Please check if there's already a file [file.rego] in\
                    \ Github repository [rego-demo] for the given filepath and branch\
                    \ [main]."
                git_default_branch_updated: 1636669297674
                git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                git_file_url: ""
                git_path: .harness/policy.rego
                git_repo: "github.com/org/repo,omitempty"
                identifier: policy-1
                name: Pipeline Approval
                org_id: test-org
                project_id: test-project
                rego: ""
                updated: 1636669297674
        "400":
          description: "GitError: Bad Request response."
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        "401":
          description: "Unauthorized: Unauthorized response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "403":
          description: "Forbidden: Forbidden response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "404":
          description: "NotFound: Not Found response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "500":
          description: "InternalServer: Internal Server Error response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "502":
          description: "BadGateway: Bad Gateway response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
      security:
      - jwt_header_Authorization:
        - core_governancePolicy_view
        - core_governancePolicy_edit
        - core_governancePolicy_delete
        - core_governancePolicySets_view
        - core_governancePolicySets_edit
        - core_governancePolicySets_delete
        - core_governancePolicySets_evaluate
        - core_governance_admin
      - api_key_header_x-api-key: []
    delete:
      tags:
      - policies
      description: Delete a policy by identifier
      operationId: policies#delete
      parameters:
      - name: accountIdentifier
        in: query
        description: Harness account ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness account ID
          example: eBqAoNchMLKigC_qZ5EdC
          default: ""
        example: eBqAoNchMLKigC_qZ5EdC
      - name: orgIdentifier
        in: query
        description: Harness organization ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness organization ID
          example: test-org
          default: ""
        example: test-org
      - name: projectIdentifier
        in: query
        description: Harness project ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness project ID
          example: test-project
          default: ""
        example: test-project
      - name: identifier
        in: path
        description: Identifier of the policy
        required: true
        style: simple
        explode: false
        schema:
          minLength: 1
          type: string
          description: Identifier of the policy
          example: policy-1
        examples:
          default:
            summary: default
            value: policy-1
      - name: x-api-key
        in: header
        description: Harness PAT key used to perform authorization
        required: false
        style: simple
        explode: false
        schema:
          type: string
          description: Harness PAT key used to perform authorization
          example: Labore quia assumenda nobis in.
        example: Tempora accusantium praesentium ratione aperiam facere iusto.
      responses:
        "204":
          description: No Content response.
        "400":
          description: "GitError: Bad Request response."
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        "401":
          description: "Unauthorized: Unauthorized response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "403":
          description: "Forbidden: Forbidden response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "404":
          description: "NotFound: Not Found response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "500":
          description: "InternalServer: Internal Server Error response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "502":
          description: "BadGateway: Bad Gateway response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
      security:
      - jwt_header_Authorization:
        - core_governancePolicy_view
        - core_governancePolicy_edit
        - core_governancePolicy_delete
        - core_governancePolicySets_view
        - core_governancePolicySets_edit
        - core_governancePolicySets_delete
        - core_governancePolicySets_evaluate
        - core_governance_admin
      - api_key_header_x-api-key: []
    patch:
      tags:
      - policies
      description: Update a policy by identifier
      operationId: policies#update
      parameters:
      - name: git_commit_msg
        in: query
        description: The commit message used in git when creating the policy
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: The commit message used in git when creating the policy
          example: harness policy commit msg
        example: harness policy commit msg
      - name: git_is_new_branch
        in: query
        description: A flag to determine if the api should try and commit to a new
          branch
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: boolean
          description: A flag to determine if the api should try and commit to a new
            branch
          example: true
        example: true
      - name: git_base_branch
        in: query
        description: "If committing to a new branch, git_base_branch tells the api\
          \ which branch to base the new branch from"
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: "If committing to a new branch, git_base_branch tells the api\
            \ which branch to base the new branch from"
          example: main
        example: main
      - name: git_branch
        in: query
        description: The git branch the policy resides in
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: The git branch the policy resides in
          example: main
        example: main
      - name: git_commit_sha
        in: query
        description: The existing commit sha of the file being updated
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: The existing commit sha of the file being updated
          example: 1369b45c20fc685113adcfd1a08a914180ff3c0d
        example: 1369b45c20fc685113adcfd1a08a914180ff3c0d
      - name: git_file_id
        in: query
        description: "The existing file id of the file being updated, not required\
          \ for bitbucket files"
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: "The existing file id of the file being updated, not required\
            \ for bitbucket files"
          example: 1369b45c20fc685113adcfd1a08a914180ff3c0d
        example: 1369b45c20fc685113adcfd1a08a914180ff3c0d
      - name: accountIdentifier
        in: query
        description: Harness account ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness account ID
          example: eBqAoNchMLKigC_qZ5EdC
          default: ""
        example: eBqAoNchMLKigC_qZ5EdC
      - name: orgIdentifier
        in: query
        description: Harness organization ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness organization ID
          example: test-org
          default: ""
        example: test-org
      - name: projectIdentifier
        in: query
        description: Harness project ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness project ID
          example: test-project
          default: ""
        example: test-project
      - name: identifier
        in: path
        description: Identifier of the policy
        required: true
        style: simple
        explode: false
        schema:
          type: string
          description: Identifier of the policy
          example: policy-1
        example: policy-1
      - name: x-api-key
        in: header
        description: Harness PAT key used to perform authorization
        required: false
        style: simple
        explode: false
        schema:
          type: string
          description: Harness PAT key used to perform authorization
          example: Tempore non beatae suscipit qui qui.
        example: Fuga maiores excepturi voluptates architecto.
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateRequestBody'
            example:
              name: Check that an approval step is present
              rego: |-
                package test
                deny["should say hello world"] {input.message != "world"}
        required: true
      responses:
        "204":
          description: No Content response.
        "400":
          description: "GitError: Bad Request response."
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        "401":
          description: "Unauthorized: Unauthorized response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "403":
          description: "Forbidden: Forbidden response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "404":
          description: "NotFound: Not Found response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "500":
          description: "InternalServer: Internal Server Error response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "502":
          description: "BadGateway: Bad Gateway response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
      security:
      - jwt_header_Authorization:
        - core_governancePolicy_view
        - core_governancePolicy_edit
        - core_governancePolicy_delete
        - core_governancePolicySets_view
        - core_governancePolicySets_edit
        - core_governancePolicySets_delete
        - core_governancePolicySets_evaluate
        - core_governance_admin
      - api_key_header_x-api-key: []
  /api/v1/policysets:
    get:
      tags:
      - policysets
      description: List all policy sets
      operationId: policysets#list
      parameters:
      - name: accountIdentifier
        in: query
        description: Harness account ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness account ID
          example: eBqAoNchMLKigC_qZ5EdC
          default: ""
        example: eBqAoNchMLKigC_qZ5EdC
      - name: orgIdentifier
        in: query
        description: Harness organization ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness organization ID
          example: test-org
          default: ""
        example: test-org
      - name: projectIdentifier
        in: query
        description: Harness project ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness project ID
          example: test-project
          default: ""
        example: test-project
      - name: per_page
        in: query
        description: Number of results per page
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          maximum: 100
          minimum: 1
          type: integer
          description: Number of results per page
          example: 20
          default: 50
        example: 20
      - name: page
        in: query
        description: Page number (starting from 0)
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          minimum: 0
          type: integer
          description: Page number (starting from 0)
          example: 4
          default: 0
        example: 4
      - name: searchTerm
        in: query
        description: Filter results by partial name match
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Filter results by partial name match
          example: poli
          default: ""
        example: poli
      - name: sort
        in: query
        description: Sort order for results
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Sort order for results
          example: "updated,ASC"
          default: "name,ASC"
          enum:
          - "name,ASC"
          - "name,DESC"
          - "updated,ASC"
          - "updated,DESC"
        example: "name,DESC"
      - name: type
        in: query
        description: Filter results by type
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          minLength: 1
          type: string
          description: Filter results by type
          example: pipeline
        example: pipeline
      - name: action
        in: query
        description: Filter results by action
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          minLength: 1
          type: string
          description: Filter results by action
          example: onrun
        example: onrun
      - name: x-api-key
        in: header
        description: Harness PAT key used to perform authorization
        required: false
        style: simple
        explode: false
        schema:
          type: string
          description: Harness PAT key used to perform authorization
          example: Cupiditate qui minus molestias aspernatur.
        example: Velit maxime repudiandae velit dolores itaque neque.
      responses:
        "200":
          description: OK response.
          headers:
            Link:
              description: Link-based paging
              required: true
              style: simple
              explode: false
              schema:
                type: string
                description: Link-based paging
                example: ""
              example: ""
            X-Page-Index:
              description: Page number
              required: true
              style: simple
              explode: false
              schema:
                type: integer
                description: Page number
                format: int64
                example: 4
              example: 4
            X-Page-Item-Count:
              description: Number of results in this page
              required: true
              style: simple
              explode: false
              schema:
                type: integer
                description: Number of results in this page
                format: int64
                example: 20
              example: 20
            X-Page-Size:
              description: Requested page size
              required: true
              style: simple
              explode: false
              schema:
                type: integer
                description: Requested page size
                format: int64
                example: 20
              example: 20
            X-Total-Items:
              description: Total results available
              required: true
              style: simple
              explode: false
              schema:
                type: integer
                description: Total results available
                format: int64
                example: 230
              example: 230
            X-Total-Pages:
              description: Total pages available
              required: true
              style: simple
              explode: false
              schema:
                type: integer
                description: Total pages available
                format: int64
                example: 12
              example: 12
          content:
            application/json:
              schema:
                type: array
                example:
                - account_id: eBqAoNchMLKigC_qZ5EdC
                  action: onrun
                  created: 1636669297674
                  description: Captures critical production policies
                  enabled: true
                  entity_selector: all_entities_in_scope
                  identifier: policyset-1
                  name: Production Policies
                  org_id: test-org
                  policies:
                  - account_id: eBqAoNchMLKigC_qZ5EdC
                    created: 1636669297674
                    identifier: policy-1
                    name: Pipeline Approval
                    org_id: test-org
                    project_id: test-project
                    rego: ""
                    severity: warning
                    updated: 1636669297674
                  - account_id: eBqAoNchMLKigC_qZ5EdC
                    created: 1636669297674
                    identifier: policy-1
                    name: Pipeline Approval
                    org_id: test-org
                    project_id: test-project
                    rego: ""
                    severity: warning
                    updated: 1636669297674
                  - account_id: eBqAoNchMLKigC_qZ5EdC
                    created: 1636669297674
                    identifier: policy-1
                    name: Pipeline Approval
                    org_id: test-org
                    project_id: test-project
                    rego: ""
                    severity: warning
                    updated: 1636669297674
                  project_id: test-project
                  resource_groups:
                  - account_id: Saepe aut soluta ut quia.
                    created: 6663809881773907149
                    identifier: Quia vero a ut nihil.
                    name: Veniam quisquam quasi ut sint.
                    org_id: Excepturi saepe quos natus.
                    project_id: Debitis provident et.
                  - account_id: Saepe aut soluta ut quia.
                    created: 6663809881773907149
                    identifier: Quia vero a ut nihil.
                    name: Veniam quisquam quasi ut sint.
                    org_id: Excepturi saepe quos natus.
                    project_id: Debitis provident et.
                  type: pipeline
                  updated: 1636669297674
                - account_id: eBqAoNchMLKigC_qZ5EdC
                  action: onrun
                  created: 1636669297674
                  description: Captures critical production policies
                  enabled: true
                  entity_selector: all_entities_in_scope
                  identifier: policyset-1
                  name: Production Policies
                  org_id: test-org
                  policies:
                  - account_id: eBqAoNchMLKigC_qZ5EdC
                    created: 1636669297674
                    identifier: policy-1
                    name: Pipeline Approval
                    org_id: test-org
                    project_id: test-project
                    rego: ""
                    severity: warning
                    updated: 1636669297674
                  - account_id: eBqAoNchMLKigC_qZ5EdC
                    created: 1636669297674
                    identifier: policy-1
                    name: Pipeline Approval
                    org_id: test-org
                    project_id: test-project
                    rego: ""
                    severity: warning
                    updated: 1636669297674
                  - account_id: eBqAoNchMLKigC_qZ5EdC
                    created: 1636669297674
                    identifier: policy-1
                    name: Pipeline Approval
                    org_id: test-org
                    project_id: test-project
                    rego: ""
                    severity: warning
                    updated: 1636669297674
                  project_id: test-project
                  resource_groups:
                  - account_id: Saepe aut soluta ut quia.
                    created: 6663809881773907149
                    identifier: Quia vero a ut nihil.
                    name: Veniam quisquam quasi ut sint.
                    org_id: Excepturi saepe quos natus.
                    project_id: Debitis provident et.
                  - account_id: Saepe aut soluta ut quia.
                    created: 6663809881773907149
                    identifier: Quia vero a ut nihil.
                    name: Veniam quisquam quasi ut sint.
                    org_id: Excepturi saepe quos natus.
                    project_id: Debitis provident et.
                  type: pipeline
                  updated: 1636669297674
                - account_id: eBqAoNchMLKigC_qZ5EdC
                  action: onrun
                  created: 1636669297674
                  description: Captures critical production policies
                  enabled: true
                  entity_selector: all_entities_in_scope
                  identifier: policyset-1
                  name: Production Policies
                  org_id: test-org
                  policies:
                  - account_id: eBqAoNchMLKigC_qZ5EdC
                    created: 1636669297674
                    identifier: policy-1
                    name: Pipeline Approval
                    org_id: test-org
                    project_id: test-project
                    rego: ""
                    severity: warning
                    updated: 1636669297674
                  - account_id: eBqAoNchMLKigC_qZ5EdC
                    created: 1636669297674
                    identifier: policy-1
                    name: Pipeline Approval
                    org_id: test-org
                    project_id: test-project
                    rego: ""
                    severity: warning
                    updated: 1636669297674
                  - account_id: eBqAoNchMLKigC_qZ5EdC
                    created: 1636669297674
                    identifier: policy-1
                    name: Pipeline Approval
                    org_id: test-org
                    project_id: test-project
                    rego: ""
                    severity: warning
                    updated: 1636669297674
                  project_id: test-project
                  resource_groups:
                  - account_id: Saepe aut soluta ut quia.
                    created: 6663809881773907149
                    identifier: Quia vero a ut nihil.
                    name: Veniam quisquam quasi ut sint.
                    org_id: Excepturi saepe quos natus.
                    project_id: Debitis provident et.
                  - account_id: Saepe aut soluta ut quia.
                    created: 6663809881773907149
                    identifier: Quia vero a ut nihil.
                    name: Veniam quisquam quasi ut sint.
                    org_id: Excepturi saepe quos natus.
                    project_id: Debitis provident et.
                  type: pipeline
                  updated: 1636669297674
                - account_id: eBqAoNchMLKigC_qZ5EdC
                  action: onrun
                  created: 1636669297674
                  description: Captures critical production policies
                  enabled: true
                  entity_selector: all_entities_in_scope
                  identifier: policyset-1
                  name: Production Policies
                  org_id: test-org
                  policies:
                  - account_id: eBqAoNchMLKigC_qZ5EdC
                    created: 1636669297674
                    identifier: policy-1
                    name: Pipeline Approval
                    org_id: test-org
                    project_id: test-project
                    rego: ""
                    severity: warning
                    updated: 1636669297674
                  - account_id: eBqAoNchMLKigC_qZ5EdC
                    created: 1636669297674
                    identifier: policy-1
                    name: Pipeline Approval
                    org_id: test-org
                    project_id: test-project
                    rego: ""
                    severity: warning
                    updated: 1636669297674
                  - account_id: eBqAoNchMLKigC_qZ5EdC
                    created: 1636669297674
                    identifier: policy-1
                    name: Pipeline Approval
                    org_id: test-org
                    project_id: test-project
                    rego: ""
                    severity: warning
                    updated: 1636669297674
                  project_id: test-project
                  resource_groups:
                  - account_id: Saepe aut soluta ut quia.
                    created: 6663809881773907149
                    identifier: Quia vero a ut nihil.
                    name: Veniam quisquam quasi ut sint.
                    org_id: Excepturi saepe quos natus.
                    project_id: Debitis provident et.
                  - account_id: Saepe aut soluta ut quia.
                    created: 6663809881773907149
                    identifier: Quia vero a ut nihil.
                    name: Veniam quisquam quasi ut sint.
                    org_id: Excepturi saepe quos natus.
                    project_id: Debitis provident et.
                  type: pipeline
                  updated: 1636669297674
                items:
                  $ref: '#/components/schemas/PolicySet'
                x-content-type: application/json
              example:
              - account_id: eBqAoNchMLKigC_qZ5EdC
                action: onrun
                created: 1636669297674
                description: Captures critical production policies
                enabled: true
                entity_selector: all_entities_in_scope
                identifier: policyset-1
                name: Production Policies
                org_id: test-org
                policies:
                - account_id: eBqAoNchMLKigC_qZ5EdC
                  created: 1636669297674
                  identifier: policy-1
                  name: Pipeline Approval
                  org_id: test-org
                  project_id: test-project
                  rego: ""
                  severity: warning
                  updated: 1636669297674
                - account_id: eBqAoNchMLKigC_qZ5EdC
                  created: 1636669297674
                  identifier: policy-1
                  name: Pipeline Approval
                  org_id: test-org
                  project_id: test-project
                  rego: ""
                  severity: warning
                  updated: 1636669297674
                - account_id: eBqAoNchMLKigC_qZ5EdC
                  created: 1636669297674
                  identifier: policy-1
                  name: Pipeline Approval
                  org_id: test-org
                  project_id: test-project
                  rego: ""
                  severity: warning
                  updated: 1636669297674
                project_id: test-project
                resource_groups:
                - account_id: Saepe aut soluta ut quia.
                  created: 6663809881773907149
                  identifier: Quia vero a ut nihil.
                  name: Veniam quisquam quasi ut sint.
                  org_id: Excepturi saepe quos natus.
                  project_id: Debitis provident et.
                - account_id: Saepe aut soluta ut quia.
                  created: 6663809881773907149
                  identifier: Quia vero a ut nihil.
                  name: Veniam quisquam quasi ut sint.
                  org_id: Excepturi saepe quos natus.
                  project_id: Debitis provident et.
                type: pipeline
                updated: 1636669297674
              - account_id: eBqAoNchMLKigC_qZ5EdC
                action: onrun
                created: 1636669297674
                description: Captures critical production policies
                enabled: true
                entity_selector: all_entities_in_scope
                identifier: policyset-1
                name: Production Policies
                org_id: test-org
                policies:
                - account_id: eBqAoNchMLKigC_qZ5EdC
                  created: 1636669297674
                  identifier: policy-1
                  name: Pipeline Approval
                  org_id: test-org
                  project_id: test-project
                  rego: ""
                  severity: warning
                  updated: 1636669297674
                - account_id: eBqAoNchMLKigC_qZ5EdC
                  created: 1636669297674
                  identifier: policy-1
                  name: Pipeline Approval
                  org_id: test-org
                  project_id: test-project
                  rego: ""
                  severity: warning
                  updated: 1636669297674
                - account_id: eBqAoNchMLKigC_qZ5EdC
                  created: 1636669297674
                  identifier: policy-1
                  name: Pipeline Approval
                  org_id: test-org
                  project_id: test-project
                  rego: ""
                  severity: warning
                  updated: 1636669297674
                project_id: test-project
                resource_groups:
                - account_id: Saepe aut soluta ut quia.
                  created: 6663809881773907149
                  identifier: Quia vero a ut nihil.
                  name: Veniam quisquam quasi ut sint.
                  org_id: Excepturi saepe quos natus.
                  project_id: Debitis provident et.
                - account_id: Saepe aut soluta ut quia.
                  created: 6663809881773907149
                  identifier: Quia vero a ut nihil.
                  name: Veniam quisquam quasi ut sint.
                  org_id: Excepturi saepe quos natus.
                  project_id: Debitis provident et.
                type: pipeline
                updated: 1636669297674
              - account_id: eBqAoNchMLKigC_qZ5EdC
                action: onrun
                created: 1636669297674
                description: Captures critical production policies
                enabled: true
                entity_selector: all_entities_in_scope
                identifier: policyset-1
                name: Production Policies
                org_id: test-org
                policies:
                - account_id: eBqAoNchMLKigC_qZ5EdC
                  created: 1636669297674
                  identifier: policy-1
                  name: Pipeline Approval
                  org_id: test-org
                  project_id: test-project
                  rego: ""
                  severity: warning
                  updated: 1636669297674
                - account_id: eBqAoNchMLKigC_qZ5EdC
                  created: 1636669297674
                  identifier: policy-1
                  name: Pipeline Approval
                  org_id: test-org
                  project_id: test-project
                  rego: ""
                  severity: warning
                  updated: 1636669297674
                - account_id: eBqAoNchMLKigC_qZ5EdC
                  created: 1636669297674
                  identifier: policy-1
                  name: Pipeline Approval
                  org_id: test-org
                  project_id: test-project
                  rego: ""
                  severity: warning
                  updated: 1636669297674
                project_id: test-project
                resource_groups:
                - account_id: Saepe aut soluta ut quia.
                  created: 6663809881773907149
                  identifier: Quia vero a ut nihil.
                  name: Veniam quisquam quasi ut sint.
                  org_id: Excepturi saepe quos natus.
                  project_id: Debitis provident et.
                - account_id: Saepe aut soluta ut quia.
                  created: 6663809881773907149
                  identifier: Quia vero a ut nihil.
                  name: Veniam quisquam quasi ut sint.
                  org_id: Excepturi saepe quos natus.
                  project_id: Debitis provident et.
                type: pipeline
                updated: 1636669297674
              - account_id: eBqAoNchMLKigC_qZ5EdC
                action: onrun
                created: 1636669297674
                description: Captures critical production policies
                enabled: true
                entity_selector: all_entities_in_scope
                identifier: policyset-1
                name: Production Policies
                org_id: test-org
                policies:
                - account_id: eBqAoNchMLKigC_qZ5EdC
                  created: 1636669297674
                  identifier: policy-1
                  name: Pipeline Approval
                  org_id: test-org
                  project_id: test-project
                  rego: ""
                  severity: warning
                  updated: 1636669297674
                - account_id: eBqAoNchMLKigC_qZ5EdC
                  created: 1636669297674
                  identifier: policy-1
                  name: Pipeline Approval
                  org_id: test-org
                  project_id: test-project
                  rego: ""
                  severity: warning
                  updated: 1636669297674
                - account_id: eBqAoNchMLKigC_qZ5EdC
                  created: 1636669297674
                  identifier: policy-1
                  name: Pipeline Approval
                  org_id: test-org
                  project_id: test-project
                  rego: ""
                  severity: warning
                  updated: 1636669297674
                project_id: test-project
                resource_groups:
                - account_id: Saepe aut soluta ut quia.
                  created: 6663809881773907149
                  identifier: Quia vero a ut nihil.
                  name: Veniam quisquam quasi ut sint.
                  org_id: Excepturi saepe quos natus.
                  project_id: Debitis provident et.
                - account_id: Saepe aut soluta ut quia.
                  created: 6663809881773907149
                  identifier: Quia vero a ut nihil.
                  name: Veniam quisquam quasi ut sint.
                  org_id: Excepturi saepe quos natus.
                  project_id: Debitis provident et.
                type: pipeline
                updated: 1636669297674
        "400":
          description: "BadRequest: Bad Request response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "401":
          description: "Unauthorized: Unauthorized response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "403":
          description: "Forbidden: Forbidden response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "404":
          description: "NotFound: Not Found response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "500":
          description: "InternalServer: Internal Server Error response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "502":
          description: "BadGateway: Bad Gateway response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
      security:
      - jwt_header_Authorization:
        - core_governancePolicy_view
        - core_governancePolicy_edit
        - core_governancePolicy_delete
        - core_governancePolicySets_view
        - core_governancePolicySets_edit
        - core_governancePolicySets_delete
        - core_governancePolicySets_evaluate
        - core_governance_admin
      - api_key_header_x-api-key: []
    post:
      tags:
      - policysets
      description: Create a policy set
      operationId: policysets#create
      parameters:
      - name: accountIdentifier
        in: query
        description: Harness account ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness account ID
          example: eBqAoNchMLKigC_qZ5EdC
          default: ""
        example: eBqAoNchMLKigC_qZ5EdC
      - name: orgIdentifier
        in: query
        description: Harness organization ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness organization ID
          example: test-org
          default: ""
        example: test-org
      - name: projectIdentifier
        in: query
        description: Harness project ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness project ID
          example: test-project
          default: ""
        example: test-project
      - name: x-api-key
        in: header
        description: Harness PAT key used to perform authorization
        required: false
        style: simple
        explode: false
        schema:
          type: string
          description: Harness PAT key used to perform authorization
          example: Modi quia est vel.
        example: Voluptas et repudiandae sint fugit consequatur sunt.
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateRequestBody2'
            example:
              action: onrun
              description: Captures critical production policies
              enabled: true
              identifier: policyset-1
              name: Production Policies
              type: pipeline
        required: true
      responses:
        "201":
          description: Created response.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PolicySet'
              example:
                account_id: eBqAoNchMLKigC_qZ5EdC
                action: onrun
                created: 1636669297674
                description: Captures critical production policies
                enabled: true
                entity_selector: all_entities_in_scope
                identifier: policyset-1
                name: Production Policies
                org_id: test-org
                policies:
                - account_id: eBqAoNchMLKigC_qZ5EdC
                  created: 1636669297674
                  identifier: policy-1
                  name: Pipeline Approval
                  org_id: test-org
                  project_id: test-project
                  rego: ""
                  severity: warning
                  updated: 1636669297674
                - account_id: eBqAoNchMLKigC_qZ5EdC
                  created: 1636669297674
                  identifier: policy-1
                  name: Pipeline Approval
                  org_id: test-org
                  project_id: test-project
                  rego: ""
                  severity: warning
                  updated: 1636669297674
                - account_id: eBqAoNchMLKigC_qZ5EdC
                  created: 1636669297674
                  identifier: policy-1
                  name: Pipeline Approval
                  org_id: test-org
                  project_id: test-project
                  rego: ""
                  severity: warning
                  updated: 1636669297674
                project_id: test-project
                resource_groups:
                - account_id: Natus in voluptatibus eum.
                  created: 8207205165608517655
                  identifier: Alias quaerat accusamus aut voluptatem illo voluptate.
                  name: Dolor voluptatibus error quia dolores molestiae.
                  org_id: Accusantium sed.
                  project_id: Officiis voluptatem corrupti amet porro.
                - account_id: Natus in voluptatibus eum.
                  created: 8207205165608517655
                  identifier: Alias quaerat accusamus aut voluptatem illo voluptate.
                  name: Dolor voluptatibus error quia dolores molestiae.
                  org_id: Accusantium sed.
                  project_id: Officiis voluptatem corrupti amet porro.
                - account_id: Natus in voluptatibus eum.
                  created: 8207205165608517655
                  identifier: Alias quaerat accusamus aut voluptatem illo voluptate.
                  name: Dolor voluptatibus error quia dolores molestiae.
                  org_id: Accusantium sed.
                  project_id: Officiis voluptatem corrupti amet porro.
                - account_id: Natus in voluptatibus eum.
                  created: 8207205165608517655
                  identifier: Alias quaerat accusamus aut voluptatem illo voluptate.
                  name: Dolor voluptatibus error quia dolores molestiae.
                  org_id: Accusantium sed.
                  project_id: Officiis voluptatem corrupti amet porro.
                type: pipeline
                updated: 1636669297674
        "400":
          description: "BadRequest: Bad Request response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "401":
          description: "Unauthorized: Unauthorized response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "403":
          description: "Forbidden: Forbidden response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "404":
          description: "NotFound: Not Found response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "500":
          description: "InternalServer: Internal Server Error response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "502":
          description: "BadGateway: Bad Gateway response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
      security:
      - jwt_header_Authorization:
        - core_governancePolicy_view
        - core_governancePolicy_edit
        - core_governancePolicy_delete
        - core_governancePolicySets_view
        - core_governancePolicySets_edit
        - core_governancePolicySets_delete
        - core_governancePolicySets_evaluate
        - core_governance_admin
      - api_key_header_x-api-key: []
  /api/v1/policysets/{identifier}:
    get:
      tags:
      - policysets
      description: Find a policy set by identifier
      operationId: policysets#find
      parameters:
      - name: accountIdentifier
        in: query
        description: Harness account ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness account ID
          example: eBqAoNchMLKigC_qZ5EdC
          default: ""
        example: eBqAoNchMLKigC_qZ5EdC
      - name: orgIdentifier
        in: query
        description: Harness organization ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness organization ID
          example: test-org
          default: ""
        example: test-org
      - name: projectIdentifier
        in: query
        description: Harness project ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness project ID
          example: test-project
          default: ""
        example: test-project
      - name: identifier
        in: path
        description: Identifier of the policy set to retrieve
        required: true
        style: simple
        explode: false
        schema:
          minLength: 1
          type: string
          description: Identifier of the policy set to retrieve
          example: policyset-1
        examples:
          default:
            summary: default
            value: policyset-1
      - name: x-api-key
        in: header
        description: Harness PAT key used to perform authorization
        required: false
        style: simple
        explode: false
        schema:
          type: string
          description: Harness PAT key used to perform authorization
          example: Molestiae nobis.
        example: Eos et neque debitis.
      responses:
        "200":
          description: OK response.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PolicySet'
              example:
                account_id: eBqAoNchMLKigC_qZ5EdC
                action: onrun
                created: 1636669297674
                description: Captures critical production policies
                enabled: true
                entity_selector: all_entities_in_resource_groups
                identifier: policyset-1
                name: Production Policies
                org_id: test-org
                policies:
                - account_id: eBqAoNchMLKigC_qZ5EdC
                  created: 1636669297674
                  identifier: policy-1
                  name: Pipeline Approval
                  org_id: test-org
                  project_id: test-project
                  rego: ""
                  severity: warning
                  updated: 1636669297674
                - account_id: eBqAoNchMLKigC_qZ5EdC
                  created: 1636669297674
                  identifier: policy-1
                  name: Pipeline Approval
                  org_id: test-org
                  project_id: test-project
                  rego: ""
                  severity: warning
                  updated: 1636669297674
                - account_id: eBqAoNchMLKigC_qZ5EdC
                  created: 1636669297674
                  identifier: policy-1
                  name: Pipeline Approval
                  org_id: test-org
                  project_id: test-project
                  rego: ""
                  severity: warning
                  updated: 1636669297674
                project_id: test-project
                resource_groups:
                - account_id: Natus in voluptatibus eum.
                  created: 8207205165608517655
                  identifier: Alias quaerat accusamus aut voluptatem illo voluptate.
                  name: Dolor voluptatibus error quia dolores molestiae.
                  org_id: Accusantium sed.
                  project_id: Officiis voluptatem corrupti amet porro.
                - account_id: Natus in voluptatibus eum.
                  created: 8207205165608517655
                  identifier: Alias quaerat accusamus aut voluptatem illo voluptate.
                  name: Dolor voluptatibus error quia dolores molestiae.
                  org_id: Accusantium sed.
                  project_id: Officiis voluptatem corrupti amet porro.
                - account_id: Natus in voluptatibus eum.
                  created: 8207205165608517655
                  identifier: Alias quaerat accusamus aut voluptatem illo voluptate.
                  name: Dolor voluptatibus error quia dolores molestiae.
                  org_id: Accusantium sed.
                  project_id: Officiis voluptatem corrupti amet porro.
                type: pipeline
                updated: 1636669297674
        "400":
          description: "BadRequest: Bad Request response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "401":
          description: "Unauthorized: Unauthorized response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "403":
          description: "Forbidden: Forbidden response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "404":
          description: "NotFound: Not Found response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "500":
          description: "InternalServer: Internal Server Error response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "502":
          description: "BadGateway: Bad Gateway response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
      security:
      - jwt_header_Authorization:
        - core_governancePolicy_view
        - core_governancePolicy_edit
        - core_governancePolicy_delete
        - core_governancePolicySets_view
        - core_governancePolicySets_edit
        - core_governancePolicySets_delete
        - core_governancePolicySets_evaluate
        - core_governance_admin
      - api_key_header_x-api-key: []
    delete:
      tags:
      - policysets
      description: Delete a policy set by identifier
      operationId: policysets#delete
      parameters:
      - name: accountIdentifier
        in: query
        description: Harness account ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness account ID
          example: eBqAoNchMLKigC_qZ5EdC
          default: ""
        example: eBqAoNchMLKigC_qZ5EdC
      - name: orgIdentifier
        in: query
        description: Harness organization ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness organization ID
          example: test-org
          default: ""
        example: test-org
      - name: projectIdentifier
        in: query
        description: Harness project ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness project ID
          example: test-project
          default: ""
        example: test-project
      - name: identifier
        in: path
        description: Identifier of the policy set
        required: true
        style: simple
        explode: false
        schema:
          minLength: 1
          type: string
          description: Identifier of the policy set
          example: policyset-1
        examples:
          default:
            summary: default
            value: policyset-1
      - name: x-api-key
        in: header
        description: Harness PAT key used to perform authorization
        required: false
        style: simple
        explode: false
        schema:
          type: string
          description: Harness PAT key used to perform authorization
          example: Temporibus omnis incidunt.
        example: Libero perspiciatis quidem dolorem.
      responses:
        "204":
          description: No Content response.
        "400":
          description: "BadRequest: Bad Request response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "401":
          description: "Unauthorized: Unauthorized response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "403":
          description: "Forbidden: Forbidden response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "404":
          description: "NotFound: Not Found response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "500":
          description: "InternalServer: Internal Server Error response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "502":
          description: "BadGateway: Bad Gateway response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
      security:
      - jwt_header_Authorization:
        - core_governancePolicy_view
        - core_governancePolicy_edit
        - core_governancePolicy_delete
        - core_governancePolicySets_view
        - core_governancePolicySets_edit
        - core_governancePolicySets_delete
        - core_governancePolicySets_evaluate
        - core_governance_admin
      - api_key_header_x-api-key: []
    patch:
      tags:
      - policysets
      description: Update a policy set by identifier
      operationId: policysets#update
      parameters:
      - name: accountIdentifier
        in: query
        description: Harness account ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness account ID
          example: eBqAoNchMLKigC_qZ5EdC
          default: ""
        example: eBqAoNchMLKigC_qZ5EdC
      - name: orgIdentifier
        in: query
        description: Harness organization ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness organization ID
          example: test-org
          default: ""
        example: test-org
      - name: projectIdentifier
        in: query
        description: Harness project ID
        required: false
        allowEmptyValue: true
        style: form
        explode: true
        schema:
          type: string
          description: Harness project ID
          example: test-project
          default: ""
        example: test-project
      - name: identifier
        in: path
        description: Identifier of the policy set
        required: true
        style: simple
        explode: false
        schema:
          type: string
          description: Identifier of the policy set
          example: policyset-1
        example: policyset-1
      - name: x-api-key
        in: header
        description: Harness PAT key used to perform authorization
        required: false
        style: simple
        explode: false
        schema:
          type: string
          description: Harness PAT key used to perform authorization
          example: Qui id.
        example: Et quia quibusdam quia.
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateRequestBody2'
            example:
              action: onrun
              description: Captures critical production policies
              enabled: true
              entity_selector: all_entities_in_scope
              name: Production Policies
              policies:
              - identifier: policy-1
                severity: warning
              - identifier: policy-1
                severity: warning
              resource_groups:
              - account_id: In repudiandae et quidem possimus ipsum.
                identifier: Numquam rem quia.
                org_id: Possimus praesentium sint veniam eos.
                project_id: Sunt animi ipsa.
              - account_id: In repudiandae et quidem possimus ipsum.
                identifier: Numquam rem quia.
                org_id: Possimus praesentium sint veniam eos.
                project_id: Sunt animi ipsa.
              - account_id: In repudiandae et quidem possimus ipsum.
                identifier: Numquam rem quia.
                org_id: Possimus praesentium sint veniam eos.
                project_id: Sunt animi ipsa.
              - account_id: In repudiandae et quidem possimus ipsum.
                identifier: Numquam rem quia.
                org_id: Possimus praesentium sint veniam eos.
                project_id: Sunt animi ipsa.
              type: pipeline
        required: true
      responses:
        "204":
          description: No Content response.
        "400":
          description: "BadRequest: Bad Request response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "401":
          description: "Unauthorized: Unauthorized response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "403":
          description: "Forbidden: Forbidden response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "404":
          description: "NotFound: Not Found response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "500":
          description: "InternalServer: Internal Server Error response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "502":
          description: "BadGateway: Bad Gateway response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
      security:
      - jwt_header_Authorization:
        - core_governancePolicy_view
        - core_governancePolicy_edit
        - core_governancePolicy_delete
        - core_governancePolicySets_view
        - core_governancePolicySets_edit
        - core_governancePolicySets_delete
        - core_governancePolicySets_evaluate
        - core_governance_admin
      - api_key_header_x-api-key: []
  /api/v1/system/health:
    get:
      tags:
      - system
      description: Check service health
      operationId: system#health
      responses:
        "204":
          description: No Content response.
        "500":
          description: "InternalServer: Internal Server Error response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "502":
          description: "BadGateway: Bad Gateway response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
  /api/v1/system/version:
    get:
      tags:
      - system
      description: Check service version
      operationId: system#version
      responses:
        "200":
          description: OK response.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServiceVersion'
              example:
                commit: 96381692bf3a2bd7904769c6886e832435768b57
                version: v0.123.0
        "500":
          description: "InternalServer: Internal Server Error response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
        "502":
          description: "BadGateway: Bad Gateway response."
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
components:
  schemas:
    AggregateStatus:
      required:
      - error
      - pass
      - time
      - warning
      type: object
      properties:
        error:
          type: integer
          description: Count of evaluations that have a status of 'error'
          format: int64
          example: 2145947970278403974
        pass:
          type: integer
          description: Count of evaluations that have a status of 'pass'
          format: int64
          example: 1566636922489795804
        time:
          type: integer
          description: The Unix time of this particular aggregation
          format: int64
          example: 6444281447444376236
        warning:
          type: integer
          description: Count of evaluations that have a status of 'warning'
          format: int64
          example: 3822979756498340663
      description: Aggregate metrics for evaluations on a single day
      example:
        error: 7485873470259043471
        pass: 7518284088002695828
        time: 1258329275222359809
        warning: 7009721869929871245
    AnalyzeRequestBody:
      type: object
      properties:
        entityType:
          type: string
          description: Type of entity on which rego is written on
          example: encryptedJsonData example
        rego:
          type: string
          description: Rego Policy
          example: query example
      example:
        entityType: encryptedJsonData example
        rego: query example
    AnalyzeResponse:
      required:
      - desc
      - status
      type: object
      properties:
        desc:
          type: string
          description: Build identifier
          example: policy example
        status:
          type: string
          description: status
          example: SUCCESS
      example:
        desc: policy example
        status: SUCCESS
    CreateRequestBody:
      required:
      - account_id
      - created
      - identifier
      - name
      - org_id
      - project_id
      - rego
      - updated
      type: object
      properties:
        git_connector_ref:
          type: string
          description: The harness connector used for authenticating on the git provider
          example: "."
        git_path:
          type: string
          description: The path to the file in the git repo
          example: .harness/policy.rego
        git_repo:
          type: string
          description: The git repo the policy resides in
          example: github.com/org/repo
        identifier:
          minLength: 1
          type: string
          description: Identifier for the policy
          example: policy-1
        name:
          minLength: 1
          type: string
          description: Name of the policy
          example: Check that an approval step is present
        rego:
          minLength: 1
          type: string
          description: Rego that defines the policy policy
          example: |-
            package test
            deny["should say hello world"] {input.message != "world"}
      example:
        git_connector_ref: "."
        git_path: .harness/policy.rego
        git_repo: github.com/org/repo
        identifier: policy-1
        name: Check that an approval step is present
        rego: |-
          package test
          deny["should say hello world"] {input.message != "world"}
    CreateRequestBody2:
      required:
      - account_id
      - action
      - created
      - enabled
      - entity_selector
      - identifier
      - name
      - org_id
      - project_id
      - type
      - updated
      type: object
      properties:
        action:
          minLength: 1
          type: string
          description: Action that triggers the policy set
          example: onrun
        description:
          type: string
          description: Description of the policy set
          example: Captures critical production policies
        enabled:
          type: boolean
          description: Only enabled policy sets are evaluated when evaluating by type/action
          example: true
        identifier:
          minLength: 1
          type: string
          description: Identifier for the policy set
          example: policyset-1
        name:
          minLength: 1
          type: string
          description: Name of the policy set
          example: Production Policies
        type:
          minLength: 1
          type: string
          description: Type of input suitable for the policy set
          example: pipeline
      example:
        action: onrun
        description: Captures critical production policies
        enabled: true
        identifier: policyset-1
        name: Production Policies
        type: pipeline
    DashboardMetrics:
      required:
      - aggregates
      - policy_health
      type: object
      properties:
        aggregates:
          type: array
          description: Aggregate evaluation counts by day
          example:
          - error: 7047330649455918569
            pass: 5978409892349166329
            time: 3842596383256885522
            warning: 7820734117944797579
          - error: 7047330649455918569
            pass: 5978409892349166329
            time: 3842596383256885522
            warning: 7820734117944797579
          items:
            $ref: '#/components/schemas/AggregateStatus'
        policy_health:
          $ref: '#/components/schemas/PolicyHealth'
      example:
        aggregates:
        - error: 7047330649455918569
          pass: 5978409892349166329
          time: 3842596383256885522
          warning: 7820734117944797579
        - error: 7047330649455918569
          pass: 5978409892349166329
          time: 3842596383256885522
          warning: 7820734117944797579
        - error: 7047330649455918569
          pass: 5978409892349166329
          time: 3842596383256885522
          warning: 7820734117944797579
        - error: 7047330649455918569
          pass: 5978409892349166329
          time: 3842596383256885522
          warning: 7820734117944797579
        policy_health:
          total_evaluation_count: 6897252924146464223
          total_evaluation_entity_count:
            error: 76024433486172609
            pass: 4127438089508318555
            warning: 511376631733875378
          total_policy_count: 2312323563280819911
          total_policy_set_count: 5354236275073299085
          total_policy_set_entity_count:
            Possimus corporis doloremque nihil hic exercitationem.: 2751085338469200587
    Error:
      required:
      - fault
      - id
      - message
      - name
      - temporary
      - timeout
      type: object
      properties:
        fault:
          type: boolean
          description: Is the error a server-side fault?
          example: false
        id:
          type: string
          description: ID is a unique identifier for this particular occurrence of
            the problem.
          example: 123abc
        message:
          type: string
          description: Message is a human-readable explanation specific to this occurrence
            of the problem.
          example: parameter 'p' must be an integer
        name:
          type: string
          description: Name is the name of this class of errors.
          example: bad_request
        temporary:
          type: boolean
          description: Is the error temporary?
          example: true
        timeout:
          type: boolean
          description: Is the error a timeout?
          example: false
      example:
        id: 3F1FKVRR
        message: Value of ID must be an integer
        name: bad_request
    ErrorResultWithIdentifier:
      required:
      - fault
      - id
      - message
      - name
      - temporary
      - timeout
      type: object
      properties:
        fault:
          type: boolean
          description: Is the error a server-side fault?
          example: true
        id:
          type: string
          description: ID is a unique identifier for this particular occurrence of
            the problem.
          example: 123abc
        identifier:
          type: string
          description: the identifier associated with the error
          example: policy-1
        message:
          type: string
          description: Message is a human-readable explanation specific to this occurrence
            of the problem.
          example: parameter 'p' must be an integer
        name:
          type: string
          description: Name is the name of this class of errors.
          example: bad_request
        temporary:
          type: boolean
          description: Is the error temporary?
          example: true
        timeout:
          type: boolean
          description: Is the error a timeout?
          example: true
      example:
        fault: false
        id: 123abc
        identifier: policy-1
        message: parameter 'p' must be an integer
        name: bad_request
        temporary: false
        timeout: true
    EvaluateByTypeCheckResponseBody:
      required:
      - should_evaluate
      type: object
      properties:
        should_evaluate:
          type: boolean
          description: "Boolean value that indicates if there are policies to evaluate\
            \ for the given type, action and acc/org/proj scope."
          example: false
      example:
        should_evaluate: false
    EvaluateRequestBody:
      required:
      - input
      - rego
      type: object
      properties:
        input:
          type: string
          description: Input to evaluate
          format: binary
          example: !!binary |-
            eyJtZXNzYWdlIjogImV2ZXJ5b25lIn0=
        rego:
          minLength: 1
          type: string
          description: Arbitrary rego to be evaluated
          example: |-
            package test
            deny["should say hello world"] {input.message != "world"}
      example:
        input: "{\"message\": \"everyone\"}"
        rego: |-
          package test
          deny["should say hello world"] {input.message != "world"}
    EvaluatedPolicy:
      required:
      - deny_messages
      - error
      - output
      - policy
      - status
      type: object
      properties:
        deny_messages:
          type: array
          description: The values of any `deny` rego rules as returned by the rego
            engine
          example:
          - deployment stage 'example-stage' does not have a HarnessApproval step
          - deployment stage 'example-stage' has step 'run-script' that is forbidden
            type 'ShellScript'
          items:
            type: string
            example: Culpa quas numquam dolores repellendus distinctio omnis.
        error:
          type: string
          description: Any errors returned by the rego engine when this policy was
            evaluated
          example: "policy.rego:25: rego_parse_error: non-terminated string m == \"\
            test"
        output:
          type: string
          description: The output returned by the rego engine when this policy was
            evaluated
          format: binary
          example: !!binary |-
            ewogICAgImRlbnkiOiBbCiAgICAgICAgImRlcGxveW1lbnQgc3RhZ2UgJ2RlcGxveScgZG9lcyBu
            b3QgaGF2ZSBhIEhhcm5lc3NBcHByb3ZhbCBzdGVwIgogICAgXSwKICAgICJzdGFnZXNfd2l0aF9h
            cHByb3ZhbCI6IFtdCn0=
        policy:
          $ref: '#/components/schemas/Policy'
        status:
          type: string
          description: The overall status for this individual policy indicating whether
            it passed
          example: error
          enum:
          - error
          - warning
          - pass
      example:
        deny_messages:
        - deployment stage 'example-stage' does not have a HarnessApproval step
        - deployment stage 'example-stage' has step 'run-script' that is forbidden
          type 'ShellScript'
        error: "policy.rego:25: rego_parse_error: non-terminated string m == \"test"
        output: |-
          {
              "deny": [
                  "deployment stage 'deploy' does not have a HarnessApproval step"
              ],
              "stages_with_approval": []
          }
        policy:
          account_id: eBqAoNchMLKigC_qZ5EdC
          created: 1636669297674
          git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
          git_connector_ref: "."
          git_default_branch: main
          git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
          git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
          git_default_branch_file_url: ""
          git_default_branch_update_error:
            explanation: "File with given filepath [file.rego] already exists in Github,\
              \ thus couldn't create a new file"
            hint: "Please check if there's already a file [file.rego] in Github repository\
              \ [rego-demo] for the given filepath and branch [main]."
            message: "Please check if there's already a file [file.rego] in Github\
              \ repository [rego-demo] for the given filepath and branch [main]."
          git_default_branch_updated: 1636669297674
          git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
          git_file_url: ""
          git_path: .harness/policy.rego
          git_repo: "github.com/org/repo,omitempty"
          identifier: policy-1
          name: Pipeline Approval
          org_id: test-org
          project_id: test-project
          rego: ""
          updated: 1636669297674
        status: error
    Evaluation:
      required:
      - account_id
      - action
      - created
      - details
      - entity
      - entity_metadata
      - id
      - input
      - org_id
      - project_id
      - status
      - type
      type: object
      properties:
        account_id:
          type: string
          description: The Harness account in which the evaluation was performed
          example: XRQAjvT37acOiXx9PRaQMF
        action:
          type: string
          description: The action that triggered evaluation
          example: onrun
        created:
          type: integer
          description: The time at which the evaluation was performed in Unix time
            millseconds
          format: int64
          example: 1636370209475
        details:
          type: array
          description: The detailed results of te evaluation
          example:
          - account_id: eBqAoNchMLKigC_qZ5EdC
            action: onrun
            created: 1636669297674
            description: Captures critical production policies
            details:
            - deny_messages:
              - deployment stage 'example-stage' does not have a HarnessApproval step
              - deployment stage 'example-stage' has step 'run-script' that is forbidden
                type 'ShellScript'
              error: "policy.rego:25: rego_parse_error: non-terminated string m ==\
                \ \"test"
              output: |-
                {
                    "deny": [
                        "deployment stage 'deploy' does not have a HarnessApproval step"
                    ],
                    "stages_with_approval": []
                }
              policy:
                account_id: eBqAoNchMLKigC_qZ5EdC
                created: 1636669297674
                git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                git_connector_ref: "."
                git_default_branch: main
                git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                git_default_branch_file_url: ""
                git_default_branch_update_error:
                  explanation: "File with given filepath [file.rego] already exists\
                    \ in Github, thus couldn't create a new file"
                  hint: "Please check if there's already a file [file.rego] in Github\
                    \ repository [rego-demo] for the given filepath and branch [main]."
                  message: "Please check if there's already a file [file.rego] in\
                    \ Github repository [rego-demo] for the given filepath and branch\
                    \ [main]."
                git_default_branch_updated: 1636669297674
                git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                git_file_url: ""
                git_path: .harness/policy.rego
                git_repo: "github.com/org/repo,omitempty"
                identifier: policy-1
                name: Pipeline Approval
                org_id: test-org
                project_id: test-project
                rego: ""
                updated: 1636669297674
              status: error
            - deny_messages:
              - deployment stage 'example-stage' does not have a HarnessApproval step
              - deployment stage 'example-stage' has step 'run-script' that is forbidden
                type 'ShellScript'
              error: "policy.rego:25: rego_parse_error: non-terminated string m ==\
                \ \"test"
              output: |-
                {
                    "deny": [
                        "deployment stage 'deploy' does not have a HarnessApproval step"
                    ],
                    "stages_with_approval": []
                }
              policy:
                account_id: eBqAoNchMLKigC_qZ5EdC
                created: 1636669297674
                git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                git_connector_ref: "."
                git_default_branch: main
                git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                git_default_branch_file_url: ""
                git_default_branch_update_error:
                  explanation: "File with given filepath [file.rego] already exists\
                    \ in Github, thus couldn't create a new file"
                  hint: "Please check if there's already a file [file.rego] in Github\
                    \ repository [rego-demo] for the given filepath and branch [main]."
                  message: "Please check if there's already a file [file.rego] in\
                    \ Github repository [rego-demo] for the given filepath and branch\
                    \ [main]."
                git_default_branch_updated: 1636669297674
                git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                git_file_url: ""
                git_path: .harness/policy.rego
                git_repo: "github.com/org/repo,omitempty"
                identifier: policy-1
                name: Pipeline Approval
                org_id: test-org
                project_id: test-project
                rego: ""
                updated: 1636669297674
              status: error
            - deny_messages:
              - deployment stage 'example-stage' does not have a HarnessApproval step
              - deployment stage 'example-stage' has step 'run-script' that is forbidden
                type 'ShellScript'
              error: "policy.rego:25: rego_parse_error: non-terminated string m ==\
                \ \"test"
              output: |-
                {
                    "deny": [
                        "deployment stage 'deploy' does not have a HarnessApproval step"
                    ],
                    "stages_with_approval": []
                }
              policy:
                account_id: eBqAoNchMLKigC_qZ5EdC
                created: 1636669297674
                git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                git_connector_ref: "."
                git_default_branch: main
                git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                git_default_branch_file_url: ""
                git_default_branch_update_error:
                  explanation: "File with given filepath [file.rego] already exists\
                    \ in Github, thus couldn't create a new file"
                  hint: "Please check if there's already a file [file.rego] in Github\
                    \ repository [rego-demo] for the given filepath and branch [main]."
                  message: "Please check if there's already a file [file.rego] in\
                    \ Github repository [rego-demo] for the given filepath and branch\
                    \ [main]."
                git_default_branch_updated: 1636669297674
                git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                git_file_url: ""
                git_path: .harness/policy.rego
                git_repo: "github.com/org/repo,omitempty"
                identifier: policy-1
                name: Pipeline Approval
                org_id: test-org
                project_id: test-project
                rego: ""
                updated: 1636669297674
              status: error
            - deny_messages:
              - deployment stage 'example-stage' does not have a HarnessApproval step
              - deployment stage 'example-stage' has step 'run-script' that is forbidden
                type 'ShellScript'
              error: "policy.rego:25: rego_parse_error: non-terminated string m ==\
                \ \"test"
              output: |-
                {
                    "deny": [
                        "deployment stage 'deploy' does not have a HarnessApproval step"
                    ],
                    "stages_with_approval": []
                }
              policy:
                account_id: eBqAoNchMLKigC_qZ5EdC
                created: 1636669297674
                git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                git_connector_ref: "."
                git_default_branch: main
                git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                git_default_branch_file_url: ""
                git_default_branch_update_error:
                  explanation: "File with given filepath [file.rego] already exists\
                    \ in Github, thus couldn't create a new file"
                  hint: "Please check if there's already a file [file.rego] in Github\
                    \ repository [rego-demo] for the given filepath and branch [main]."
                  message: "Please check if there's already a file [file.rego] in\
                    \ Github repository [rego-demo] for the given filepath and branch\
                    \ [main]."
                git_default_branch_updated: 1636669297674
                git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                git_file_url: ""
                git_path: .harness/policy.rego
                git_repo: "github.com/org/repo,omitempty"
                identifier: policy-1
                name: Pipeline Approval
                org_id: test-org
                project_id: test-project
                rego: ""
                updated: 1636669297674
              status: error
            enabled: true
            identifier: policyset-1
            name: Production Policies
            org_id: test-org
            project_id: test-project
            status: error
            type: pipeline
            updated: 1636669297674
          - account_id: eBqAoNchMLKigC_qZ5EdC
            action: onrun
            created: 1636669297674
            description: Captures critical production policies
            details:
            - deny_messages:
              - deployment stage 'example-stage' does not have a HarnessApproval step
              - deployment stage 'example-stage' has step 'run-script' that is forbidden
                type 'ShellScript'
              error: "policy.rego:25: rego_parse_error: non-terminated string m ==\
                \ \"test"
              output: |-
                {
                    "deny": [
                        "deployment stage 'deploy' does not have a HarnessApproval step"
                    ],
                    "stages_with_approval": []
                }
              policy:
                account_id: eBqAoNchMLKigC_qZ5EdC
                created: 1636669297674
                git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                git_connector_ref: "."
                git_default_branch: main
                git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                git_default_branch_file_url: ""
                git_default_branch_update_error:
                  explanation: "File with given filepath [file.rego] already exists\
                    \ in Github, thus couldn't create a new file"
                  hint: "Please check if there's already a file [file.rego] in Github\
                    \ repository [rego-demo] for the given filepath and branch [main]."
                  message: "Please check if there's already a file [file.rego] in\
                    \ Github repository [rego-demo] for the given filepath and branch\
                    \ [main]."
                git_default_branch_updated: 1636669297674
                git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                git_file_url: ""
                git_path: .harness/policy.rego
                git_repo: "github.com/org/repo,omitempty"
                identifier: policy-1
                name: Pipeline Approval
                org_id: test-org
                project_id: test-project
                rego: ""
                updated: 1636669297674
              status: error
            - deny_messages:
              - deployment stage 'example-stage' does not have a HarnessApproval step
              - deployment stage 'example-stage' has step 'run-script' that is forbidden
                type 'ShellScript'
              error: "policy.rego:25: rego_parse_error: non-terminated string m ==\
                \ \"test"
              output: |-
                {
                    "deny": [
                        "deployment stage 'deploy' does not have a HarnessApproval step"
                    ],
                    "stages_with_approval": []
                }
              policy:
                account_id: eBqAoNchMLKigC_qZ5EdC
                created: 1636669297674
                git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                git_connector_ref: "."
                git_default_branch: main
                git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                git_default_branch_file_url: ""
                git_default_branch_update_error:
                  explanation: "File with given filepath [file.rego] already exists\
                    \ in Github, thus couldn't create a new file"
                  hint: "Please check if there's already a file [file.rego] in Github\
                    \ repository [rego-demo] for the given filepath and branch [main]."
                  message: "Please check if there's already a file [file.rego] in\
                    \ Github repository [rego-demo] for the given filepath and branch\
                    \ [main]."
                git_default_branch_updated: 1636669297674
                git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                git_file_url: ""
                git_path: .harness/policy.rego
                git_repo: "github.com/org/repo,omitempty"
                identifier: policy-1
                name: Pipeline Approval
                org_id: test-org
                project_id: test-project
                rego: ""
                updated: 1636669297674
              status: error
            - deny_messages:
              - deployment stage 'example-stage' does not have a HarnessApproval step
              - deployment stage 'example-stage' has step 'run-script' that is forbidden
                type 'ShellScript'
              error: "policy.rego:25: rego_parse_error: non-terminated string m ==\
                \ \"test"
              output: |-
                {
                    "deny": [
                        "deployment stage 'deploy' does not have a HarnessApproval step"
                    ],
                    "stages_with_approval": []
                }
              policy:
                account_id: eBqAoNchMLKigC_qZ5EdC
                created: 1636669297674
                git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                git_connector_ref: "."
                git_default_branch: main
                git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                git_default_branch_file_url: ""
                git_default_branch_update_error:
                  explanation: "File with given filepath [file.rego] already exists\
                    \ in Github, thus couldn't create a new file"
                  hint: "Please check if there's already a file [file.rego] in Github\
                    \ repository [rego-demo] for the given filepath and branch [main]."
                  message: "Please check if there's already a file [file.rego] in\
                    \ Github repository [rego-demo] for the given filepath and branch\
                    \ [main]."
                git_default_branch_updated: 1636669297674
                git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                git_file_url: ""
                git_path: .harness/policy.rego
                git_repo: "github.com/org/repo,omitempty"
                identifier: policy-1
                name: Pipeline Approval
                org_id: test-org
                project_id: test-project
                rego: ""
                updated: 1636669297674
              status: error
            - deny_messages:
              - deployment stage 'example-stage' does not have a HarnessApproval step
              - deployment stage 'example-stage' has step 'run-script' that is forbidden
                type 'ShellScript'
              error: "policy.rego:25: rego_parse_error: non-terminated string m ==\
                \ \"test"
              output: |-
                {
                    "deny": [
                        "deployment stage 'deploy' does not have a HarnessApproval step"
                    ],
                    "stages_with_approval": []
                }
              policy:
                account_id: eBqAoNchMLKigC_qZ5EdC
                created: 1636669297674
                git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                git_connector_ref: "."
                git_default_branch: main
                git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                git_default_branch_file_url: ""
                git_default_branch_update_error:
                  explanation: "File with given filepath [file.rego] already exists\
                    \ in Github, thus couldn't create a new file"
                  hint: "Please check if there's already a file [file.rego] in Github\
                    \ repository [rego-demo] for the given filepath and branch [main]."
                  message: "Please check if there's already a file [file.rego] in\
                    \ Github repository [rego-demo] for the given filepath and branch\
                    \ [main]."
                git_default_branch_updated: 1636669297674
                git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
                git_file_url: ""
                git_path: .harness/policy.rego
                git_repo: "github.com/org/repo,omitempty"
                identifier: policy-1
                name: Pipeline Approval
                org_id: test-org
                project_id: test-project
                rego: ""
                updated: 1636669297674
              status: error
            enabled: true
            identifier: policyset-1
            name: Production Policies
            org_id: test-org
            project_id: test-project
            status: error
            type: pipeline
            updated: 1636669297674
          items:
            $ref: '#/components/schemas/EvaluationDetail'
        entity:
          type: string
          description: An arbtrary user-supplied string that globally identifies the
            entity under evaluation
          example: 7bbca5d4-e9f2-4955-9b2a-019ec4d3645e
        entity_metadata:
          type: string
          description: Additional arbtrary user-supplied metadta about the entity
            under evaluation
          example: 7bbca5d4-e9f2-4955-9b2a-019ec4d3645e
        id:
          type: integer
          description: The ID of this evaluation
          format: int64
          example: 123
        input:
          type: string
          description: The input provided at evaluation time
          format: binary
          example: !!binary ""
        org_id:
          type: string
          description: The Harness organisation in which the evaluation was performed
          example: test-org
        project_id:
          type: string
          description: The Harness project in which the evaluation was performed
          example: test-project
        status:
          type: string
          description: The overall status of the evaluation indicating whether it
            passed
          example: error
          enum:
          - error
          - warning
          - pass
        type:
          type: string
          description: The types of the entity under evaluation
          example: "pipeline,service"
      example:
        account_id: XRQAjvT37acOiXx9PRaQMF
        action: onrun
        created: 1636370209475
        details:
        - account_id: eBqAoNchMLKigC_qZ5EdC
          action: onrun
          created: 1636669297674
          description: Captures critical production policies
          details:
          - deny_messages:
            - deployment stage 'example-stage' does not have a HarnessApproval step
            - deployment stage 'example-stage' has step 'run-script' that is forbidden
              type 'ShellScript'
            error: "policy.rego:25: rego_parse_error: non-terminated string m == \"\
              test"
            output: |-
              {
                  "deny": [
                      "deployment stage 'deploy' does not have a HarnessApproval step"
                  ],
                  "stages_with_approval": []
              }
            policy:
              account_id: eBqAoNchMLKigC_qZ5EdC
              created: 1636669297674
              git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_connector_ref: "."
              git_default_branch: main
              git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_default_branch_file_url: ""
              git_default_branch_update_error:
                explanation: "File with given filepath [file.rego] already exists\
                  \ in Github, thus couldn't create a new file"
                hint: "Please check if there's already a file [file.rego] in Github\
                  \ repository [rego-demo] for the given filepath and branch [main]."
                message: "Please check if there's already a file [file.rego] in Github\
                  \ repository [rego-demo] for the given filepath and branch [main]."
              git_default_branch_updated: 1636669297674
              git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_file_url: ""
              git_path: .harness/policy.rego
              git_repo: "github.com/org/repo,omitempty"
              identifier: policy-1
              name: Pipeline Approval
              org_id: test-org
              project_id: test-project
              rego: ""
              updated: 1636669297674
            status: error
          - deny_messages:
            - deployment stage 'example-stage' does not have a HarnessApproval step
            - deployment stage 'example-stage' has step 'run-script' that is forbidden
              type 'ShellScript'
            error: "policy.rego:25: rego_parse_error: non-terminated string m == \"\
              test"
            output: |-
              {
                  "deny": [
                      "deployment stage 'deploy' does not have a HarnessApproval step"
                  ],
                  "stages_with_approval": []
              }
            policy:
              account_id: eBqAoNchMLKigC_qZ5EdC
              created: 1636669297674
              git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_connector_ref: "."
              git_default_branch: main
              git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_default_branch_file_url: ""
              git_default_branch_update_error:
                explanation: "File with given filepath [file.rego] already exists\
                  \ in Github, thus couldn't create a new file"
                hint: "Please check if there's already a file [file.rego] in Github\
                  \ repository [rego-demo] for the given filepath and branch [main]."
                message: "Please check if there's already a file [file.rego] in Github\
                  \ repository [rego-demo] for the given filepath and branch [main]."
              git_default_branch_updated: 1636669297674
              git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_file_url: ""
              git_path: .harness/policy.rego
              git_repo: "github.com/org/repo,omitempty"
              identifier: policy-1
              name: Pipeline Approval
              org_id: test-org
              project_id: test-project
              rego: ""
              updated: 1636669297674
            status: error
          - deny_messages:
            - deployment stage 'example-stage' does not have a HarnessApproval step
            - deployment stage 'example-stage' has step 'run-script' that is forbidden
              type 'ShellScript'
            error: "policy.rego:25: rego_parse_error: non-terminated string m == \"\
              test"
            output: |-
              {
                  "deny": [
                      "deployment stage 'deploy' does not have a HarnessApproval step"
                  ],
                  "stages_with_approval": []
              }
            policy:
              account_id: eBqAoNchMLKigC_qZ5EdC
              created: 1636669297674
              git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_connector_ref: "."
              git_default_branch: main
              git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_default_branch_file_url: ""
              git_default_branch_update_error:
                explanation: "File with given filepath [file.rego] already exists\
                  \ in Github, thus couldn't create a new file"
                hint: "Please check if there's already a file [file.rego] in Github\
                  \ repository [rego-demo] for the given filepath and branch [main]."
                message: "Please check if there's already a file [file.rego] in Github\
                  \ repository [rego-demo] for the given filepath and branch [main]."
              git_default_branch_updated: 1636669297674
              git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_file_url: ""
              git_path: .harness/policy.rego
              git_repo: "github.com/org/repo,omitempty"
              identifier: policy-1
              name: Pipeline Approval
              org_id: test-org
              project_id: test-project
              rego: ""
              updated: 1636669297674
            status: error
          - deny_messages:
            - deployment stage 'example-stage' does not have a HarnessApproval step
            - deployment stage 'example-stage' has step 'run-script' that is forbidden
              type 'ShellScript'
            error: "policy.rego:25: rego_parse_error: non-terminated string m == \"\
              test"
            output: |-
              {
                  "deny": [
                      "deployment stage 'deploy' does not have a HarnessApproval step"
                  ],
                  "stages_with_approval": []
              }
            policy:
              account_id: eBqAoNchMLKigC_qZ5EdC
              created: 1636669297674
              git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_connector_ref: "."
              git_default_branch: main
              git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_default_branch_file_url: ""
              git_default_branch_update_error:
                explanation: "File with given filepath [file.rego] already exists\
                  \ in Github, thus couldn't create a new file"
                hint: "Please check if there's already a file [file.rego] in Github\
                  \ repository [rego-demo] for the given filepath and branch [main]."
                message: "Please check if there's already a file [file.rego] in Github\
                  \ repository [rego-demo] for the given filepath and branch [main]."
              git_default_branch_updated: 1636669297674
              git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_file_url: ""
              git_path: .harness/policy.rego
              git_repo: "github.com/org/repo,omitempty"
              identifier: policy-1
              name: Pipeline Approval
              org_id: test-org
              project_id: test-project
              rego: ""
              updated: 1636669297674
            status: error
          enabled: true
          identifier: policyset-1
          name: Production Policies
          org_id: test-org
          project_id: test-project
          status: error
          type: pipeline
          updated: 1636669297674
        - account_id: eBqAoNchMLKigC_qZ5EdC
          action: onrun
          created: 1636669297674
          description: Captures critical production policies
          details:
          - deny_messages:
            - deployment stage 'example-stage' does not have a HarnessApproval step
            - deployment stage 'example-stage' has step 'run-script' that is forbidden
              type 'ShellScript'
            error: "policy.rego:25: rego_parse_error: non-terminated string m == \"\
              test"
            output: |-
              {
                  "deny": [
                      "deployment stage 'deploy' does not have a HarnessApproval step"
                  ],
                  "stages_with_approval": []
              }
            policy:
              account_id: eBqAoNchMLKigC_qZ5EdC
              created: 1636669297674
              git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_connector_ref: "."
              git_default_branch: main
              git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_default_branch_file_url: ""
              git_default_branch_update_error:
                explanation: "File with given filepath [file.rego] already exists\
                  \ in Github, thus couldn't create a new file"
                hint: "Please check if there's already a file [file.rego] in Github\
                  \ repository [rego-demo] for the given filepath and branch [main]."
                message: "Please check if there's already a file [file.rego] in Github\
                  \ repository [rego-demo] for the given filepath and branch [main]."
              git_default_branch_updated: 1636669297674
              git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_file_url: ""
              git_path: .harness/policy.rego
              git_repo: "github.com/org/repo,omitempty"
              identifier: policy-1
              name: Pipeline Approval
              org_id: test-org
              project_id: test-project
              rego: ""
              updated: 1636669297674
            status: error
          - deny_messages:
            - deployment stage 'example-stage' does not have a HarnessApproval step
            - deployment stage 'example-stage' has step 'run-script' that is forbidden
              type 'ShellScript'
            error: "policy.rego:25: rego_parse_error: non-terminated string m == \"\
              test"
            output: |-
              {
                  "deny": [
                      "deployment stage 'deploy' does not have a HarnessApproval step"
                  ],
                  "stages_with_approval": []
              }
            policy:
              account_id: eBqAoNchMLKigC_qZ5EdC
              created: 1636669297674
              git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_connector_ref: "."
              git_default_branch: main
              git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_default_branch_file_url: ""
              git_default_branch_update_error:
                explanation: "File with given filepath [file.rego] already exists\
                  \ in Github, thus couldn't create a new file"
                hint: "Please check if there's already a file [file.rego] in Github\
                  \ repository [rego-demo] for the given filepath and branch [main]."
                message: "Please check if there's already a file [file.rego] in Github\
                  \ repository [rego-demo] for the given filepath and branch [main]."
              git_default_branch_updated: 1636669297674
              git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_file_url: ""
              git_path: .harness/policy.rego
              git_repo: "github.com/org/repo,omitempty"
              identifier: policy-1
              name: Pipeline Approval
              org_id: test-org
              project_id: test-project
              rego: ""
              updated: 1636669297674
            status: error
          - deny_messages:
            - deployment stage 'example-stage' does not have a HarnessApproval step
            - deployment stage 'example-stage' has step 'run-script' that is forbidden
              type 'ShellScript'
            error: "policy.rego:25: rego_parse_error: non-terminated string m == \"\
              test"
            output: |-
              {
                  "deny": [
                      "deployment stage 'deploy' does not have a HarnessApproval step"
                  ],
                  "stages_with_approval": []
              }
            policy:
              account_id: eBqAoNchMLKigC_qZ5EdC
              created: 1636669297674
              git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_connector_ref: "."
              git_default_branch: main
              git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_default_branch_file_url: ""
              git_default_branch_update_error:
                explanation: "File with given filepath [file.rego] already exists\
                  \ in Github, thus couldn't create a new file"
                hint: "Please check if there's already a file [file.rego] in Github\
                  \ repository [rego-demo] for the given filepath and branch [main]."
                message: "Please check if there's already a file [file.rego] in Github\
                  \ repository [rego-demo] for the given filepath and branch [main]."
              git_default_branch_updated: 1636669297674
              git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_file_url: ""
              git_path: .harness/policy.rego
              git_repo: "github.com/org/repo,omitempty"
              identifier: policy-1
              name: Pipeline Approval
              org_id: test-org
              project_id: test-project
              rego: ""
              updated: 1636669297674
            status: error
          - deny_messages:
            - deployment stage 'example-stage' does not have a HarnessApproval step
            - deployment stage 'example-stage' has step 'run-script' that is forbidden
              type 'ShellScript'
            error: "policy.rego:25: rego_parse_error: non-terminated string m == \"\
              test"
            output: |-
              {
                  "deny": [
                      "deployment stage 'deploy' does not have a HarnessApproval step"
                  ],
                  "stages_with_approval": []
              }
            policy:
              account_id: eBqAoNchMLKigC_qZ5EdC
              created: 1636669297674
              git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_connector_ref: "."
              git_default_branch: main
              git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_default_branch_file_url: ""
              git_default_branch_update_error:
                explanation: "File with given filepath [file.rego] already exists\
                  \ in Github, thus couldn't create a new file"
                hint: "Please check if there's already a file [file.rego] in Github\
                  \ repository [rego-demo] for the given filepath and branch [main]."
                message: "Please check if there's already a file [file.rego] in Github\
                  \ repository [rego-demo] for the given filepath and branch [main]."
              git_default_branch_updated: 1636669297674
              git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_file_url: ""
              git_path: .harness/policy.rego
              git_repo: "github.com/org/repo,omitempty"
              identifier: policy-1
              name: Pipeline Approval
              org_id: test-org
              project_id: test-project
              rego: ""
              updated: 1636669297674
            status: error
          enabled: true
          identifier: policyset-1
          name: Production Policies
          org_id: test-org
          project_id: test-project
          status: error
          type: pipeline
          updated: 1636669297674
        - account_id: eBqAoNchMLKigC_qZ5EdC
          action: onrun
          created: 1636669297674
          description: Captures critical production policies
          details:
          - deny_messages:
            - deployment stage 'example-stage' does not have a HarnessApproval step
            - deployment stage 'example-stage' has step 'run-script' that is forbidden
              type 'ShellScript'
            error: "policy.rego:25: rego_parse_error: non-terminated string m == \"\
              test"
            output: |-
              {
                  "deny": [
                      "deployment stage 'deploy' does not have a HarnessApproval step"
                  ],
                  "stages_with_approval": []
              }
            policy:
              account_id: eBqAoNchMLKigC_qZ5EdC
              created: 1636669297674
              git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_connector_ref: "."
              git_default_branch: main
              git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_default_branch_file_url: ""
              git_default_branch_update_error:
                explanation: "File with given filepath [file.rego] already exists\
                  \ in Github, thus couldn't create a new file"
                hint: "Please check if there's already a file [file.rego] in Github\
                  \ repository [rego-demo] for the given filepath and branch [main]."
                message: "Please check if there's already a file [file.rego] in Github\
                  \ repository [rego-demo] for the given filepath and branch [main]."
              git_default_branch_updated: 1636669297674
              git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_file_url: ""
              git_path: .harness/policy.rego
              git_repo: "github.com/org/repo,omitempty"
              identifier: policy-1
              name: Pipeline Approval
              org_id: test-org
              project_id: test-project
              rego: ""
              updated: 1636669297674
            status: error
          - deny_messages:
            - deployment stage 'example-stage' does not have a HarnessApproval step
            - deployment stage 'example-stage' has step 'run-script' that is forbidden
              type 'ShellScript'
            error: "policy.rego:25: rego_parse_error: non-terminated string m == \"\
              test"
            output: |-
              {
                  "deny": [
                      "deployment stage 'deploy' does not have a HarnessApproval step"
                  ],
                  "stages_with_approval": []
              }
            policy:
              account_id: eBqAoNchMLKigC_qZ5EdC
              created: 1636669297674
              git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_connector_ref: "."
              git_default_branch: main
              git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_default_branch_file_url: ""
              git_default_branch_update_error:
                explanation: "File with given filepath [file.rego] already exists\
                  \ in Github, thus couldn't create a new file"
                hint: "Please check if there's already a file [file.rego] in Github\
                  \ repository [rego-demo] for the given filepath and branch [main]."
                message: "Please check if there's already a file [file.rego] in Github\
                  \ repository [rego-demo] for the given filepath and branch [main]."
              git_default_branch_updated: 1636669297674
              git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_file_url: ""
              git_path: .harness/policy.rego
              git_repo: "github.com/org/repo,omitempty"
              identifier: policy-1
              name: Pipeline Approval
              org_id: test-org
              project_id: test-project
              rego: ""
              updated: 1636669297674
            status: error
          - deny_messages:
            - deployment stage 'example-stage' does not have a HarnessApproval step
            - deployment stage 'example-stage' has step 'run-script' that is forbidden
              type 'ShellScript'
            error: "policy.rego:25: rego_parse_error: non-terminated string m == \"\
              test"
            output: |-
              {
                  "deny": [
                      "deployment stage 'deploy' does not have a HarnessApproval step"
                  ],
                  "stages_with_approval": []
              }
            policy:
              account_id: eBqAoNchMLKigC_qZ5EdC
              created: 1636669297674
              git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_connector_ref: "."
              git_default_branch: main
              git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_default_branch_file_url: ""
              git_default_branch_update_error:
                explanation: "File with given filepath [file.rego] already exists\
                  \ in Github, thus couldn't create a new file"
                hint: "Please check if there's already a file [file.rego] in Github\
                  \ repository [rego-demo] for the given filepath and branch [main]."
                message: "Please check if there's already a file [file.rego] in Github\
                  \ repository [rego-demo] for the given filepath and branch [main]."
              git_default_branch_updated: 1636669297674
              git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_file_url: ""
              git_path: .harness/policy.rego
              git_repo: "github.com/org/repo,omitempty"
              identifier: policy-1
              name: Pipeline Approval
              org_id: test-org
              project_id: test-project
              rego: ""
              updated: 1636669297674
            status: error
          - deny_messages:
            - deployment stage 'example-stage' does not have a HarnessApproval step
            - deployment stage 'example-stage' has step 'run-script' that is forbidden
              type 'ShellScript'
            error: "policy.rego:25: rego_parse_error: non-terminated string m == \"\
              test"
            output: |-
              {
                  "deny": [
                      "deployment stage 'deploy' does not have a HarnessApproval step"
                  ],
                  "stages_with_approval": []
              }
            policy:
              account_id: eBqAoNchMLKigC_qZ5EdC
              created: 1636669297674
              git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_connector_ref: "."
              git_default_branch: main
              git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_default_branch_file_url: ""
              git_default_branch_update_error:
                explanation: "File with given filepath [file.rego] already exists\
                  \ in Github, thus couldn't create a new file"
                hint: "Please check if there's already a file [file.rego] in Github\
                  \ repository [rego-demo] for the given filepath and branch [main]."
                message: "Please check if there's already a file [file.rego] in Github\
                  \ repository [rego-demo] for the given filepath and branch [main]."
              git_default_branch_updated: 1636669297674
              git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_file_url: ""
              git_path: .harness/policy.rego
              git_repo: "github.com/org/repo,omitempty"
              identifier: policy-1
              name: Pipeline Approval
              org_id: test-org
              project_id: test-project
              rego: ""
              updated: 1636669297674
            status: error
          enabled: true
          identifier: policyset-1
          name: Production Policies
          org_id: test-org
          project_id: test-project
          status: error
          type: pipeline
          updated: 1636669297674
        entity: 7bbca5d4-e9f2-4955-9b2a-019ec4d3645e
        entity_metadata: 7bbca5d4-e9f2-4955-9b2a-019ec4d3645e
        id: 123
        input: ""
        org_id: test-org
        project_id: test-project
        status: error
        type: "pipeline,service"
    EvaluationCounts:
      required:
      - error
      - pass
      - warning
      type: object
      properties:
        error:
          type: integer
          description: Count of evaluations that have a status of 'error'
          format: int64
          example: 2877065535170142137
        pass:
          type: integer
          description: Count of evaluations that have a status of 'pass'
          format: int64
          example: 6448843135629816731
        warning:
          type: integer
          description: Count of evaluations that have a status of 'warning'
          format: int64
          example: 5349812220259163158
      description: Evaluation counts by status
      example:
        error: 3723090062830688588
        pass: 6135952462759855154
        warning: 9199932466817366069
    EvaluationDetail:
      required:
      - account_id
      - action
      - created
      - details
      - enabled
      - entity_selector
      - identifier
      - name
      - org_id
      - project_id
      - status
      - type
      - updated
      type: object
      properties:
        account_id:
          type: string
          description: Harness account ID associated with this policy set
          example: eBqAoNchMLKigC_qZ5EdC
          default: ""
        action:
          minLength: 1
          type: string
          description: Action that triggers the policy set
          example: onrun
        created:
          type: integer
          description: Time the policy set was created
          format: int64
          example: 1636669297674
        description:
          type: string
          description: Description of the policy set
          example: Captures critical production policies
        details:
          type: array
          example:
          - deny_messages:
            - deployment stage 'example-stage' does not have a HarnessApproval step
            - deployment stage 'example-stage' has step 'run-script' that is forbidden
              type 'ShellScript'
            error: "policy.rego:25: rego_parse_error: non-terminated string m == \"\
              test"
            output: |-
              {
                  "deny": [
                      "deployment stage 'deploy' does not have a HarnessApproval step"
                  ],
                  "stages_with_approval": []
              }
            policy:
              account_id: eBqAoNchMLKigC_qZ5EdC
              created: 1636669297674
              git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_connector_ref: "."
              git_default_branch: main
              git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_default_branch_file_url: ""
              git_default_branch_update_error:
                explanation: "File with given filepath [file.rego] already exists\
                  \ in Github, thus couldn't create a new file"
                hint: "Please check if there's already a file [file.rego] in Github\
                  \ repository [rego-demo] for the given filepath and branch [main]."
                message: "Please check if there's already a file [file.rego] in Github\
                  \ repository [rego-demo] for the given filepath and branch [main]."
              git_default_branch_updated: 1636669297674
              git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_file_url: ""
              git_path: .harness/policy.rego
              git_repo: "github.com/org/repo,omitempty"
              identifier: policy-1
              name: Pipeline Approval
              org_id: test-org
              project_id: test-project
              rego: ""
              updated: 1636669297674
            status: error
          - deny_messages:
            - deployment stage 'example-stage' does not have a HarnessApproval step
            - deployment stage 'example-stage' has step 'run-script' that is forbidden
              type 'ShellScript'
            error: "policy.rego:25: rego_parse_error: non-terminated string m == \"\
              test"
            output: |-
              {
                  "deny": [
                      "deployment stage 'deploy' does not have a HarnessApproval step"
                  ],
                  "stages_with_approval": []
              }
            policy:
              account_id: eBqAoNchMLKigC_qZ5EdC
              created: 1636669297674
              git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_connector_ref: "."
              git_default_branch: main
              git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_default_branch_file_url: ""
              git_default_branch_update_error:
                explanation: "File with given filepath [file.rego] already exists\
                  \ in Github, thus couldn't create a new file"
                hint: "Please check if there's already a file [file.rego] in Github\
                  \ repository [rego-demo] for the given filepath and branch [main]."
                message: "Please check if there's already a file [file.rego] in Github\
                  \ repository [rego-demo] for the given filepath and branch [main]."
              git_default_branch_updated: 1636669297674
              git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_file_url: ""
              git_path: .harness/policy.rego
              git_repo: "github.com/org/repo,omitempty"
              identifier: policy-1
              name: Pipeline Approval
              org_id: test-org
              project_id: test-project
              rego: ""
              updated: 1636669297674
            status: error
          - deny_messages:
            - deployment stage 'example-stage' does not have a HarnessApproval step
            - deployment stage 'example-stage' has step 'run-script' that is forbidden
              type 'ShellScript'
            error: "policy.rego:25: rego_parse_error: non-terminated string m == \"\
              test"
            output: |-
              {
                  "deny": [
                      "deployment stage 'deploy' does not have a HarnessApproval step"
                  ],
                  "stages_with_approval": []
              }
            policy:
              account_id: eBqAoNchMLKigC_qZ5EdC
              created: 1636669297674
              git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_connector_ref: "."
              git_default_branch: main
              git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_default_branch_file_url: ""
              git_default_branch_update_error:
                explanation: "File with given filepath [file.rego] already exists\
                  \ in Github, thus couldn't create a new file"
                hint: "Please check if there's already a file [file.rego] in Github\
                  \ repository [rego-demo] for the given filepath and branch [main]."
                message: "Please check if there's already a file [file.rego] in Github\
                  \ repository [rego-demo] for the given filepath and branch [main]."
              git_default_branch_updated: 1636669297674
              git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
              git_file_url: ""
              git_path: .harness/policy.rego
              git_repo: "github.com/org/repo,omitempty"
              identifier: policy-1
              name: Pipeline Approval
              org_id: test-org
              project_id: test-project
              rego: ""
              updated: 1636669297674
            status: error
          items:
            $ref: '#/components/schemas/EvaluatedPolicy'
        enabled:
          type: boolean
          description: Only enabled policy sets are evaluated when evaluating by type/action
          example: true
        identifier:
          minLength: 1
          type: string
          description: Identifier of the policy set
          example: policyset-1
        name:
          minLength: 1
          type: string
          description: Name of the policy set
          example: Production Policies
        org_id:
          type: string
          description: Harness organization ID associated with this policy set
          example: test-org
          default: ""
        project_id:
          type: string
          description: Harness project ID associated with this policy set
          example: test-project
          default: ""
        status:
          type: string
          description: The overall status for this policy set indicating whether it
            passed
          example: error
          enum:
          - error
          - warning
          - pass
        type:
          minLength: 1
          type: string
          description: Type of input suitable for the policy set
          example: pipeline
        updated:
          type: integer
          description: Time the policy set was last updated
          format: int64
          example: 1636669297674
      example:
        account_id: eBqAoNchMLKigC_qZ5EdC
        action: onrun
        created: 1636669297674
        description: Captures critical production policies
        details:
        - deny_messages:
          - deployment stage 'example-stage' does not have a HarnessApproval step
          - deployment stage 'example-stage' has step 'run-script' that is forbidden
            type 'ShellScript'
          error: "policy.rego:25: rego_parse_error: non-terminated string m == \"\
            test"
          output: |-
            {
                "deny": [
                    "deployment stage 'deploy' does not have a HarnessApproval step"
                ],
                "stages_with_approval": []
            }
          policy:
            account_id: eBqAoNchMLKigC_qZ5EdC
            created: 1636669297674
            git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
            git_connector_ref: "."
            git_default_branch: main
            git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
            git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
            git_default_branch_file_url: ""
            git_default_branch_update_error:
              explanation: "File with given filepath [file.rego] already exists in\
                \ Github, thus couldn't create a new file"
              hint: "Please check if there's already a file [file.rego] in Github\
                \ repository [rego-demo] for the given filepath and branch [main]."
              message: "Please check if there's already a file [file.rego] in Github\
                \ repository [rego-demo] for the given filepath and branch [main]."
            git_default_branch_updated: 1636669297674
            git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
            git_file_url: ""
            git_path: .harness/policy.rego
            git_repo: "github.com/org/repo,omitempty"
            identifier: policy-1
            name: Pipeline Approval
            org_id: test-org
            project_id: test-project
            rego: ""
            updated: 1636669297674
          status: error
        - deny_messages:
          - deployment stage 'example-stage' does not have a HarnessApproval step
          - deployment stage 'example-stage' has step 'run-script' that is forbidden
            type 'ShellScript'
          error: "policy.rego:25: rego_parse_error: non-terminated string m == \"\
            test"
          output: |-
            {
                "deny": [
                    "deployment stage 'deploy' does not have a HarnessApproval step"
                ],
                "stages_with_approval": []
            }
          policy:
            account_id: eBqAoNchMLKigC_qZ5EdC
            created: 1636669297674
            git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
            git_connector_ref: "."
            git_default_branch: main
            git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
            git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
            git_default_branch_file_url: ""
            git_default_branch_update_error:
              explanation: "File with given filepath [file.rego] already exists in\
                \ Github, thus couldn't create a new file"
              hint: "Please check if there's already a file [file.rego] in Github\
                \ repository [rego-demo] for the given filepath and branch [main]."
              message: "Please check if there's already a file [file.rego] in Github\
                \ repository [rego-demo] for the given filepath and branch [main]."
            git_default_branch_updated: 1636669297674
            git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
            git_file_url: ""
            git_path: .harness/policy.rego
            git_repo: "github.com/org/repo,omitempty"
            identifier: policy-1
            name: Pipeline Approval
            org_id: test-org
            project_id: test-project
            rego: ""
            updated: 1636669297674
          status: error
        enabled: true
        identifier: policyset-1
        name: Production Policies
        org_id: test-org
        project_id: test-project
        status: error
        type: pipeline
        updated: 1636669297674
    GenerateRequestBody:
      type: object
      properties:
        policyData:
          type: string
          description: policySample Data
          example: encryptedJsonData example
        query:
          type: string
          description: Text query
          example: query example
      example:
        policyData: encryptedJsonData example
        query: query example
    GitErrorResult:
      required:
      - explanation
      - hint
      - message
      type: object
      properties:
        explanation:
          type: string
          description: the explanation of the error
          example: "File with given filepath [file.rego] already exists in Github,\
            \ thus couldn't create a new file"
        hint:
          type: string
          description: the hint on how to resolve the error
          example: "Please check if there's already a file [file.rego] in Github repository\
            \ [rego-demo] for the given filepath and branch [main]."
        message:
          type: string
          description: the message is a human-readable explanation specific to this
            occurrence of the problem
          example: "Please check if there's already a file [file.rego] in Github repository\
            \ [rego-demo] for the given filepath and branch [main]."
      example:
        explanation: "File with given filepath [file.rego] already exists in Github,\
          \ thus couldn't create a new file"
        hint: "Please check if there's already a file [file.rego] in Github repository\
          \ [rego-demo] for the given filepath and branch [main]."
        message: "Please check if there's already a file [file.rego] in Github repository\
          \ [rego-demo] for the given filepath and branch [main]."
    LinkedPolicy:
      required:
      - account_id
      - created
      - identifier
      - name
      - org_id
      - project_id
      - rego
      - severity
      - updated
      type: object
      properties:
        account_id:
          type: string
          description: Harness account ID associated with this policy
          example: eBqAoNchMLKigC_qZ5EdC
          default: ""
        created:
          type: integer
          description: Time the policy was created
          format: int64
          example: 1636669297674
        identifier:
          minLength: 1
          type: string
          description: identifier of the policy
          example: policy-1
        name:
          minLength: 1
          type: string
          description: Name of the policy
          example: Pipeline Approval
        org_id:
          type: string
          description: Harness organization ID associated with this policy
          example: test-org
          default: ""
        project_id:
          type: string
          description: Harness project ID associated with this policy
          example: test-project
          default: ""
        rego:
          minLength: 1
          type: string
          description: Rego that defines the policy
          example: ""
        severity:
          type: string
          description: The severity of this policy in this context
          example: warning
          enum:
          - warning
          - error
        updated:
          type: integer
          description: Time the policy was last updated
          format: int64
          example: 1636669297674
      example:
        account_id: eBqAoNchMLKigC_qZ5EdC
        created: 1636669297674
        identifier: policy-1
        name: Pipeline Approval
        org_id: test-org
        project_id: test-project
        rego: ""
        severity: warning
        updated: 1636669297674
    Linkedpolicyidentifier:
      required:
      - identifier
      - severity
      type: object
      properties:
        identifier:
          minLength: 1
          type: string
          description: identifier of the policy with account. or org. prefix if needed
          example: policy-1
        severity:
          type: string
          description: The severity of this policy in this context
          example: warning
          enum:
          - warning
          - error
      example:
        identifier: policy-1
        severity: warning
    Policy:
      required:
      - account_id
      - created
      - identifier
      - name
      - org_id
      - project_id
      - rego
      - updated
      type: object
      properties:
        account_id:
          type: string
          description: Harness account ID associated with this policy
          example: eBqAoNchMLKigC_qZ5EdC
          default: ""
        created:
          type: integer
          description: Time the policy was created
          format: int64
          example: 1636669297674
        git_commit_sha:
          type: string
          description: The commit sha of the commit that last effected the file
          example: 1369b45c20fc685113adcfd1a08a914180ff3c0d
        git_connector_ref:
          type: string
          description: The harness connector used for authenticating on the git provider
          example: "."
        git_default_branch:
          type: string
          description: "The default branch, the service pulls in changes from from\
            \ this branch for policy evaluation"
          example: main
        git_default_branch_commit_sha:
          type: string
          description: The commit sha of the commit that last effected the file in
            the default branch
          example: 1369b45c20fc685113adcfd1a08a914180ff3c0d
        git_default_branch_file_id:
          type: string
          description: "The file id of the file in the default branch, may be empty\
            \ for bitbucket files"
          example: 1369b45c20fc685113adcfd1a08a914180ff3c0d
        git_default_branch_file_url:
          type: string
          description: The url of the file in the default branch
          example: ""
        git_default_branch_update_error:
          $ref: '#/components/schemas/GitErrorResult'
        git_default_branch_updated:
          type: integer
          description: The last time the service successfully pulled in changes from
            the default branch
          format: int64
          example: 1636669297674
        git_file_id:
          type: string
          description: "The file id of the file, may be empty for bitbucket files"
          example: 1369b45c20fc685113adcfd1a08a914180ff3c0d
        git_file_url:
          type: string
          description: The url of the file on the fit provider
          example: ""
        git_path:
          type: string
          description: The path to the file in the git repo
          example: .harness/policy.rego
        git_repo:
          type: string
          description: The git repo the policy resides in
          example: "github.com/org/repo,omitempty"
        identifier:
          minLength: 1
          type: string
          description: identifier of the policy
          example: policy-1
        name:
          minLength: 1
          type: string
          description: Name of the policy
          example: Pipeline Approval
        org_id:
          type: string
          description: Harness organization ID associated with this policy
          example: test-org
          default: ""
        project_id:
          type: string
          description: Harness project ID associated with this policy
          example: test-project
          default: ""
        rego:
          minLength: 1
          type: string
          description: Rego that defines the policy
          example: ""
        updated:
          type: integer
          description: Time the policy was last updated
          format: int64
          example: 1636669297674
      example:
        account_id: eBqAoNchMLKigC_qZ5EdC
        created: 1636669297674
        git_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
        git_connector_ref: "."
        git_default_branch: main
        git_default_branch_commit_sha: 1369b45c20fc685113adcfd1a08a914180ff3c0d
        git_default_branch_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
        git_default_branch_file_url: ""
        git_default_branch_update_error:
          explanation: "File with given filepath [file.rego] already exists in Github,\
            \ thus couldn't create a new file"
          hint: "Please check if there's already a file [file.rego] in Github repository\
            \ [rego-demo] for the given filepath and branch [main]."
          message: "Please check if there's already a file [file.rego] in Github repository\
            \ [rego-demo] for the given filepath and branch [main]."
        git_default_branch_updated: 1636669297674
        git_file_id: 1369b45c20fc685113adcfd1a08a914180ff3c0d
        git_file_url: ""
        git_path: .harness/policy.rego
        git_repo: "github.com/org/repo,omitempty"
        identifier: policy-1
        name: Pipeline Approval
        org_id: test-org
        project_id: test-project
        rego: ""
        updated: 1636669297674
    PolicyExample:
      required:
      - desc
      - input
      - name
      - rego
      - type
      type: object
      properties:
        desc:
          type: string
          description: Longer description of the example
          example: This is a pipeline example
        input:
          type: string
          description: Example input to illustrate the rego policy
          example: "{\"message\": \"everyone\"}"
        name:
          type: string
          description: Example name
          example: Pipeline example
        rego:
          type: string
          description: Example rego policy
          example: |-
            package test
            deny["should say hello world"] {input.message != "world"}
        type:
          type: string
          description: The type of entity illustrated in this example
          example: pipeline
        variables:
          type: array
          description: The list of substitutable variables in the policy example
          example:
          - default:
            - JiraUpdate
            - HarnessApproval
            desc: The required steps that the policy enforces
            id: requiredsteps
            name: Required Steps
            type: selectOne
            values:
            - JiraUpdate
            - HarnessApproval
          - default:
            - JiraUpdate
            - HarnessApproval
            desc: The required steps that the policy enforces
            id: requiredsteps
            name: Required Steps
            type: selectOne
            values:
            - JiraUpdate
            - HarnessApproval
          - default:
            - JiraUpdate
            - HarnessApproval
            desc: The required steps that the policy enforces
            id: requiredsteps
            name: Required Steps
            type: selectOne
            values:
            - JiraUpdate
            - HarnessApproval
          items:
            $ref: '#/components/schemas/Variable'
      description: Example policies and input
      example:
        desc: This is a pipeline example
        input: "{\"message\": \"everyone\"}"
        name: Pipeline example
        rego: |-
          package test
          deny["should say hello world"] {input.message != "world"}
        type: pipeline
        variables:
        - default:
          - JiraUpdate
          - HarnessApproval
          desc: The required steps that the policy enforces
          id: requiredsteps
          name: Required Steps
          type: selectOne
          values:
          - JiraUpdate
          - HarnessApproval
        - default:
          - JiraUpdate
          - HarnessApproval
          desc: The required steps that the policy enforces
          id: requiredsteps
          name: Required Steps
          type: selectOne
          values:
          - JiraUpdate
          - HarnessApproval
        - default:
          - JiraUpdate
          - HarnessApproval
          desc: The required steps that the policy enforces
          id: requiredsteps
          name: Required Steps
          type: selectOne
          values:
          - JiraUpdate
          - HarnessApproval
    PolicyHealth:
      required:
      - total_evaluation_count
      - total_evaluation_entity_count
      - total_policy_count
      - total_policy_set_count
      - total_policy_set_entity_count
      type: object
      properties:
        total_evaluation_count:
          type: integer
          description: Total number of evaluations that have occurred
          format: int64
          example: 1075694761621855595
        total_evaluation_entity_count:
          $ref: '#/components/schemas/EvaluationCounts'
        total_policy_count:
          type: integer
          description: Total number of policies stored
          format: int64
          example: 1440586742128385263
        total_policy_set_count:
          type: integer
          description: Total number of policy sets stored
          format: int64
          example: 333280456831607697
        total_policy_set_entity_count:
          type: object
          additionalProperties:
            type: integer
            format: int64
            example: 7529806932165301472
          description: Total number of policy sets by type
          example:
            Et aperiam eos laboriosam.: 4158539768694987722
            Molestiae quo.: 1213808792919247442
            Unde enim molestiae soluta nihil nihil.: 3594044833535790815
      description: Policy health metrics
      example:
        total_evaluation_count: 4574813677344614924
        total_evaluation_entity_count:
          error: 76024433486172609
          pass: 4127438089508318555
          warning: 511376631733875378
        total_policy_count: 2031060111220529933
        total_policy_set_count: 1607032054773154549
        total_policy_set_entity_count:
          Autem sit assumenda error.: 6741000365707137320
          Optio ipsam et et asperiores libero cupiditate.: 9123841955658149183
    PolicySample:
      required:
      - policy
      - status
      type: object
      properties:
        policy:
          type: string
          description: Build identifier
          example: policy example
        status:
          type: string
          description: status
          example: SUCCESS
      example:
        policy: policy example
        status: SUCCESS
    PolicySet:
      required:
      - account_id
      - action
      - created
      - enabled
      - entity_selector
      - identifier
      - name
      - org_id
      - project_id
      - type
      - updated
      type: object
      properties:
        account_id:
          type: string
          description: Harness account ID associated with this policy set
          example: eBqAoNchMLKigC_qZ5EdC
          default: ""
        action:
          minLength: 1
          type: string
          description: Action that triggers the policy set
          example: onrun
        created:
          type: integer
          description: Time the policy set was created
          format: int64
          example: 1636669297674
        description:
          type: string
          description: Description of the policy set
          example: Captures critical production policies
        enabled:
          type: boolean
          description: Only enabled policy sets are evaluated when evaluating by type/action
          example: true
        entity_selector:
          type: string
          description: A string enum value which determines which entities the policy
            set applies to during evaluation
          example: all_entities_in_scope
          enum:
          - all_entities_in_scope
          - all_entities_in_resource_groups
        identifier:
          minLength: 1
          type: string
          description: Identifier of the policy set
          example: policyset-1
        name:
          minLength: 1
          type: string
          description: Name of the policy set
          example: Production Policies
        org_id:
          type: string
          description: Harness organization ID associated with this policy set
          example: test-org
          default: ""
        policies:
          type: array
          description: Policies linked to this policy set
          example:
          - account_id: eBqAoNchMLKigC_qZ5EdC
            created: 1636669297674
            identifier: policy-1
            name: Pipeline Approval
            org_id: test-org
            project_id: test-project
            rego: ""
            severity: warning
            updated: 1636669297674
          - account_id: eBqAoNchMLKigC_qZ5EdC
            created: 1636669297674
            identifier: policy-1
            name: Pipeline Approval
            org_id: test-org
            project_id: test-project
            rego: ""
            severity: warning
            updated: 1636669297674
          - account_id: eBqAoNchMLKigC_qZ5EdC
            created: 1636669297674
            identifier: policy-1
            name: Pipeline Approval
            org_id: test-org
            project_id: test-project
            rego: ""
            severity: warning
            updated: 1636669297674
          items:
            $ref: '#/components/schemas/LinkedPolicy'
        project_id:
          type: string
          description: Harness project ID associated with this policy set
          example: test-project
          default: ""
        resource_groups:
          type: array
          description: The groups of resources that this policy set should be applied
            to
          example:
          - account_id: Saepe aut soluta ut quia.
            created: 6663809881773907149
            identifier: Quia vero a ut nihil.
            name: Veniam quisquam quasi ut sint.
            org_id: Excepturi saepe quos natus.
            project_id: Debitis provident et.
          - account_id: Saepe aut soluta ut quia.
            created: 6663809881773907149
            identifier: Quia vero a ut nihil.
            name: Veniam quisquam quasi ut sint.
            org_id: Excepturi saepe quos natus.
            project_id: Debitis provident et.
          items:
            $ref: '#/components/schemas/ResourceGroup'
        type:
          minLength: 1
          type: string
          description: Type of input suitable for the policy set
          example: pipeline
        updated:
          type: integer
          description: Time the policy set was last updated
          format: int64
          example: 1636669297674
      example:
        account_id: eBqAoNchMLKigC_qZ5EdC
        action: onrun
        created: 1636669297674
        description: Captures critical production policies
        enabled: true
        entity_selector: all_entities_in_scope
        identifier: policyset-1
        name: Production Policies
        org_id: test-org
        policies:
        - account_id: eBqAoNchMLKigC_qZ5EdC
          created: 1636669297674
          identifier: policy-1
          name: Pipeline Approval
          org_id: test-org
          project_id: test-project
          rego: ""
          severity: warning
          updated: 1636669297674
        - account_id: eBqAoNchMLKigC_qZ5EdC
          created: 1636669297674
          identifier: policy-1
          name: Pipeline Approval
          org_id: test-org
          project_id: test-project
          rego: ""
          severity: warning
          updated: 1636669297674
        - account_id: eBqAoNchMLKigC_qZ5EdC
          created: 1636669297674
          identifier: policy-1
          name: Pipeline Approval
          org_id: test-org
          project_id: test-project
          rego: ""
          severity: warning
          updated: 1636669297674
        - account_id: eBqAoNchMLKigC_qZ5EdC
          created: 1636669297674
          identifier: policy-1
          name: Pipeline Approval
          org_id: test-org
          project_id: test-project
          rego: ""
          severity: warning
          updated: 1636669297674
        project_id: test-project
        resource_groups:
        - account_id: Saepe aut soluta ut quia.
          created: 6663809881773907149
          identifier: Quia vero a ut nihil.
          name: Veniam quisquam quasi ut sint.
          org_id: Excepturi saepe quos natus.
          project_id: Debitis provident et.
        - account_id: Saepe aut soluta ut quia.
          created: 6663809881773907149
          identifier: Quia vero a ut nihil.
          name: Veniam quisquam quasi ut sint.
          org_id: Excepturi saepe quos natus.
          project_id: Debitis provident et.
        - account_id: Saepe aut soluta ut quia.
          created: 6663809881773907149
          identifier: Quia vero a ut nihil.
          name: Veniam quisquam quasi ut sint.
          org_id: Excepturi saepe quos natus.
          project_id: Debitis provident et.
        - account_id: Saepe aut soluta ut quia.
          created: 6663809881773907149
          identifier: Quia vero a ut nihil.
          name: Veniam quisquam quasi ut sint.
          org_id: Excepturi saepe quos natus.
          project_id: Debitis provident et.
        type: pipeline
        updated: 1636669297674
    ResourceGroup:
      required:
      - account_id
      - created
      - identifier
      - name
      - org_id
      - project_id
      type: object
      properties:
        account_id:
          type: string
          description: resource group account id
          example: Reprehenderit nulla.
        created:
          type: integer
          description: resource group timestamp
          format: int64
          example: 3389164250940484280
        identifier:
          type: string
          description: resource group identifier
          example: Ullam sunt ea molestiae.
        name:
          type: string
          description: resource group name
          example: Eaque numquam quia velit nesciunt nobis quas.
        org_id:
          type: string
          description: resource group org id
          example: Est dolor non dolores tempore et.
        project_id:
          type: string
          description: resource group project identifier
          example: Nisi ab.
      example:
        account_id: Aut modi.
        created: 3940677915990648385
        identifier: Qui perferendis autem hic alias unde laudantium.
        name: Aut tempore eveniet rem.
        org_id: Hic incidunt suscipit porro.
        project_id: Sit ex fugiat occaecati animi recusandae.
    ResourceGroupIdentifier:
      required:
      - account_id
      - identifier
      - org_id
      - project_id
      type: object
      properties:
        account_id:
          type: string
          description: resource group account id
          example: Ducimus eligendi animi quia cum.
        identifier:
          type: string
          description: resource group identifier
          example: Laboriosam officiis et tempore corrupti.
        org_id:
          type: string
          description: resource group org id
          example: Excepturi quis.
        project_id:
          type: string
          description: resource group project identifier
          example: Et quis eius quidem velit.
      example:
        account_id: Voluptatem labore nam quis.
        identifier: Eius qui.
        org_id: Dolorem et fugit nobis minus illum iure.
        project_id: Dolore aut libero quaerat.
    ServiceVersion:
      required:
      - commit
      - version
      type: object
      properties:
        commit:
          type: string
          description: Build identifier
          example: 96381692bf3a2bd7904769c6886e832435768b57
        version:
          type: string
          description: Version number
          example: v0.123.0
      example:
        commit: 96381692bf3a2bd7904769c6886e832435768b57
        version: v0.123.0
    UpdateRequestBody:
      type: object
      properties:
        name:
          type: string
          description: The name of the policy
          example: Check that an approval step is present
        rego:
          type: string
          description: The rego that defines the policy policy
          example: |-
            package test
            deny["should say hello world"] {input.message != "world"}
      example:
        name: Check that an approval step is present
        rego: |-
          package test
          deny["should say hello world"] {input.message != "world"}
    UpdateRequestBody2:
      type: object
      properties:
        action:
          minLength: 1
          type: string
          description: Action that triggers the policy set
          example: onrun
        description:
          type: string
          description: Description of the policy set
          example: Captures critical production policies
        enabled:
          type: boolean
          description: Only enabled policy sets are evaluated when evaluating by type/action
          example: true
        entity_selector:
          type: string
          description: "A string enum value which determines which entities the policy\
            \ set applies to during evaluation. This feature is not available for\
            \ all accounts, Contact support if you wish to have it enabled."
          example: all_entities_in_scope
          enum:
          - all_entities_in_scope
          - all_entities_in_resource_groups
        name:
          type: string
          description: Name of the policy set
          example: Production Policies
        policies:
          type: array
          description: Policies linked to this policy set
          example:
          - identifier: policy-1
            severity: warning
          - identifier: policy-1
            severity: warning
          items:
            $ref: '#/components/schemas/Linkedpolicyidentifier'
        resource_groups:
          type: array
          description: "Resource groups that contain the resources that this policy\
            \ set should be evaluated for. Resource groups are not supported for flag\
            \ or custom policy sets. This feature is not available for all accounts,\
            \ Contact support if you wish to have it enabled."
          example:
          - account_id: In repudiandae et quidem possimus ipsum.
            identifier: Numquam rem quia.
            org_id: Possimus praesentium sint veniam eos.
            project_id: Sunt animi ipsa.
          - account_id: In repudiandae et quidem possimus ipsum.
            identifier: Numquam rem quia.
            org_id: Possimus praesentium sint veniam eos.
            project_id: Sunt animi ipsa.
          - account_id: In repudiandae et quidem possimus ipsum.
            identifier: Numquam rem quia.
            org_id: Possimus praesentium sint veniam eos.
            project_id: Sunt animi ipsa.
          - account_id: In repudiandae et quidem possimus ipsum.
            identifier: Numquam rem quia.
            org_id: Possimus praesentium sint veniam eos.
            project_id: Sunt animi ipsa.
          items:
            $ref: '#/components/schemas/ResourceGroupIdentifier'
        type:
          type: string
          description: Type of input suitable for the policy set
          example: pipeline
      example:
        action: onrun
        description: Captures critical production policies
        enabled: true
        entity_selector: all_entities_in_resource_groups
        name: Production Policies
        policies:
        - identifier: policy-1
          severity: warning
        - identifier: policy-1
          severity: warning
        resource_groups:
        - account_id: In repudiandae et quidem possimus ipsum.
          identifier: Numquam rem quia.
          org_id: Possimus praesentium sint veniam eos.
          project_id: Sunt animi ipsa.
        - account_id: In repudiandae et quidem possimus ipsum.
          identifier: Numquam rem quia.
          org_id: Possimus praesentium sint veniam eos.
          project_id: Sunt animi ipsa.
        type: pipeline
    Variable:
      type: object
      properties:
        default:
          type: array
          description: The values that are selected by default
          example:
          - JiraUpdate
          - HarnessApproval
          items:
            type: string
            example: Molestiae qui ut.
        desc:
          type: string
          description: Longer description of the variable to substitute
          example: The required steps that the policy enforces
        id:
          type: string
          description: The id of the variable to substitute in the rego
          example: requiredsteps
        name:
          type: string
          description: The human readable name of the variable to substitute in the
            rego
          example: Required Steps
        type:
          type: string
          description: The variable type
          example: selectOne
          enum:
          - text
          - textMultiple
          - selectOne
          - selectMultiple
        values:
          type: array
          description: Pre populated sample values to substitute the variable with
          example:
          - JiraUpdate
          - HarnessApproval
          items:
            type: string
            example: Nihil occaecati cumque et maiores similique aut.
      example:
        default:
        - JiraUpdate
        - HarnessApproval
        desc: The required steps that the policy enforces
        id: requiredsteps
        name: Required Steps
        type: selectOne
        values:
        - JiraUpdate
        - HarnessApproval
  securitySchemes:
    api_key_header_x-api-key:
      type: apiKey
      description: Harness PAT
      name: x-api-key
      in: header
    jwt_header_Authorization:
      type: http
      scheme: bearer
